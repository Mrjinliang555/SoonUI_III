/*! SOON.UI 2017-12-20 */
!function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("SoonUI requires a window with a document");return b(a)}:b(a,!0)}("undefined"!=typeof window?window:this,function(a,b){var c={};return b&&(a.ui=c,a.soonUI=c),c}),function(a,b){"use strict";function c(a){return l.test(k.call(a))}b.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};var d=b.core={},e=document,f=/[^, ]+/g,g=[],h={},i=Object.prototype,j=i.hasOwnProperty,k=(window.dispatchEvent,e.documentElement,i.toString),l=(g.slice,e.head||e.getElementsByTagName("head")[0],/^[\[]object (Window|DOMWindow|global)[\]]$/),m="ontouchstart"in window;d.each=function(a,b){a.replace(f,b)};var n="Boolean Number String Function Array Date RegExp Object Error";d.each(n,function(a){h["[object "+a+"]"]=a.toLowerCase()}),d.type=function(a){return null===a?String(a):"object"==typeof a||"function"==typeof a?h[k.call(a)]||"object":typeof a},d.each(n,function(a){d["is"+a]=function(){return d.type.apply(d,arguments)===a.toLowerCase()}}),d.isNumber=function(a){var b=d.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},d.isNumeric=d.isNumber,d.isWindow=function(a){return!!a&&(a===window||a==a.document&&a.document!=a)},c(window)||(d.isWindow=c),d.isPlainObject=function(a){if("object"!==this.type(a)||a.nodeType||this.isWindow(a))return!1;try{if(a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}return!0},/\[native code\]/.test(Object.getPrototypeOf)&&(d.isPlainObject=function(a){return a&&"object"==typeof a&&Object.getPrototypeOf(a)===i}),d.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},d.isDomObject=function(a){return!!a&&!!a.nodeType&&1==a.nodeType},d.isJQueryObject=function(a){return"object"===this.type(a)&&"string"===this.type(a.jquery)},d.isSupportCanvas=function(){return!!document.createElement("canvas").getContext},d.isTouchAvailable=function(){return m}}(jQuery,ui),function(a,b){"use strict";"function"!=typeof Array.isArray&&(Array.isArray=function(a){return"array"===b.core.type(a)}),"function"!=typeof Array.prototype.forEach&&(Array.prototype.forEach=function(a,b){if("function"==typeof a)for(var c=0,d=this.length;c<d;c++)c in this&&a.call(b,this[c],c,this)}),"function"!=typeof Array.prototype.map&&(Array.prototype.map=function(a,b){if("function"==typeof a){for(var c=new Array(this.length),d=0,e=this.length;d<e;d++)d in this&&(c[d]=a.call(b,this[d],d,this));return c}}),"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=function(a,b){if("function"==typeof a){for(var c=[],d=0,e=this.length;d<e;d++)d in this&&a.call(b,this[d],d,this)&&c.push(this[d]);return c}}),"function"!=typeof Array.prototype.every&&(Array.prototype.every=function(a,b){if("function"==typeof a){for(var c=0,d=this.length;c<d;c++)if(c in this&&!a.call(b,this[c],c,this))return!1;return!0}}),"function"!=typeof Array.prototype.some&&(Array.prototype.some=function(a,b){if("function"==typeof a){for(var c=0,d=this.length;c<d;c++)if(c in this&&a.call(b,this[c],c,this))return!0;return!1}}),"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){if("function"==typeof a){var c,d=0,e=this.length;if(arguments.length<2){if(0===e)throw new TypeError("Reduce of empty array with no initial value");c=this[d],d++}else c=b;for(;d<e;d++)d in this&&(c=a.call(null,c,this[d],d,this));return c}}),"function"!=typeof Array.prototype.reduceRight&&(Array.prototype.reduceRight=function(a,b){if("function"==typeof a){var c,d=this.length,e=d-1;if(arguments.length<2){if(0===d)throw new TypeError("Reduce of empty array with no initial value");c=this[e],e--}else c=b;for(;e>=0;e--)e in this&&(c=a.call(null,c,this[e],e,this));return c}}),"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(a,b){b||(b=0);var c,d=this.length,e=-1;if(d>0){for(;b<0;)b=d+b;for(c=b;c<d;c++)if(this[c]===a){e=c;break}}return e}),"function"!=typeof Array.prototype.lastIndexOf&&(Array.prototype.lastIndexOf=function(a,b){b||(b=0);var c=this.length,d=c-1,e=-1;if(c>0){for(;b<0;)b=c+b;for(d=b;d>=0;d--)if(this[d]===a){e=d;break}}return e}),"function"!=typeof String.prototype.trim&&(String.protocol.trim=function(){var a,b=this,c=/\s/;for(b=b.replace(/^\s\s*/,""),a=b.length-1;c.test(b.charAt(a--)););return b.slice(0,a+1)}),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(a){var b=this,c=arguments;return function(){var d,e=[];for(d=1;d<c.length;d++)e.push(c[d]);for(d=0;d<arguments.length;d++)e.push(arguments[d]);return b.apply(a,e)}})}(jQuery,ui),function(a,b){"use strict";function c(a){return a}function d(a){throw a}function e(a){return this.then(a,d)}function f(a){return this.then(c,a)}function g(){var a={};return a.promise=new this(function(b,c){a.resolve=b,a.reject=c}),a}function h(a,c){var d;d="boolean"===b.core.type(a.async)?a.async:a.async=!0,d?window.setTimeout(c,0):c()}function i(a,b){if("pending"===a._state)if(b&&"function"==typeof b.then){var c=b instanceof m?"_then":"then";b[c](function(b){k(a,b,!0)},function(b){k(a,b,!1)})}else k(a,b,!0)}function j(a,b){"pending"===a._state&&k(a,b,!1)}function k(a,b,c){a._fired=!0,a._value=b,a._state=c?"fulfilled":"rejected",h(a,function(){for(var b,c=0,d=a._callbacks.length;c<d;c++)b=a._callbacks[c],a._fire(b.onSuccess,b.onFail)})}function l(a,c){c="array"===b.core.type(c)?c:[];var d,e=0,f=[];return new m(function(b,g){function h(h,i){h.then(function(g){d||(f[i]=g,e++,(a||e>=c.length)&&(b(a?g:f),d=!0))},function(a){d=!0,g(a)})}c.length||b();for(var i=0,j=c.length;i<j;i++)h(c[i],i)})}var m=function(a){this._callbacks=[];var b=this;if("object"!=typeof this)throw new Error("Promises must be constructed via new");if("function"!=typeof a)throw new Error("not a function");a(function(a){i(b,a)},function(a){j(b,a)})};m.resolve=function(a){return new m(function(b){b(a)})},m.reject=function(a){return new m(function(b,c){c(a)})},m.prototype={constructor:m,_state:"pending",_fired:!1,_fire:function(a,b){if("rejected"===this._state){if("function"!=typeof b)throw this._value;b(this._value)}else"function"==typeof a&&a(this._value)},_then:function(a,b){if(this._fired){var c=this;h(c,function(){c._fire(a,b)})}else this._callbacks.push({onSuccess:a,onFail:b})},then:function(a,b){a="function"==typeof a?a:c,b="function"==typeof b?b:d;var e=this,f=new m(function(c,d){e._then(function(b){try{b=a(b)}catch(a){return void d(a)}c(b)},function(a){try{a=b(a)}catch(a){return void d(a)}c(a)})});for(var g in e)n[g]||(f[g]=e[g]);return f},done:e,catch:f,fail:f};var n={_state:1,_fired:1,_value:1,_callbacks:1};m.all=function(a){return l(!1,a)},m.race=function(a){return l(!0,a)},m.defer=g,b.Promise=m;var o=window.Promise;/native code/.test(o)&&(o.prototype.done=e,o.prototype.fail=f,o.defer||(o.defer=g)),window.Promise=o||m}(jQuery,ui),function(a,b){"use strict";function c(){return this.setArray(this.makeArray(arguments)),this}var d=[];c.prototype={constructor:c,isArray:function(a){return b.core.isArray(a)},setArray:function(a){return this.length=0,Array.prototype.push.apply(this,a),this},makeArray:function(a){var b,c=[];if(null!==a)if(b=a.length,null===b||a.split||a.setInterval||a.call)c[0]=a;else try{c=Array.prototype.slice.call(a)}catch(d){for(;b;)c[--b]=a[b]}return c},toString:function(){var a=Array.prototype.slice.call(this);return a.toString()},valueOf:function(){return Array.prototype.slice.call(this)},get:function(a){return void 0===a?Array.prototype.slice.call(this):this[a]},shift:d.shift,push:d.push,sort:d.sort,pop:d.pop,splice:d.splice,concat:d.concat,slice:d.slice,forEach:d.forEach,map:d.map,filter:d.filter,every:d.every,some:d.some,reduce:d.reduce,reduceRight:d.reduceRight,indexOf:d.indexOf,lastIndexOf:d.lastIndexOf,constructor:b.ArrayFaker},b.ArrayFaker=c}(jQuery,ui),function(a,b){"use strict";function c(){return this instanceof c?void this.initialize():new c}var d=[],e=function(a,b){var c=!1;for(var d in a)d!==b?c&&(a[d]=--a[d]):c=!0};c.prototype=a.extend({constructor:c},b.ArrayFaker.prototype),delete c.prototype.shift,delete c.prototype.push,delete c.prototype.sort,delete c.prototype.pop,delete c.prototype.splice,delete c.prototype.concat,delete c.prototype.slice,delete c.prototype.forEach,delete c.prototype.map,delete c.prototype.filter,delete c.prototype.every,delete c.prototype.some,delete c.prototype.reduce,delete c.prototype.reduceRight,delete c.prototype.indexOf,delete c.prototype.lastIndexOf,c.prototype.initialize=function(){b.ArrayFaker.apply(this),this._keys={}},c.prototype.containsKey=function(a){return this._keys.hasOwnProperty(a)},c.prototype.containsValue=function(a){var b,c=this.length;for(b=0;b<c;b++)if(this[b]===a)return!0;return!1},c.prototype.set=function(a,b){if("string"!=typeof a)throw new TypeError("the key must be string");this.containsKey(a)?this[this._keys[a]]=b:(d.push.apply(this,[b]),this._keys[a]=this.length-1)},c.prototype.get=function(a){return this.containsKey(a)?this[this._keys[a]]:null},c.prototype.remove=function(a){var b;this.containsKey(a)&&(b=this._keys[a],d.splice.apply(this,[b,1]),e(this._keys,a),delete this._keys[a])},c.prototype.removeAt=function(a){var b,c,e;if(a>=0&&a<this.length){c=!1;for(e in this._keys)this._keys[e]===a&&(c=!0,b=e),c&&(this._keys[e]=--this._keys[e]);delete this._keys[b],d.splice.apply(this,[a,1])}},c.prototype.clear=function(){d.splice.apply(this,[0,this.length]),this._keys={}},c.prototype.toArray=function(){for(var a=[],b=this.length-1;b>=0;b--)a[b]=this[b];return a},b.KeyArray=c}(jQuery,ui),function(a,b){"use strict";function c(){return this instanceof c?void this.initialize():new c}var d=(b.core,16);c.prototype={constructor:c,initialize:function(){this.keys=null,this.items=null,this.comparer=function(a,c){return b.core.isString(a)?a.localeCompare(c):a<c?-1:c>a?1:0}},sort:function(a){b.core.isFunction(a)?this.comparer=a:(this.keys=a,b.core.isFunction(arguments[1])&&(this.comparer=arguments[1])),Array.isArray(this.keys)&&(this.keys.length<2||(Array.isArray(this.items)||(this.items=null),this._introsort(0,this.keys.length-1,2*this._floorLog2(this.keys.length))))},_introsort:function(a,b,c){for(var e;b>a;){if(e=b-a+1,e<=d){if(1==e)return;return 2==e?void this._compareAndSwap(a,b):3==e?(this._compareAndSwap(a,b-1),this._compareAndSwap(a,b),void this._compareAndSwap(b-1,b)):void this._insertionsort(a,b)}if(0===c)return void this._heapsort(a,b);c--,e=this.partition(a,b),this._introsort(e+1,b,c),b=e-1}},partition:function(a,b){var c=parseInt(a+(b-a)/2,10);this._compareAndSwap(a,c),this._compareAndSwap(a,b),this._compareAndSwap(c,b);var d=this.keys[c];this._swap(c,b-1);var e=a;for(c=b-1;e<c;){for(;this.comparer(this.keys[++e],d)<0;);for(;this.comparer(d,this.keys[--c])<0;);if(e>=c)break;this._swap(e,c)}return this._swap(e,b-1),e},_heapsort:function(a,b){for(var c,d=b-a+1,e=Math.floor(d/2);e>=1;e--)this._downHeap(e,d,a);for(c=d;c>1;c--)this._swap(a,a+c-1),this._downHeap(1,c-1,a)},_downHeap:function(a,b,c){for(var d,e=this.keys[c+a-1],f=this.items?this.items[c+a-1]:null;a<=Math.floor(b/2)&&(d=2*a,d<b&&this.comparer(this.keys[c+d-1],this.keys[c+d])<0&&d++,!(this.comparer(e,this.keys[c+d-1])>=0));)this.keys[c+a-1]=this.keys[c+d-1],null!==this.items&&(this.items[c+a-1]=this.items[c+d-1]),a=d;this.keys[c+a-1]=e,null!==this.items&&(this.items[c+a-1]=f)},_insertionsort:function(a,b){var c,d,e,f;for(c=a;c<b;c++){for(d=c,e=this.keys[c+1],f=this.items?this.items[c+1]:null;d>=a&&this.comparer(e,this.keys[d])<0;)this.keys[d+1]=this.keys[d],null!==this.items&&(this.items[d+1]=this.items[d]),d--;this.keys[d+1]=e,this.items&&(this.items[d+1]=f)}},_swap:function(a,b){var c=this.keys[a];this.keys[a]=this.keys[b],this.keys[b]=c,this.items&&(c=this.items[a],this.items[a]=this.items[b],this.items[b]=c)},_compareAndSwap:function(a,b){a!=b&&this.comparer(this.keys[a],this.keys[b])>0&&this._swap(a,b)},_floorLog2:function(a){for(var b=0;a>=1;)b++,a/=2;return b}},b.Introsort=c}(jQuery,ui),function(a,b){"use strict";b.fixedNumber=function(a,b){var c,d=1;return isNaN(a)?a:(a<0&&(d=-1),isNaN(b)&&(b=0),c=Math.pow(10,b),Math.round(Math.abs(a)*c)/c*d)},b.scrollbarHeight=b.scrollbarWidth=17,b.tempDiv=a("<div style='position:absolute;left:-1000px;top:-100px;width:100px;height:100px;overflow:auto;' />"),b.tempInnerDiv=a("<div style='width:100%;height:50px;' />"),b.tempDiv.append(b.tempInnerDiv),document.documentElement.appendChild(b.tempDiv.get(0)),b.tempWidth=b.tempInnerDiv.width(),b.tempInnerDiv.css("height","120px"),b.scrollbarHeight=b.scrollbarWidth=b.tempWidth-b.tempInnerDiv.width(),b.tempInnerDiv.remove(),b.tempDiv.remove(),delete b.tempWidth,delete b.tempInnerDiv,delete b.tempDiv,b.getScrollOffsets=function(a){var b,c;return a=a||window,c=a.document,b={},null!==a.pageXOffset?(b.scrollLeft=a.pageXOffset,b.scrollTop=a.pageYOffset,b):"CSS1Compat"===document.compatMode?(b.scrollLeft=c.documentElement.scrollLeft,b.scrollTop=c.documentElement.scrollTop,b):(b.scrollLeft=c.body.scrollLeft,b.scrollTop=c.body.scrollTop,b)},b.getViewportSize=function(a){var b,c={};return a=a||window,b=a.document,null!==a.innerWidth&&(c.clientWidth=a.innerWidth,c.clientHeight=a.innerHeight),"CSS1Compat"===document.compatMode?(c.scrollLeft=b.documentElement.clientWidth,c.scrollTop=b.documentElement.clientHeight,c):(c.scrollLeft=b.body.clientWidth,c.scrollTop=b.body.clientHeight,c)},b.getBoundingClientRect=function(a){var c;return a?(b.core.isJQueryObject(a)&&(a=a[0]),c=a.getBoundingClientRect(),c.width=c.width||c.right-c.left,c.height=c.height||c.bottom-c.top,c):null},b.getJQueryElement=function(c){var d=null;return"string"===b.core.type(c)?d=a("#"+c):b.core.isJQueryObject(c)?d=c:b.core.isDomObject(c)&&(d=a(c)),d&&0!==d.length?d:null},b.setDown=function(a,c){if(a&&c){var d=c.outerWidth(),e=c.outerHeight(),f=b.getDownLocation(a,d,e);f.top+="px",f.left+="px",c.css(f)}},b.setLeft=function(a,c){if(a&&c){var d=c.outerWidth(),e=c.outerHeight(),f=b.getLeftLocation(a,d,e);f.top+="px",f.left+="px",c.css(f)}},b.getDownLocation=function(a,b,c){var d,e,f,g,h;return d={left:0,top:0},a?(e=a.offset(),f=document.documentElement,g=e.top+a.outerHeight(),h=e.left,g+c>f.clientHeight+f.scrollTop&&(g-=c+a.outerHeight()),h+b>f.clientWidth+f.scrollLeft&&(h-=b-a.outerWidth()),d.top=g,d.left=h,d):d},b.getLeftLocation=function(a,b,c){var d,e,f,g,h;return d={left:0,top:0},a?(e=a.offset(),f=document.documentElement,g=e.top,h=e.left+a.outerWidth(),g+c>f.clientHeight+f.scrollTop&&(g-=g+c-(f.clientHeight+f.scrollTop)),h+b>f.clientWidth+f.scrollLeft&&(h=e.left-b),d.top=g,d.left=h,d):d},b.mask={maskId:"#ui_mask_rectangle",isOpen:function(){return"block"===a(this.maskId).css("display")},open:function(c,d){var e,f=a(this.maskId),g=a(document.body);return b.core.isPlainObject(c)&&(d=c,c=null),c||(c=d.target),c=b.getJQueryElement(c),c||(c=g),d||(d={}),d.color=d.color||"#000000",d.opacity=d.opacity||.6,d.animate=d.animate!==!1,0===f.length&&(f=a("<div class='mask-panel' />"),f.prop("id",this.maskId.substring(1)),g.append(f),b.page.resize(function(a,b,c){f.css({height:c+"px",width:b+"px"})},b.eventPriority.ctrlResize),this._mask_animator=b.animator({target:f,onChange:function(a){this.target.css({opacity:a/100,filter:"Alpha(opacity="+a+")"})}}),this._mask_animator.duration=500),f.css("background-color",d.color),this._mask_data={option:d,target:c},"BODY"===c.nodeName()?(this._mask_data.overflow=g.css("overflow"),"hidden"!==this._mask_data.overflow&&g.css("overflow","hidden"),f.css({top:"0",left:"0",width:document.documentElement.clientWidth+"px",height:document.documentElement.clientHeight+"px"})):(e=c.offset(),f.css({top:e.top+"px",left:e.left+"px",width:c.outerWidth()+"px",height:c.outerHeight()+"px"})),d.animate?(f.css({display:"block",opacity:"0",filter:"Alpha(opacity=0)"}),this._mask_animator[0].begin=0,this._mask_animator[0].end=100*d.opacity,this._mask_animator.start()):f.css({display:"block",filter:"Alpha(opacity="+100*d.opacity+")",opacity:d.opacity}),f},close:function(){var b,c;b=a(this.maskId),0!==b.length&&(c=this._mask_data,this._mask_data=null,"BODY"===c.target.nodeName()&&c.target.css("overflow",c.overflow),c.option.animate?(this._mask_animator[0].begin=60,this._mask_animator[0].end=0,this._mask_animator.start().done(function(){b.css("display","none")})):b.css("display","none"))}}}(jQuery,ui),function(a,b){"use strict";function c(a){var b,c=f;a=a.replace(/\r\n/g,"\n");for(var d=0;d<a.length;d++)b=a.charCodeAt(d),b<128?c+=String.fromCharCode(b):b>127&&b<2048?(c+=String.fromCharCode(b>>6|192),c+=String.fromCharCode(63&b|128)):(c+=String.fromCharCode(b>>12|224),c+=String.fromCharCode(b>>6&63|128),c+=String.fromCharCode(63&b|128));return c}function d(a){for(var b=f,c=0,d=0,e=0,g=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(g=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&g),c+=2):(g=a.charCodeAt(c+1),e=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&g)<<6|63&e),c+=3);return b}var e,f="",g=/\\?\{([^{}]+)\}/gm,h=function(a){var b="日一二三四五六";return"周"+b.charAt(a)},i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.str={empty:f,each:b.core.each,trim:function(a,b){return"string"!=typeof a?a:(b||(b="\\s"),a.replace(new RegExp("(^"+b+"*)|("+b+"*$)","g"),f))},trimLeft:function(a,b){return"string"!=typeof a?a:(trimChar||(trimChar="\\s"),a.replace(new RegExp("(^"+trimChar+"*)","g"),b))},trimRight:function(a){return"string"!=typeof a?a:(trimChar||(trimChar="\\s"),a.replace(new RegExp("("+trimChar+"*$)","g"),f))},isEmpty:function(a){return void 0===a||null===a||"string"==typeof a&&0===a.length},isBlank:function(a){var c,d;if(void 0===a||null===a)return!0;if(b.core.isString(a)){for(c=0,d=a.length;c<d;c++)if(32!=a.charCodeAt(c))return!1;return!0}},textFormat:function(a,b){var c=Array.prototype.slice,d=c.call(arguments,1);return a?a.replace(g,function(a,c){var e;return"\\"==a.charAt(0)?a.slice(1):(e=Number(c),e>=0?d[e]:b&&b[c]?b[c]:"")}):f},dateFormat:function(b,c,d){if(!b)return f;"string"==typeof b&&(c=b,b=new Date),a.isFunction(d)||(d=h);var e="0";c=c.replace(/y+/i,function(a){var c=b.getFullYear()+"";return c.substring(c.length-a.length)});var g=null,i=function(a){return a.length>1&&g<10?e+g:g};return g=b.getMonth()+1,c=c.replace(/M+/,i),g=b.getDate(),c=c.replace(/d+/i,i),g=b.getHours(),c=c.replace(/H+/,i),c=c.replace(/h+/,function(a){var b=g%12||12;return(g>12?"PM":"AM")+(a.length>1&&b<10?e+b:b)}),g=b.getMinutes(),c=c.replace(/m+/,i),g=b.getSeconds(),c=c.replace(/S+/i,i),c=c.replace(/ms/i,b.getMilliseconds()),c=c.replace(/wk/i,d(b.getDay()))},convertDate:function(a,b){var c=1970,d=0,e=1,f=0,g=0,h=0,i=0,j=/y+/i.exec(b);return null!==j&&(c=parseInt(a.substring(j.index,j.index+j[0].length),10)),j=/M+/.exec(b),null!==j&&(d=parseInt(a.substring(j.index,j.index+j[0].length),10)-1),j=/d+/i.exec(b),null!==j&&(e=parseInt(a.substring(j.index,j.index+j[0].length),10)),j=/H+/.exec(b),null!==j&&(f=parseInt(a.substring(j.index,j.index+j.index+j[0].length),10)),j=/h+/.exec(b),null!==j&&(f=parseInt(a.substring(j.index,j.index+j[0].length),10),"PM"===a.substring(j.index-2,2)&&(f+=12)),j=/m+/.exec(b),null!==j&&(g=parseInt(a.substring(j.index,j.index+j[0].length),10)),j=/S+/i.exec(b),null!==j&&(h=parseInt(a.substring(j.index,j.index+j[0].length),10)),j=/ms/i.exec(b),null!==j&&(i=parseInt(a.substring(j.index,j.index+j[0].length),10)),new Date(c,d,e,f,g,h,i)},jsonnetToDate:function(a){if(!a)return null;var b=/Date\(([^)]+)\)/.exec(a)[1];return new Date(Number(b))},jsonToDate:function(a){var b=new Date(a),c=null;return isNaN(b)&&(c=/Date\(([^)]+)\)/.exec(a),b=null!==c?new Date(Number(c[1])):this.convertDate(a,"yyyy-MM-ddTHH:mm:ss")),b},base64Encode:function(a){var b,d,e,f,g,h,j,k="",l=0;for(a=c(a);l<a.length;)b=a.charCodeAt(l++),d=a.charCodeAt(l++),e=a.charCodeAt(l++),f=b>>2,g=(3&b)<<4|d>>4,h=(15&d)<<2|e>>6,j=63&e,isNaN(d)?h=j=64:isNaN(e)&&(j=64),k=k+i.charAt(f)+i.charAt(g)+i.charAt(h)+i.charAt(j);return k},base64Decode:function(a){var b,c,e,f,g,h,j,k="",l=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)f=i.indexOf(a.charAt(l++)),g=i.indexOf(a.charAt(l++)),h=i.indexOf(a.charAt(l++)),j=i.indexOf(a.charAt(l++)),b=f<<2|g>>4,c=(15&g)<<4|h>>2,e=(3&h)<<6|j,k+=String.fromCharCode(b),64!=h&&(k+=String.fromCharCode(c)),64!=j&&(k+=String.fromCharCode(e));return k=d(k)},htmlEncode:function(b){return this.isEmpty(b)?f:(e||(e=a("<span />")),e.append(document.createTextNode(b)).html())},htmlDecode:function(b){return this.isEmpty(b)?f:(e||(e=a("<span />")),e.html(b).text())},numberScaleFormat:function(a,c){var d,e,g,h,i;if(isNaN(a))return null;for(isNaN(c)&&(c=2),a=b.fixedNumber(a,c),d=a+f,g=d.indexOf("."),g<0?e=f:(e=d.substring(g+1),d=d.substring(0,g)),h=0,i=c-e.length;h<i;h++)e+="0";return d+"."+e},integerFormat:function(a,b){var c,d,e;if(a=parseInt(a,10),isNaN(a))return NaN;for(isNaN(b)&&(b=8),c=a+f,d=0,e=b-c.length;d<e;d++)c="0"+c;return c},moneyFormat:function(a,c){var d,e,g,h,i;if(c||(c="￥"),d=b.str.numberScaleFormat(a,2),!d)return d;for(e=d.split("."),d=e[0],g=0,h=[],i=d.length-1;i>=0;i--)3==g&&(g=0,h.push(",")),g++,h.push(d.charAt(i));return h.push(c),h.reverse(),h.push(".",e[1]),h.join(f)}}}(jQuery,ui),function(a,b){"use strict";function c(a){var c,d;return c=b.core.type(a),"function"!==c&&("string"===c?(d=a,a=function(){return index.indexOf(d)>-1}):a=function(){return this.indexOf("_")>-1}),a}b.obj={clone:function(a,d){var e,f,g;if(d=c(d),f=b.core.type(a),"object"===f)e={};else{if("array"!==f)return a;e=[]}for(g in a)d.call(g)||(e[g]=a[g]);return e},deepClone:function(a,d){var e,f,g;if(f=b.core.type(a),"object"===f)e={};else{if("array"!==f)return a;e=[]}d=c(d);for(g in a)d.call(g)||(copy=a[g],e!==copy&&(f=b.core.type(copy),"object"===f||"array"===f?e[g]=this.deepClone(copy,d):e[g]=copy));return e}}}(jQuery,ui),function(a,b){"use strict";var c=/\?/,d=/%20/g;b.url={urlInfo:function(a){var b=document.createElement("a");return b.href=a,{source:a,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,search:b.search,params:function(){for(var a,c={},d=b.search.replace(/^\?/,"").split("&"),e=d.length,f=0;f<e;f++)d[f]&&(a=d[f].split("="),c[a[0]]=a[1]);return c}(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}},getParams:function(a){for(var b,c={},d=/([^?=&]+)=([^&]+)/gi;null!==(b=d.exec(a));)c[b[1]]=b[2];return c},setParams:function(a,b){var c,d,e,f;if(b){c=this.getParams(a);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]+"");e=a.indexOf("?"),e>=0&&(a=a(0,e)),f=[];for(d in c)c.hasOwnProperty(d)&&f.push(d+"="+c[d]);return a+"?"+f.join("&")}},appendParams:function(e,f){var g,h,i,j=[],k=function(a,c){c=b.core.isFunction(c)?c():null===c?"":c,j[j.length]=encodeURIComponent(a)+"="+encodeURIComponent(c)};if(a.isArray(f))for(g=0;g<f.length;g++)h=f[g],h.hasOwnProperty("name")&&k(h.name,h.value);else if(a.isPlainObject(f))for(i in f)k(i,f[i]);return j.length>0?e+(c.test(e)?"&":"?")+j.join("&").replace(d,"+"):e},getLocationParam:function(a){var b=window.location.search.substr(1),c=b.match(new RegExp("(^|&)"+a+"=([^&]*)(&|$)"));return null===c?null:unescape(c[2])}}}(jQuery,ui),function(a,b){"use strict";function c(a,c){if(!b.core.isFunction(a)){if(b.core.isString(a))return function(){return this[a]};throw new TypeError(b.str.textFormat("the {0} is not String or Function.",c))}return a}var d="_from-list";b.trans={listToTree:function(a,e,f,g){var h,i,j,k,l,m,n,o,p={},q=d;if(!Array.isArray(a)||0===a.length)return null;for(e=c(e,"parentField"),f=c(f,"valueField"),g=b.core.isString(g)?g:"children",k=0,l=a.length;k<l;k++)j=a[k],null!==j&&void 0!==j&&(n=e.call(j)+""||"__",p.hasOwnProperty(n)?(h=p[n],h[g].push(j)):(h={},h[g]=[],h[g].push(j),p[n]=h),m=f.call(j)+"",p.hasOwnProperty(m)?(h=p[m],j[g]=h[g],p[m]=j,j[q]=!0):(j[g]=[],j[q]=!0,p[m]=j));for(o in p)if(p.hasOwnProperty(o)&&(h=p[o],!h.hasOwnProperty(q))){i=h;break}return i[g]},listToGroup:function(a,d,e,f){var g,h,i,j,k,l,m={};if(!Array.isArray(a)||0===a.length)return null;for(j=b.core.isString(d)?d:"text",d=c(d,"groupField"),f=b.core.isString(f)?f:"children",g=0,h=a.length;g<h;g++)k=a[g],null!==k&&void 0!==k&&(i=d.call(k)+""||"__",m.hasOwnProperty(i)||(m[i]={},m[i][j]=i,m[i][f]=[],b.core.isFunction(e)&&e.call(this,m[i],k,i)),m[i][f].push(k));l=[];for(i in m)m.hasOwnProperty(i)&&l.push(m[i]);return l}}}(jQuery,ui),function(a,b){"use strict";var c={getNum:function(a,b){var c=null;if(isNaN(a)&&(a=0),isNaN(b)&&(b=100),b==a)return a;var d;b<a&&(d=b,b=a,a=d);var e=b-a;return c=a+Math.floor(Math.random()*e)}},d=new Date,e=function(a,b,c){a=a.toString(36).split(""),b=b/4|0,c=c/4|0;for(var d=b;d<=c;d++)a[d]||(a[d]=0);return a.slice(b,c+1).join("")},f=function(a){return Math.random()*(a+1)|0},g=function(a){a=a.replace(/./g,function(a){return a.charCodeAt()}).split("");for(var b=16777619,c=2166136261,d=a.length,e=0;e<d;e++)c=(c^a[e])*b;return c+=c<<13,c^=c>>7,c+=c<<3,c^=c>>17,c+=c<<5,c&=2147483647,c=c.toString(36),c.length<6&&(c+=(d%36).toString(36)),c},h=[screen.width,screen.height,navigator.plugins.length,navigator.javaEnabled(),screen.colorDepth,location.href,navigator.userAgent].join("");c.uuid=function(){var a=new Date,b=(+a+631152e6).toString(36),c=e(f(4095),0,7)+e(f(8191),0,7)+e(f(8191),0,8),i=251*Math.random()+50|0,j=[];for(b.length<9&&(b+=(a%36).toString(36));i--;)j.push(Math.random());return g(h)+g([document.documentElement.offsetWidth,document.documentElement.offsetHeight,,history.length,new Date-d].join(""))+b+c+g(j.slice(0,10).join(""))+g(j.slice(i-9).join(""))};var i=function(){return Math.floor(256*Math.random())};c.hex=function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)},c.hsb=function(){return"hsb("+Math.random()+", 1, 1)"},c.rgb=function(){return"rgb("+[i(),i(),i()]+")"},c.vivid=function(a){a||(a=[[150,256],[0,190],[0,30]]);var b=function(){var b=a.splice(Math.floor(Math.random()*a.length),1)[0];return Math.floor(Math.random()*(b[1]-b[0]))+b[0]};return"rgb("+b()+","+b()+","+b()+")"},b.random=c}(jQuery,ui),function(a,b){"use strict";function c(){}function d(){this.duration=500,this.fps=60,this.onBegin=!1,this.onEnd=!1,this.loop=!1,this.isStarted=!1}var e,f,g,h=["ms","moz","webkit","o"];if(e=window.requestAnimationFrame,f=window.cancelAnimationFrame,!e)for(g=0;g<h.length&&!e;g++)e=window[h[g]+"RequestAnimationFrame"],f=window[h[g]+"CancelAnimationFrame"]||window[h[g]+"CancelRequestAnimationFrame"];e||(e=function(a,b){b=b||60,setTimeout(a,1e3/b)}),f||(f=function(a){clearTimeout(a)}),b.AnimationStyle={easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((6*a-1)*(2*Math.PI)/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},swing:function(a){return.5-Math.cos(a*Math.PI)/2},bounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?2-(7.5625*(a-=1.5/2.75)*a+.75):a<2.5/2.75?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)},linear:function(a){return a},sinusoidal:function(a){return-Math.cos(a*Math.PI)/2+.5},reverse:function(a){return 1-a},mirror:function(a,c){return(c=c||b.AnimationStyle.sinusoidal)(a<.5?2*a:1-2*(a-.5))},flicker:function(a){return a+=(Math.random()-.5)/5,b.AnimationStyle.sinusoidal(a<0?0:a>1?1:a)},wobble:function(a){return-Math.cos(a*Math.PI*(9*a))/2+.5},pulse:function(a,b){return-Math.cos(a*((b||5)-.5)*2*Math.PI)/2+.5},blink:function(a,b){return Math.round(a*(b||5))%2},spring:function(a){return 1-Math.cos(4.5*a*Math.PI)*Math.exp(6*-a)},none:function(a){return 0},full:function(a){return 1}},d.prototype=new b.ArrayFaker,d.prototype.addTarget=function(a,b){return 1===arguments.length&&(b=a,a=b.target),b&&(b.target=a,this.push(b)),this},d.prototype.removeTarget=function(a){var c=-1;if("number"!==b.core.type(a)){for(var d=0;d<this.length;d++)if(this[d]===a){c=d;break}}else c=a;c<0||this.splice(c,1)},d.prototype.doAnimation=function(){var b,c,d,f;if(0!==this.length){this.isStarted=!0,b=parseInt(this.fps,10)||60,f=this,d=this.length;var g=(new Date).getTime();this.stopHandle=null,function(){var h=function(){var b,i,j,k,l;for(b=(new Date).getTime(),i=b-g,c=0;c<d;c++)if(j=f[c],k=j.duration||f.duration,!(j.disabled||i<j.delay))try{k+j.delay<=i?(l=1,j.disabled=!0):l=j.ease((i-j.delay)/k),j.current=Math.ceil(j.begin+l*j.change),j.onChange(j.current,j.target,f)}catch(a){f.promise._reject(a)}f.duration<=i?(f.isStarted=!1,f.stopHandle=null,a.isFunction(f.onEnd)&&f.onEnd.call(f)):f.stopHandle=e(h)};f.stopHandle=e(h,1e3/b)}()}},d.prototype._prepare=function(){var a,d,e,f,g=0;for(a=0,d=this.length;a<d;a++)e=this[a],e||(this.splice(a,1),a--),e.disabled=!1,e.begin=e.begin||0,e.end=e.end||0,e.change=e.end-e.begin,e.current=e.begin,0!==e.change?(e.onChange=e.onChange||c,e.ease=e.ease||b.AnimationStyle.easeFromTo,e.duration=e.duration||0,e.delay=e.delay||0,f=e.duration+e.delay,f>this.duration&&(this.duration=f)):(e.disabled=!0,g++);return this.length==g},d.prototype.start=function(a){var d,e,f,g,h,i;return this.onBegin=b.core.isFunction(this.onBegin)?this.onBegin:c,this.onEnd=b.core.isFunction(this.onEnd)?this.onEnd:c,f=new Promise(function(a,b){d=a,e=b}),this.promise=f,this.promise._resolve=d,this.promise._reject=e,this.isStarted||(b.core.isNumber(a)&&a>0&&(this.duration=a),this.duration=parseInt(this.duration,10)||500,g=this._prepare(),this.onBegin.call(this),i=this,g?setTimeout(function(){i.onEnd.call(i),f._resolve(i)}):(h=this.onEnd,this.onEnd=function(){this.onEnd=h,h.call(this),f._resolve(this)},this.doAnimation())),f},d.prototype.stop=function(){
f(this.stopHandle),this.isStarted=!1,this.stopHandle=null,this.promise&&(this.promise=null)},b.animator=function(a,b){var c=new d;return c.addTarget.apply(c,arguments),c}}(jQuery,ui),function(a,b){"use strict";function c(a){this._listeners={},this._eventTarget=a||this}c.prototype={constructor:c,addEventListener:function(a,b,c,d){isFinite(c)&&(d=c,c=null),d=d||0;var e,f,g=this._listeners[a],h=0;for(g||(this._listeners[a]=g=[]),f=g.length;--f>-1;)e=g[f],e.callback===b?g.splice(f,1):0===h&&e.priority<d&&(h=f+1);g.splice(h,0,{callback:b,scope:c,priority:d})},removeEventListener:function(a,b){var c,d=this._listeners[a];if(d)for(c=d.length;--c>-1;)if(d[c].callback===b)return void d.splice(c,1)},dispatchEvent:function(a){var b=this._listeners[a];if(b&&b.length>0){for(var c,d,e=this._eventTarget,f=Array.apply([],arguments),g=b.length;--g>-1;)c=b[g],e=c.scope||e,f[0]={type:a,target:e},d=c.callback.apply(e,f);return d}},hasEvent:function(a){var b=this._listeners[a];return b&&b.length>0},initEvents:function(a,b){if(b||(b=this._eventTarget),a||(a=b.events),Array.isArray(a)&&0!==a.length){var c=this;b.on=function(a,b,d,e){c.addEventListener(a,b,d,e)},b.off=function(a,b){c.removeEventListener(a,b)},b.fire=function(a){var b=Array.apply([],arguments);return c.dispatchEvent.apply(c,b)};for(var d,e=0,f=a.length;e<f;e++)d=a[e],b[d]=this._createEventFunction(d,b)}},_createEventFunction:function(a,b){var c=a;return function(a,d,e){arguments.length>0&&b.on(c,a,d,e)}}},b.CustomEvent=c}(jQuery,ui),function($,ui){"use strict";function f(a){return a<10?"0"+a:a}function this_value(){return this.valueOf()}function quote(a){return rx_escapable.lastIndex=0,rx_escapable.test(a)?'"'+a.replace(rx_escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;c<f;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;c<f;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}var hasJSON="[object JSON]"===Object.prototype.toString.call(window.JSON)&&ui.core.isFunction(window.JSON.parse)&&ui.core.isFunction(window.JSON.stringify);if(!hasJSON){var JSON={fake:!0},rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;d<c;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})},JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}}(jQuery,ui),function(a,b){"use strict";function c(a,c){var f=null;if(401==a.status)return d(c);if(403==a.status)return e(c);if(200==a.status&&(f=a.getResponseHeader(k),!b.str.isNullOrEmpty(f))){try{f=JSON.parse(f)}catch(a){f=null}if(f){if(401==f.status)return d(c);if(403==f.status)return e(c)}}return!0}function d(a){var b,c=location.href;return alert("等待操作超时，您需要重新登录"),b=c.indexOf("#"),b>0&&(c=c.substring(0,b)),location.replace(),!1}function e(a){var b={message:"您没有权限执行此操作，请更换用户重新登录或联系系统管理员。"};return a&&a.errorFn&&a.errorFn(b),!1}function f(a,b,d,e){var f=c(e,a);f!==!1&&a.successFn(b)}function g(a,b,d,e){var f=c(b,a);if(f!==!1){if("parsererror"===d)a.error.message="没能获取预期的数据类型，转换json发生错误",a.error.responseText=b.responseText;else try{f=JSON.parse(b.responseText),a.error.message=f.Message}catch(c){a.error.message=b.responseText}a.errorFn(a.error)}}function h(a){var c,d=[],e=function(a,c){if(a){var e=b.core.isFunction(c)?c():c;d.push(encodeURIComponent(a)+"="+encodeURIComponent(null===e?"":e))}};if(Array.isArray(a))for(c=0;c<a.length;c++)e(a[c].name,a[c].value);else for(c in a)a.hasOwnProperty(c)&&e(c,a[c]);return d.join("&")}function i(a){return JSON.stringify(a)}function j(c,d,e,j,k,l){var m,n,o,p={error:{}};return b.core.isFunction(e)&&(k=j,j=e,e=null),o={type:"GET"===c.toUpperCase()?"GET":"POST",contentType:"application/json; charset=utf-8",dataType:"json",url:d,async:!0,data:e},l&&(o=a.extend(o,l)),m=b.core.type(e),n=o.contentType.indexOf("application/json")>-1?i:h,"string"!==m&&("array"===m||b.core.isPlainObject(e)?e=n(e):null===e||void 0===e||isNaN(e)?e="":e+=""),b.core.isFunction(j)&&(p.successFn=j,o.success=function(a,b,c){f(p,a,b,c)}),b.core.isFunction(k)&&(p.errorFn=k,o.error=function(a,b,c){g(p,a,b,c)}),a.ajax(o)}var k="X-Responded-JSON";b.ajax={get:function(a,b,c,d,e){return e||(e={}),e.contentType="application/x-www-form-urlencoded",j("GET",a,b,c,d,e)},post:function(a,b,c,d,e){return e||(e={}),e.contentType="application/x-www-form-urlencoded",j("POST",a,b,c,d,e)},postJson:function(a,b,c,d,e){return j("POST",a,b,c,d,e)},postOnce:function(a,c,d,e,f,g){var h,i,k;if(a=b.getJQueryElement(a),!a)throw new Error("没有正确设置要禁用的按钮");return g||(g={}),i="正在{0}...",g.textFormat&&(i=g.textFormat,delete g.textFormat),a.attr("disabled","disabled"),k=function(){a.removeAttr("disabled")},a.isNodeName("input")?(h=a.val(),h.length>0?a.val(b.str.stringFormat(i,h)):a.val(b.str.stringFormat(i,"处理")),k=function(){a.val(h),a.removeAttr("disabled")}):(h=a.html(),b._rhtml.test(h)||(a.text(b.str.stringFormat(i,h)),k=function(){a.text(h),a.removeAttr("disabled")})),g.complete=k,j("POST",c,d,e,f,g)},all:function(){var a,c;if(1==arguments.length)a=[arguments[0]];else{if(!(arguments.length>1))return;a=[].slice.call(arguments,0)}return c=Promise.all(a),c._then_old=c.then,c.then=function(){var a;return arguments.length>1&&b.core.isFunction(arguments[1])&&(a={error:{},errorFn:arguments[1]},arguments[1]=function(b){g(a,b)}),this._then_old.apply(this,arguments)},c}}}(jQuery,ui),function(a,b){"use strict";function c(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return decodeURIComponent(a.replace(/\+/g," "))}catch(b){return a}}b.cookie={stringify:function(a,b,c){var d=[a+"="+encodeURIComponent(b)];return isFinite(c)&&"number"==typeof c?d.push("Max-Age="+c):(c=c||{},c.maxAge&&d.push("Max-Age="+c.maxAge),c.domain&&d.push("Domain="+c.domain),c.path&&d.push("Path="+c.path),c.expires&&d.push("Expires="+c.expires.toUTCString()),c.httpOnly&&d.push("HttpOnly"),c.secure&&d.push("Secure")),d.join("; ")},forEach:function(a){var b=String(document.cookie).split(/; */);b.forEach(function(b){var d=b.indexOf("=");if(d!==-1){var e=b.substr(0,d).trim(),f=b.substr(++d,b.length).trim();a(e,c(f))}})},get:function(a){var b;try{Cookie.forEach(function(c,d){if(c===a)throw b=d,""})}catch(a){}return b},getAll:function(){var a={};return Cookie.forEach(function(b,c){b in a||(a[b]=c)}),a},set:function(a,b,c){document.cookie=Cookie.stringify.apply(0,arguments)},remove:function(a,b){b=b||{},b.expires||(b.expires=new Date(1970,0,1)),Cookie.set(a,"",b)},clear:function(){Cookie.forEach(function(a,b){Cookie.remove(a)})}}}(jQuery,ui),function(a,b){"use strict";function c(a){return a=a||0,a=parseInt(a,10),isNaN(a)&&(a=0),a=Math.round(Math.min(Math.max(0,a),255)),i.charAt((a-a%16)/16)+i.charAt(a%16)}function d(a){return i.indexOf(a.toUpperCase())}var e=/^[\#]([a-fA-F\d]{6}|[a-fA-F\d]{3})$/,f=/^rgb[\(]([\s]*[\d]{1,3}[\,]{0,1}[\s]*){3}[\)]$/i,g=/^rgba[\(]([\s]*[\d]{1,3}[\,][\s]*){3}(([\d])|(([0])?[\.][\d]+))[\)]$/i,h=/(([\d]*[\.][\d]+)|([\d]+))/gm,i="0123456789ABCDEF";b.color={parseRGB:function(a){var b,c;return f.test(a)&&(b=a.match(h))?c={red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10)}:null},parseRGBA:function(a){var b,c;return g.test(a)&&(b=a.match(h))?c={red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10),alpha:parseFloat(b[3])}:null},parseHex:function(a){var c,e,f;if(b.str.isEmpty(a))return null;if("#"===a.charAt(0)&&(a=a.substring(1)),3===a.length)for(e="",c=0;c<a.length;c++)e+=a.charAt(c)+a.charAt(c);else e=a;return f={},a=e.substring(0,2),f.red=16*d(a.charAt(0))+d(a.charAt(1)),a=e.substring(2,4),f.green=16*d(a.charAt(0))+d(a.charAt(1)),a=e.substring(4,6),f.blue=16*d(a.charAt(0))+d(a.charAt(1)),f},rgb2hex:function(a,b,d){return"#"+c(a)+c(b)+c(d)},overlay:function(a,b,c){var d,i,j,k;isNaN(c)&&(c=.5),d=function(a){var b;return e.test(a)?this.parseHex(a):f.test(a)||g.test(a)?(b=a.match(h),{red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10)}):a},a=d.call(this,a),b=d.call(this,b),i=[a.red||0,a.green||0,a.blue||0],j=[b.red||0,b.green||0,b.blue||0],k=[];for(var l=0,m=i.length;l<m;l++)k[l]=Math.floor((1-c)*i[l]+c*j[l]);return{red:k[0],green:k[1],blue:k[2]}}}}(jQuery,ui),function(a,b){"use strict";function c(a,b){return a=(""+a).replace(/_/g,"."),b=b||1,a=String(a).split("."),a=a[0]+"."+(a[1]||"0"),a=Number(a).toFixed(b)}function d(a,b,c){a.name=b,a.version=c,a[b]=c}var e,f,g,h,i=(navigator.platform||"").toLowerCase(),j=navigator.userAgent.toLowerCase(),k=k;e={name:void 0!==window.orientation?"iPod":(i.match(/mac|win|linux/i)||[k])[0],version:0,iPod:0,iPad:0,iPhone:0,iOS:0,android:0,windowsPhone:0,win:0,linux:0,mac:0},(h=j.match(/windows ([\d.]+)/))?d(e,"win",c(h[1])):(h=j.match(/windows nt ([\d.]+)/))?d(e,"win",c(h[1])):(h=j.match(/linux ([\d.]+)/))?d(e,"linux",c(h[1])):(h=j.match(/mac ([\d.]+)/))?d(e,"mac",c(h[1])):(h=j.match(/ipod ([\d.]+)/))?d(e,"iPod",c(h[1])):(h=j.match(/ipad[\D]*os ([\d_]+)/))?d(e,"iPad",c(h[1])):(h=j.match(/iphone[\D]*os ([\d_]+)/))?d(e,"iPhone",c(h[1])):(h=j.match(/android ([\d.]+)/))?d(e,"android",c(h[1])):(h=j.match(/windows phone ([\d.]+)/))?d(e,"windowsPhone",c(h[1])):0,(e.iPhone||e.iPad)&&(e.iOS=e.iPhone||e.iPad),f={name:k,version:0,ie:0,edge:0,firefox:0,chrome:0,opera:0,safari:0,mobileSafari:0,adobeAir:0},(h=j.match(/edge\/([\d.]+)/))?d(f,"edge",c(h[1])):(h=j.match(/trident.*; rv\:([\d.]+)/))?d(f,"ie",c(h[1])):(h=j.match(/msie ([\d.]+)/))?d(f,"ie",c(h[1])):(h=j.match(/firefox\/([\d.]+)/))?d(f,"firefox",c(h[1])):(h=j.match(/chrome\/([\d.]+)/))?d(f,"chrome",c(h[1])):(h=j.match(/opera.([\d.]+)/))?d(f,"opera",c(h[1])):(h=j.match(/adobeair\/([\d.]+)/))?d(f,"adobeAir",c(h[1])):(h=j.match(/version\/([\d.]+).*safari/))?d(f,"safari",c(h[1])):0,(h=j.match(/version\/([\d.]+).*mobile.*safari/))?d(f,"mobileSafari",c(h[1])):0,e.iPad&&d(f,"mobileSafari","0.0"),f.ie&&(document.documentMode?document.documentMode!==Math.floor(f.ie)&&d(f,"ie",c(document.documentMode)):document.documentMode=Math.floor(f.ie)),g={name:k,version:0,trident:0,gecko:0,webkit:0,presto:0},(h=j.match(/trident\/([\d.]+)/))?d(g,"trident",c(h[1])):(h=j.match(/gecko\/([\d.]+)/))?d(g,"gecko",c(h[1])):(h=j.match(/applewebkit\/([\d.]+)/))?d(g,"webkit",c(h[1])):(h=j.match(/presto\/([\d.]+)/))?d(g,"presto",c(h[1])):0,f.ie&&(6==f.ie?d(g,"trident",c("4")):7!=f.ie&&8!=f.ie||d(g,"trident",c("5"))),b.platform=e,b.browser=f,b.engine=g}(jQuery,ui),function(a,b){"use strict";function c(){return this instanceof c?void this.initialize():new c}c.fitCenter=function(){this.displayWidth=this.originalWidth,this.displayHeight=this.originalHeight,this.marginTop=0,this.marginLeft=0,this.width>this.height?(this.originalHeight>this.height&&(this.displayHeight=this.height),this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.displayWidth>this.width?(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.marginTop=Math.floor((this.height-this.displayHeight)/2)):(this.marginLeft=Math.floor((this.width-this.displayWidth)/2),this.marginTop=Math.floor((this.height-this.displayHeight)/2))):(this.displayWidth>this.width&&(this.displayWidth=this.width),this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.displayHeight>this.height?(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.marginLeft=Math.floor((this.width-this.displayWidth)/2)):(this.marginLeft=Math.floor((this.width-this.displayWidth)/2),this.marginTop=Math.floor((this.height-this.displayHeight)/2)))},c.centerCrop=function(){this.displayWidth=this.originalWidth,this.displayHeight=this.originalHeight,this.marginTop=0,this.marginLeft=0,this.width>this.height?(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.displayWidth>this.width?this.marginLeft=-Math.floor((this.displayWidth-this.width)/2):this.displayWidth<this.width&&(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.marginTop=-Math.floor((this.displayHeight-this.height)/2))):(this.displayWidth=this.width,this.displayHeight=Math.floor(this.originalHeight*(this.displayWidth/this.originalWidth)),this.displayHeight>this.height?this.marginTop=-Math.floor((this.displayHeight-this.height)/2):this.displayHeight<this.height&&(this.displayHeight=this.height,this.displayWidth=Math.floor(this.originalWidth*(this.displayHeight/this.originalHeight)),this.marginLeft=-Math.floor((this.displayWidth-this.width)/2)))},c.prototype={constructor:c,initialize:function(){this.src=null,this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.originalWidth=0,this.originalHeight=0},load:function(a,d,e,f){if(!b.core.isString(a)||0===a.length)throw new TypeError("图片src不正确");this.src=a,this.width=d,this.height=e;var g=this;b.core.isFunction(f)||(f=c.fitCenter);var h=new Promise(function(b,c){var d=new Image;d.onload=function(){d.onload=null,g.originalWidth=d.width,g.originalHeight=d.height,f.call(g),b(g)},d.onerror=function(){c(d)},d.src=a});return h}},b.ImageLoader=c}(jQuery,ui),function(a,b){"use strict";function c(){if(window.VBArray){var a=h.documentMode;return a?a:window.XMLHttpRequest?7:6}return 0}function d(a,b){var c=0;return b.wheelDelta?(c=b.wheelDelta/120,window.opera&&window.opera.version()<10&&(c=-c)):b.detail&&(c=-b.detail/3),a.delta=Math.round(c),a}function e(c,d){if(b.core.isDomObject(d))d=a(d);else if(b.core.isJQueryObject(d)&&0===d.length)return!1;c="on"+c;var e=c in d[0];return e||(d.attr(c,"return;"),e="function"===b.core.type(d[c])),e}var f,g=/[^, ]+/g,h=document;f=c(),a.fn.nodeName=function(){var a=this.prop("nodeName");return 0!==this.length&&a?a:null},a.fn.isNodeName=function(a){return this.nodeName()===(a+"").toUpperCase()},a.fn.hasHorizontalScroll=function(){var a=this.css("overflow");return"visible"!==a&&"hidden"!==a&&("scroll"===a||this.get(0).scrollWidth>this.width())},a.fn.hasVerticalScroll=function(){var a=this.css("overflow");return"visible"!==a&&"hidden"!==a&&("scroll"===a||this.get(0).scrollHeight>this.height())},a.fn.zIndex=function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(c=e.css("position"),("absolute"===c||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0},a.fn.bindOptions=function(a,b,c){if("SELECT"!==this.nodeName())return this;if(b||(b="value"),c||(c="text"),!a.length)return this;var d,e,f=a.length,g=[];for(d=0;d<f;d++)e=a[d],e&&g.push("<option value='",e[b],"'>",e[c],"</option>");return this.html(g.join("")),this},a.fn.selectOption=function(){if("SELECT"!==this.nodeName())return null;var a={value:this.val(),text:null};return a.text=this.children("option[value='"+a.value+"']").text(),a},a.fn.setImage=function(a,c,d,e){var f,g,h,i;if("IMG"==this.nodeName())return i=this,b.core.isPlainObject(a)&&(f=a,a=f.src,c=f.width,d=f.height,e=f.fillMode),g=this.parent(),arguments.length<2?"BODY"==g.nodeName()?(c=root.clientWidth,d=root.clientHeight):(c=g.width(),d=g.height()):b.core.isNumber(c)&&b.core.isNumber(d)||(c=320,d=240),b.core.isFunction(e)||(e=b.ImageLoader.fitCenter),h=b.ImageLoader(),h.load(a,c,d,e).then(function(b){var c={"vertical-align":"top"};return c.width=b.displayWidth+"px",c.height=b.displayHeight+"px",c["margin-top"]=b.marginTop+"px",c["margin-left"]=b.marginLeft+"px",i.css(c),i.prop("src",a),b},function(a){return i.prop("src",b.text.empty),a})},a.fn.mousewheel=function(a,b){var c=e("mousewheel",this)?"mousewheel":"DOMMouseScroll";return arguments.length>0?this.on(c,null,a,b):this.trigger(c)},a.fn.jquery>="3.0.0"?"mousewheel DOMMouseScroll".replace(g,function(a){jQuery.event.special[a]={delegateType:a,bindType:a,handle:function(a){var b,c=a.originalEvent,e=a.handleObj;return d(a,c),b=e.handler.apply(this,arguments)}}}):"mousewheel DOMMouseScroll".replace(g,function(a){jQuery.event.fixHooks[a]={filter:d}}),f&&a(h).on("selectionchange",function(a){var b=h.activeElement;b&&"function"==typeof b.uiEventSelectionChange&&b.uiEventSelectionChange()}),a.fn.textinput=function(a,c){var d,e;if(0!==this.length&&(b.core.isFunction(a)&&(c=a,a=null),b.core.isFunction(c)&&(eventMock={data:a,target:this[0]},d=!1,e=this.nodeName(),"INPUT"===e||"TEXTAREA"===e)))return f?(9===f&&(this[0].uiEventSelectionChange=function(){c(eventMock)}),f>8?this.on("input",null,a,c):(this.on("propertychange",function(a){var b=a.originalEvent?a.originalEvent.propertyName:a.propertyName;"value"===b&&c(eventMock)}),this.on("dragend",null,a,function(a){setTimeout(function(){c(a)})}))):(this.on("input",null,a,function(a){d||c(a)}),this.on("compositionstart",function(a){d=!0}),this.on("compositionend",function(a){d=!1,c(a)})),this}}(jQuery,ui),function(a,b){"use strict";function c(){}function d(a){var b,c,d,e,f;for(b=a.split("."),c=window,e=0,f=b.length;e<f;e++)d=b[e],c[d]||(c[d]={}),c=c[d];return c}function e(b,c){var e,f,g,h={name:null,namespace:null,fullName:b,constructor:c};return g=b.lastIndexOf("."),g<0?(h.name=b,f=window[h.name],h.constructor=window[h.name]=c):(h.namespace=b.substring(0,g),h.name=b.substring(g+1),e=d(h.namespace),f=e[h.name],h.constructor=e[h.name]=c),f&&a.extend(c,h.constructor),h}function f(c,d,f,g){var h,i,j={};return b.core.isFunction(g)||(g=function(){}),h=e(c,g),d?i=new d:(i={},i.namespace=""),i.option=a.extend({},i.option),a.each(f,function(b,c){if(a.isFunction(c)){var e=d.prototype[b];a.isFunction(e)&&(delete f[b],j[b]=function(){var a=function(){return d.prototype[b].apply(this,arguments)},e=function(a){return d.prototype[b].apply(this,a)};return function(){var b,d=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=c.apply(this,arguments),this._super=d,this._superApply=f,b}}())}}),h.constructor.prototype=a.extend(i,f,j,h),h.constructor}function g(){}g.prototype={constructor:g,ctrlName:"CtrlBase",namespace:"ui.ctrls",version:b.version,option:{},extend:function(a){for(var c,d,e,f=Array.prototype.slice.call(arguments,1),g=0,h=f.length;g<h;g++){c=f[g];for(d in c)e=c[d],c.hasOwnProperty(d)&&void 0!==e&&(b.core.isPlainObject(e)?a[d]=b.core.isPlainObject(a[d])?this.extend({},a[d],e):this.extend({},e):null!==e&&void 0!==e&&(a[d]=e))}return a},mergeEvents:function(a,b){var c,d;if(!Array.isArray(a))return b;for(c={},d=0,len=a.length;d<len;d++)c.hasOwnProperty(a[d])||(c[a[d]]=!0);for(d=0,len=b.length;d<len;d++)c.hasOwnProperty(b[d])||(c[b[d]]=!0);b=[];for(d in c)c.hasOwnProperty(d)&&b.push(d);return b},_initialize:function(a,c){var d;return this.document=document,this.window=window,this.element=c||null,this.option=this.extend({},this.option,this._defineOption(),a),d=this._defineEvents(),Array.isArray(d)&&d.length>0&&(this.eventDispatcher=new b.CustomEvent(this),this.eventDispatcher.initEvents(d)),this._create(),this._render(),this},_defineOption:c,_defineEvents:c,_create:c,_render:c,defineProperty:function(c,d,e){var f,g={};if(!b.core.isString(c)||0===c.length)throw new TypeError("参数propertyName只能是String类型并且不能为空");if("undefined"!=typeof Reflect&&b.core.isFunction(Reflect.defineProperty))f=Reflect.defineProperty;else{if(!b.core.isFunction(Object.defineProperty))return;f=Object.defineProperty}b.core.isFunction(d)&&(g.get=a.proxy(d,this)),b.core.isFunction(e)&&(g.set=a.proxy(e,this)),g.enumerable=!1,g.configurable=!1,f(this,c,g)},toString:function(){return this.fullName}},b.ctrls={CtrlBase:g},b.define=function(a,c,d){var e,g;return b.core.isString(a)&&0!==a.length?(e=a.indexOf("."),e<0?a="ui.ctrls."+a:"ui"!==a.substring(0,e)&&(a="ui."+a),d||(d=c,c=b.ctrls.CtrlBase),g=f(a,c,d,function(a,c){return this instanceof b.ctrls.CtrlBase?void(arguments.length&&this._initialize(a,c)):new g(a,c)})):null}}(jQuery,ui),function(a,b){"use strict";function c(a){var c,d;1===a.which&&(c={target:a.target,option:this.option},c.currentX=this.currentX=a.pageX,c.currentY=this.currentY=a.pageY,b.core.isFunction(this.option.onBeginDrag)&&(d=this.option.onBeginDrag.call(this,c),d===!1)||(g.on("mousemove",this.onMouseMoveHandler).on("mouseup",this.onMouseUpHandler).on("mouseleave",this.onMouseUpHandler),document.onselectstart=function(){return!1},this.option.target.addClass("cancel-user-select"),this._isDragStart=!0,this.shield&&h.append(this.shield)))}function d(a){var c={target:a.target,option:this.option};this._isDragStart&&(c.x=a.pageX-this.currentX,c.y=a.pageY-this.currentY,c.currentX=this.currentX=a.pageX,c.currentY=this.currentY=a.pageY,b.core.isFunction(this.option.onMoving)&&this.option.onMoving.call(this,c))}function e(a){var c={target:a.target,option:this.option};1===a.which&&this._isDragStart&&(this._isDragStart=!1,this.currentX=this.currentY=null,g.off("mousemove",this.onMouseMoveHandler).off("mouseup",this.onMouseUpHandler).off("mouseleave",this.onMouseUpHandler),document.onselectstart=null,this.option.target.removeClass("cancel-user-select"),b.core.isFunction(this.option.onEndDrag)&&this.option.onEndDrag.call(this,c),this.shield&&this.shield.remove())}function f(a){return this instanceof f?void this.initialize(a):new f(a)}var g=a(document),h=a(document.body),i={context:null,target:null,handle:null,parent:h,hasIframe:!1,onBeginDrag:null,onMoving:null,onEndDrag:null};f.prototype={constructor:f,initialize:function(b){this.doc=null,this.shield=null,this.isTurnOn=!1,this.option=a.extend({},i,b),this.doc=this.option.doc,this.option.hasIframe===!0&&(this.shield=a("<div class='drag-shield'>"),this.shield.css({position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%","z-index":"999999","background-color":"#fff",filter:"Alpha(opacity=1)",opacity:".01"})),this.onMouseDownHandler=a.proxy(c,this),this.onMouseMoveHandler=a.proxy(d,this),this.onMouseUpHandler=a.proxy(e,this)},on:function(){var a,b=this.option.target,c=this.option.handle,d=this.option.parent;this.isTurnOn||(this.isTurnOn=!0,d.isNodeName("body")||(a=d.css("position"),this.originParentPosition=a,"absolute"!==a&&"relative"!==a&&"fixed"!==a&&d.css("position","relative")),this.originTargetPosition=b.css("position"),"absolute"!==this.originTargetPosition&&b.css("position","absolute"),c.on("mousedown",this.onMouseDownHandler),this.option.target&&this.option.target.data("mouse-dragger",this))},off:function(){var a=this.option.handle;this.isTurnOn&&(this.isTurnOn=!1,a.off("mousedown",this.onMouseDownHandler).css("position",this.originTargetPosition),this._isDragStart&&this.onMouseUpHandler({target:document,which:1}),this.option.parent.css("position",this.originParentPosition))}},b.MouseDragger=f,a.fn.draggable=function(a){var c;if(a&&a.target&&a.parent&&b.core.isDomObject(this[0])&&"BODY"!==this.nodeName())return a.handle=this,a.getParentCssNum=function(b){return parseFloat(a.parent.css(b))||0},a.onBeginDrag=function(a){var b=this.option;p=b.parent.offset(),p||(p={top:0,left:0}),b.topLimit=p.top+b.getParentCssNum("border-top")+b.getParentCssNum("padding-top"),b.leftLimit=p.left+b.getParentCssNum("border-left")+b.getParentCssNum("padding-left"),b.rightLimit=p.left+(b.parent.outerWidth()||b.parent.width()),b.bottomLimit=p.top+(b.parent.outerHeight()||b.parent.height()),b.targetWidth=b.target.outerWidth(),b.targetHeight=b.target.outerHeight()},a.onMoving=function(a){var b=this.option,c=b.target.position();c.top+=a.y,c.left+=a.x,c.top<b.topLimit?c.top=b.topLimit:c.top+b.targetHeight>b.bottomLimit&&(c.top=b.bottomLimit-b.targetHeight),c.left<b.leftLimit?c.left=b.leftLimit:c.left+b.targetWidth>b.rightLimit&&(c.left=b.rightLimit-b.targetWidth),b.target.css({top:c.top+"px",left:c.left+"px"})},c=b.MouseDragger(a),c.on(),this},a.fn.undraggable=function(){var a;0!==this.length&&(a=this.data("mouse-dragger"),a&&a instanceof f&&a.off())}}(jQuery,ui),function(a,b){"use strict";function c(){var a=this.prop("cssRules")||this.prop("rules");return a}function d(a,b){for(var c,d=0,e=a.length;d<e&&(c=a[d],!c.selectorText||b.call(this,c,d)!==!1);d++);}function e(a){return this instanceof e?void this.initialize(a):new e(a)}e.prototype={constructor:e,initialize:function(c){var d,e;this.styleSheet=null,b.core.isString(c)&&c.length>0?(e=a("#"+c),d=e.nodeName(),"STYLE"!==d&&"LINK"!==d||(this.styleSheet=e.prop("sheet"),this.styleSheet||(this.styleSheet=e.prop("styleSheet")),this.styleSheet&&(this.styleSheet=a(this.styleSheet)))):b.core.isJQueryObject(c)?this.styleSheet=c:b.core.isDomObject(c)&&(this.styleSheet=a(c))},disabled:function(){return 0===arguments.length?this.styleSheet.prop("disabled"):void this.styleSheet.prop("disabled",!!arguments[0])},getRule:function(a){var e,f=null;return b.str.isEmpty(a)?null:this.styleSheet&&0!==this.styleSheet.length?(a=a.toLowerCase(),e=c.call(this.styleSheet),d(e,function(b,c){if(b.selectorText.toLowerCase()===a)return f=b,!1}),f):null},setRule:function(d,e){var f,g,h;if(!b.str.isEmpty(d)&&e){if(g=this.getRule(d),!g){if(d=d.toLowerCase(),f=c.call(this.styleSheet),h=f.length,b.core.isFunction(this.styleSheet[0].insertRule))this.styleSheet[0].insertRule(d+" {}",h);else{if(!b.core.isFunction(this.styleSheet[0].addRule))return;this.styleSheet[0].addRule(d," ",h)}f=c.call(this.styleSheet),g=f[h]}a(g).css(e)}},removeRule:function(a){var e,f;b.str.isEmpty(a)||this.styleSheet&&0!==this.styleSheet.length&&(f=this.styleSheet[0].deleteRule,b.core.isFunction(f)||(f=this.styleSheet[0].removeRule),a=a.toLowerCase(),e=c.call(this.styleSheet),d(e,function(c,d){if(c.selectorText.toLowerCase()===a)return b.core.isFunction(f)&&f.call(this.styleSheet[0],d),!1}))}},e.createStyleSheet=function(c){var d,f,g;return b.core.isFunction(document.createStyleSheet)?(f=document.createStyleSheet(),d=f.ownerNode||f.owningElement):(g=document.getElementsByTagName("head")[0],d=document.createElement("style"),g.appendChild(d),f=document.styleSheets[document.styleSheets.length-1]),b.str.isEmpty(c)||(d.id=c),new e(a(f))},b.StyleSheet=e}(jQuery,ui),function(a,b){"use strict";function c(c){var d,e;d=a("#"+b.theme.highlightSheetId),d.length>0&&(e=d.prop("href"),e=b.url.setParams({highlight:c.Id}),d.prop("href",e)),b.theme.currentHighlight=c,b.page.fire("hlchanged",c)}b.theme={currentTheme:"Light",currentHighlight:null,defaultHighlight:"Default",highlightSheetId:"highlight",getHighlight:function(a){var b,c,d,e;if(a||(a=this.defaultHighlight),Array.isArray(this.highlights))for(d=0,e=this.highlights.length;d<e;d++)if(c=this.highlights[d],c.Id===a){b=c;break}return b},changeHighlight:function(a,d){b.ajax.postJson(a,{themeId:d.Id},function(a){a.Result&&c(d)},function(a){b.msgshow("修改主题失败，"+a.message,!0)})},setHighlight:function(a){a&&c(a)},initHighlight:function(){var c,d,e;c=a("#"+b.theme.highlightSheetId),c.length>0&&(d=c.prop("href"),e=b.url.getParams(d).highlight),this.currentHighlight=this.getHighlight(e),b.page.fire("highlightChanged",e)}}}(jQuery,ui),function(a,b){"use strict";b.eventPriority={masterReady:3,pageReady:2,bodyResize:3,ctrlResize:2,elementResize:2};var c=b.page={_resizeDelay:300,_resizeTimeoutHandler:null,events:["themechanged","hlchanged","ready","htmlclick","docmouseup","resize","hashchange"]};c.event=new b.CustomEvent(c),c.event.initEvents(),a(document).ready(function(a){c.fire("ready")}).click(function(a){c.fire("htmlclick")}),a(window).on("resize",function(a){c._resizeTimeoutHandler&&clearTimeout(c._resizeTimeoutHandler),c._resizeTimeoutHandler=setTimeout(function(){c._resizeTimeoutHandler=null,c.fire("resize",document.documentElement.clientWidth,document.documentElement.clientHeight)},c._resizeDelay)}).on("hashchange",function(a){var b="";window.location.hash&&(b=window.location.hash),c.fire("hashchange",b)})}(jQuery,ui),function(a,b){"use strict";var c=[],d=function(a){var b,d;if(0!==c.length){for(d=[];;){if(b=c.shift(),!b)break;a&&a===b.ctrl||"retain"===b.func.call(b.ctrl)&&d.push(b)}c.push.apply(c,d)}};b.page.htmlclick(function(a){d()}),b.addHideHandler=function(a,d){a&&b.core.isFunction(d)&&c.push({ctrl:a,func:d})},b.hideAll=function(a){d(a)},b.define("ui.ctrls.DropDownBase",{showTimeValue:200,hideTimeValue:200,_create:function(){this.setLayoutPanel(this.option.layoutPanel),this.onMousemoveHandler=function(a){var b=this.element.width(),c=a.offsetX;c||(c=a.clientX-this.element.offset().left),b-c<0&&this.isShow()?(this.element.css("cursor","pointer"),this._clearable=!0):(this.element.css("cursor","auto"),this._clearable=!1)}.bind(this),this.onMouseupHandler=function(b){if(this._clearable){var c=this.element.width(),d=b.offsetX;d||(d=b.clientX-this.element.offset().left),c-d<0&&a.isFunction(this._clear)&&this._clear()}}.bind(this)},_render:function(){if(this.element){var a=this;this.element.hasClass(this._selectTextClass)&&(this.element.css("width",parseFloat(this.element.css("width"),10)-23+"px"),this.hasLayoutPanel()&&this.element.parent().css("width","auto")),this.element.focus(function(c){b.hideAll(a),a.show()}).click(function(a){a.stopPropagation()})}},wrapElement:function(b,c){if(c&&(this._panel=c,!this.hasLayoutPanel()))return void a(document.body).append(this._panel);if(b){var d={display:b.css("display"),position:b.css("position"),"margin-left":b.css("margin-left"),"margin-top":b.css("margin-top"),"margin-right":b.css("margin-right"),"margin-bottom":b.css("margin-bottom"),width:b.outerWidth()+"px",height:b.outerHeight()+"px"};"relative"!==d.position&&"absolute"!==d.position||(d.top=b.css("top"),d.left=b.css("left"),d.right=b.css("right"),d.bottom=b.css("bottom")),d.position="relative",0===d.display.indexOf("inline")?(d.display="inline-block",d["vertical-align"]=b.css("vertical-align"),b.css("vertical-align","top")):d.display="block";var e=a("<div class='dropdown-wrap' />").css(d);return b.css({margin:"0px"
}).wrap(e),e=b.parent(),c&&e.append(c),e}},isWrapped:function(a){return a||(a=this.element),a&&a.parent().hasClass("dropdown-wrap")},moveToElement:function(b,c){if(b){var d;!c&&this.element&&this.element[0]===b[0]||(this.hasLayoutPanel()?(d=this.isWrapped(b)?b.parent():this.wrapElement(b),d.append(this._panel)):a(document.body).append(this._panel))}},initPanelWidth:function(a){b.core.isNumber(a)||(a=this.element?this.element.width():100),this.panelWidth=a,this._panel.css("width",a+"px")},hasLayoutPanel:function(){return!!this.layoutPanel},setLayoutPanel:function(a){this.option.layoutPanel=a,this.layoutPanel=b.getJQueryElement(this.option.layoutPanel)},isShow:function(){return this._panel.hasClass(this._showClass)},show:function(a){b.addHideHandler(this,this.hide);var c,d,e,f,g,h,i,j,k,l;this.isShow()||(this._panel.addClass(this._showClass),g=this.element.outerWidth(),h=this.element.outerHeight(),this.hasLayoutPanel()?(c=this.layoutPanel,k=h,l=0,f=this.element.parent().position(),i=this._panel.outerWidth(),j=this._panel.outerHeight(),"hidden"===c.css("overflow")?(d=c.width(),e=c.height()):(d=c[0].scrollWidth,e=c[0].scrollHeight,d+=c.scrollLeft(),e+=c.scrollTop()),f.top+h+j>e&&f.top-j>0&&(k=-j),f.left+i>d&&(l=f.left-(f.left+i-d)>0?-(f.left+i-d):-f.left),this._panel.css({top:k+"px",left:l+"px"})):b.setDown(this.element,this._panel),this.doShow(this._panel,a))},doShow:function(b,c){var d,e=this;a.isFunction(c)||(c=void 0),d=this._clearClass?function(){e.element.addClass(e._clearClass),e.element.on("mousemove",e.onMousemoveHandler),e.element.on("mouseup",e.onMouseupHandler),c&&c.call(e)}:c,b.fadeIn(this.showTimeValue,d)},hide:function(a){this.isShow()&&(this._panel.removeClass(this._showClass),this.element.removeClass(this._clearClass),this.element.off("mousemove",this.onMousemoveHandler),this.element.off("mouseup",this.onMouseupHandler),this.element.css("cursor","auto"),this.doHide(this._panel,a))},doHide:function(b,c){a.isFunction(c)||(c=void 0),b.fadeOut(this.hideTimeValue,c)},_clear:null})}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.SidebarBase",{showTimeValue:300,hideTimeValue:300,_defineOption:function(){return{parent:null,width:240}},_defineEvents:function(){return["showing","showed","hiding","hided","resize"]},_create:function(){this.parent=b.getJQueryElement(this.option.parent),this.parent||(this.parent=a(document.body)),this._showClass="ui-sidebar-show",this.height=0,this.width=this.option.width||240,this.borderWidth=0},_render:function(){var c=this;this._panel=a("<aside class='ui-sidebar-panel border-highlight' />"),this._panel.css("width",this.width+"px"),this._closeButton=a("<button class='icon-button' />"),this._closeButton.append("<i class='fa fa-chevron-right'></i>"),this._closeButton.css({position:"absolute",border:"none 0",width:"20px",height:"20px","min-width":"auto",top:"5px",right:"5px","z-index":999}),this._closeButton.click(function(a){c.hide()}),this.element&&this._panel.append(this.element),this._panel.append(this._closeButton),this.parent.append(this._panel),this.borderWidth+=parseInt(this._panel.css("border-left-width"),10)||0,this.borderWidth+=parseInt(this._panel.css("border-right-width"),10)||0,setTimeout(function(){c.setWidth()}),b.page.resize(function(){c.setWidth()},b.eventPriority.ctrlResize),this.animator=b.animator({target:this._panel,ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}})},set:function(c){if(this.element&&this.element.remove(),b.core.isDomObject(c))c=a(c);else if(!b.core.isJQueryObject(c))return;this.element=c,this._closeButton.before(c)},append:function(c){if(b.core.isDomObject(c))c=a(c);else if(!b.core.isJQueryObject(c))return;this._panel.append(c),this.element||(this.element=c)},setWidth:function(a,c){var d=this.parent.width(),e=this.parent.height();this.height=e;var f={height:this.height+"px"},g=this.width;b.core.isNumber(a)&&(this.width=a,f.width=this.width+"px",g=a),this.hideLeft=d,this.left=d-this.width-this.borderWidth,this._panel.css(f),this.isShow()?this._panel.css({left:this.left+"px",display:"block"}):this._panel.css({left:this.hideLeft+"px",display:"none"}),c!==!1&&this.fire("resize",this.width,this.height)},isShow:function(){return this._panel.hasClass(this._showClass)},show:function(){var a,b,c,d=this;if(!this.isShow()){for(this.animator.stop(),this.animator.splice(1,this.length-1),this.animator.duration=this.showTimeValue,a=this.animator[0],a.target.css("display","block"),a.target.addClass(this._showClass),a.begin=parseFloat(a.target.css("left"),10)||this.hideLeft,a.end=this.left,b=0,c=arguments.length;b<c;b++)arguments[b]&&this.animator.addTarget(arguments[b]);return this.animator.onBegin=function(){d.fire("showing")},this.animator.onEnd=function(){this.splice(1,this.length-1),d.fire("showed")},this.animator.start()}return null},hide:function(){var a,b,c,d=this;if(this.isShow()){for(this.animator.stop(),this.animator.splice(1,this.length-1),this.animator.duration=this.hideTimeValue,a=this.animator[0],a.target.removeClass(this._showClass),a.begin=parseFloat(a.target.css("left"),10)||this.left,a.end=this.hideLeft,b=0,c=arguments.length;b<c;b++)arguments[b]&&this.animator.addTarget(arguments[b]);return this.animator.onBegin=function(){d.fire("hiding")},this.animator.onEnd=function(){this.splice(1,this.length-1),a.target.css("display","none"),d.fire("hided")},this.animator.start()}return null}})}(jQuery,ui),function(a,b){"use strict";function c(){}function d(a){return a<10?"0"+a:""+a}function e(a,c){return a||(a=""),b.core.isNumber(c)?"<span>"+b.str.moneyFormat(c,a)+"</span>":null}function f(a){var c=a;return c?(b.core.isString(a)&&(c=b.str.jsonToDate(c)),c):null}var g,h,i,j="_RowspanContext",k="_HoverView";new Error("column.len或width设置太小，无法绘制进度条！");g={checkAll:function(b){var c=a("<i class='fa fa-square grid-checkbox-all' />");return c.click(this.onCheckboxAllClickHandler),this.resetColumnStateHandlers.checkboxAllCancel=function(){c.removeClass("fa-check-square").addClass("fa-square"),this._checkedCount=0},c},columnText:function(b){var c=a("<span class='table-cell-text' />"),d=b.text;return void 0===d||null===d?null:(c.text(d),c)},empty:function(a){return null}},h={text:function(b,c){var d;return b+="","undefined"===b||"null"===b||"NaN"===b?null:(d=a("<span class='table-cell-text' />"),d.text(b),d)},empty:function(a,b){return null},rowNumber:function(b,c,d){var e;return"no-count"===b?null:(e=a("<span />"),e.text((this.pageIndex-1)*this.pageSize+(d+1)),e)},check:function(b,c){var d=a("<i class='fa fa-square grid-checkbox' />");return d.attr("data-value",b+""),d},paragraph:function(b,c){var d;return b+="","undefined"===b||"null"===b||"NaN"===b?null:(d=a("<p class='table-cell-block' />"),d.text(b),d)},date:function(b,c){var e,g=f(b);return null===g?null:(e=a("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())].join("")),e)},time:function(b,c){var e,g=f(b);return null===g?null:(e=a("<span />"),isNaN(g)?e.text("无法转换"):e.text([d(g.getHours()),":",d(g.getMinutes()),":",d(g.getSeconds())].join("")),e)},datetime:function(b,c){var e,g=f(b);return null===g?null:(e=a("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())," ",d(g.getHours()),":",d(g.getMinutes()),":",d(g.getSeconds())].join("")),e)},shortDatetime:function(b,c){var e,g=f(b);return null===g?null:(e=a("<span />"),isNaN(g)?e.text("无法转换"):e.text([g.getFullYear(),"-",d(g.getMonth()+1),"-",d(g.getDate())," ",d(g.getHours()),":",d(g.getMinutes())].join("")),e)},money:function(a,b){return e("￥",a)},cellPhone:function(b,c){var d;if(b)return d=a("<span />"),11===b.length?d.text(b.substring(0,3)+"-"+b.substring(3,7)+"-"+b.substring(7)):d.text(b),d},rowspan:function(b,c,d,e){var f;if(0===d)f=c[j]={rowSpan:1,value:b,td:e};else{if(f=c[j],f.value===b)return f.rowSpan++,f.td.prop("rowSpan",f.rowSpan),e.isAnnulment=!0,null;f.rowSpan=1,f.value=b,f.td=e}return a("<span />").text(b)}},i={getBooleanFormatter:function(b,c,d){var e,f,g=16;return b+="",c+="",2===arguments.length&&(d=""),e=g*b.length||g,f=g*c.length||g,function(g,h){var i=a("<span />");return g===!0?(i.addClass("state-text").addClass("state-true").css("width",e+"px"),i.text(b)):g===!1?(i.addClass("state-text").addClass("state-false").css("width",f+"px"),i.text(c)):i.text(d),i}},getNumberFormatter:function(c){return function(d,e){return b.core.isNumber(d)?a("<span />").text(b.str.numberScaleFormat(d,c)):null}},getMoneyFormatter:function(a){return function(b,c){return e(a,c)}},getProgressFormatter:function(c,d){return(!b.core.isNumber(c)||c<60)&&(c=!1),a.isNumeric(d)?d<1&&(d=null):d=null,function(e,f,g,h){var i,j,k,l,m,n,o;return j={},b.core.isNumber(e[0])?(j.value=e[0],j.total=d||e[1]||0):(j.value=e,j.total=d||0),0===j.total&&(j.total=1),b.core.isNumber(j.value)||(j.value=0),o=j.value/j.total,isNaN(o)&&(o=0),o=b.str.numberScaleFormat(100*o,2)+"%",i=a("<div class='cell-progress-panel' />"),k=a("<div class='cell-progress-bar' />"),n=c,b.core.isNumber(n)||(n=f.len-12),n-=52,k.css("width",n+"px"),l=a("<div class='cell-progress-value background-highlight' />"),l.css("width",o),k.append(l),m=a("<div class='cell-progress-text font-highlight'/>"),m.append("<span style='margin:0'>"+o+"</span>"),i.append(k),i.append(m),i.append("<br clear='all' />"),i}},getRowspanFormatter:function(a,b){return function(c,d,e,f){var g;if(0===e)g=d[j]={rowSpan:1,value:c[a],td:f};else{if(g=d[j],g.value===c[a])return g.rowSpan++,g.td.prop("rowSpan",g.rowSpan),f.isAnnulment=!0,null;g.rowSpan=1,g.value=c[a],g.td=f}return b.apply(this,arguments)}},getImageFormatter:function(c,d,e,f,g){var h;return(b.core.isNumber(c)||c<=0)&&(c=120),(b.core.isNumber(d)||c<=0)&&(d=90),e?e+="":e="",h=b.ctrls.ImageZoomer({getNext:function(b){var c=this.target,d=c.parent().parent(),e=d.parent(),f=e.parent(),g=f[0].rows.length,h=e[0].rowIndex+b,i=null;do{if(h<0||h>=g)return!1;i=a(f[0].rows[h].cells[d[0].cellIndex]).children(),c=i.children("img"),h+=b}while(i.hasClass("failed-image"));return c},onNext:function(){return this.option.getNext.call(this,1)||null},onPrev:function(){return this.option.getNext.call(this,-1)||null},hasNext:function(){return!!this.option.getNext.call(this,1)},hasPrev:function(){return!!this.option.getNext.call(this,-1)}}),function(b,i,j,k){if(!b)return"<span>暂无图片</span>";var l=a("<div class='grid-small-image' style='overflow:hidden;' />"),m=a("<img style='cursor:crosshair;' />");return l.css({width:c+"px",height:d+"px"}),l.append(m),m.setImage(e+b,c,d,g).then(function(a){m.addImageZoomer(h)},function(a){m.attr("alt","请求图片失败"),f&&(m.prop("src",f),m.addClass("default-image")),l.addClass("failed-image")}),l}},hoverView:function(d,e,f){return(!b.core.isNumber(d)||d<=0)&&(d=160),(!b.core.isNumber(e)||e<=0)&&(e=160),b.core.isFunction(f)||(f=c),function(c,g,h){var i,j=g[k];return j||(j=b.ctrls.HoverView({width:d,height:e}),j._contextCtrl=this,j.showing(function(a){var b,c,d;this.empty(),c=parseInt(this.target.attr("data-rowIndex"),10),b=this._contextCtrl.getRowData(c),d=f.call(this._contextCtrl,b),d&&this.append(d)}),g[k]=j),i=a("<a href='javascript:void(0)' class='grid-hover-target' />"),i.text(c+" "),i.addHoverView(j),i.attr("data-rowIndex",h),i}},switchButton:function(d,e){return b.core.isFunction(d)||(d=c),b.core.isString(e)||(e=null),function(c,f,g){var h,i;return h=a("<input type='checkbox' />"),h.prop("checked",!!c),i=h.switchButton({thumbColor:"Light"===b.theme.currentTheme?"#666666":"#888888",style:e}),i.changed(d),h.data("switchButton",i),i.switchBox}}},b.ColumnStyle={cnfn:g,cfn:h,cfnp:i}}(jQuery,ui),function(a,b){"use strict";function c(a){return this instanceof c?void this.initialize(a):new c(a)}var d="page";c.prototype={constructor:c,initialize:function(b){b||(b={}),this.pageNumPanel=null,this.pageInfoPanel=null,this.pageButtonCount=5,this.pageIndex=1,this.pageSize=100,this.data=[],this.pageInfoFormatter=b.pageInfoFormatter,a.isNumeric(b.pageIndex)&&b.pageIndex>0&&(this.pageIndex=b.pageIndex),(a.isNumeric(b.pageSize)||b.pageSize>0)&&(this.pageSize=b.pageSize),(a.isNumeric(b.pageButtonCount)||b.pageButtonCount>0)&&(this.pageButtonCount=b.pageButtonCount),this._ex=Math.floor((this.pageButtonCount-1)/2)},renderPageList:function(b){var c=this._createPageInfo();(!a.isNumeric(b)||b<1)&&(b=this.data?this.data.length||0:0),c.pageIndex=this.pageIndex,c.pageSize=this.pageSize,c.rowCount=b,c.pageCount=Math.floor((b+this.pageSize-1)/this.pageSize),this.pageInfoPanel&&(this.pageInfoPanel.html(""),this._showRowCount(c)),this._renderPageButton(c.pageCount),c.pageCount&&this._checkAndSetDefaultPageIndexHash(this.pageIndex)},_showRowCount:function(b){var c=this.data?this.data.length:0;if(1==b.pageCount?b.currentRowNum=b.rowCount<b.pageSize?b.rowCount:b.pageSize:b.currentRowNum=c<b.pageSize?c:b.pageSize,this.pageInfoFormatter)for(var d in this.pageInfoFormatter)this.pageInfoFormatter.hasOwnProperty(d)&&a.isFunction(this.pageInfoFormatter[d])&&this.pageInfoPanel.append(this.pageInfoFormatter[d].call(this,b[d]))},_createPageInfo:function(){return{rowCount:-1,pageCount:-1,pageIndex:-1,pageSize:-1,currentRowNum:-1}},_renderPageButton:function(a){if(this.pageNumPanel){this.pageNumPanel.empty();var b=this.pageIndex-this._ex;b=b<1?1:b;var c=b+this.pageButtonCount-1;c=c>a?a:c,c-b+1<this.pageButtonCount&&(b=c-(this.pageButtonCount-1)>0?c-(this.pageButtonCount-1):1),b>1&&this.pageNumPanel.append(this._createPageButton("1..."));for(var d,e=b;e<=c;e++)d=e==this.pageIndex?this._createCurrentPage(e):this._createPageButton(e),this.pageNumPanel.append(d);c<a&&this.pageNumPanel.append(this._createPageButton("..."+a))}},_createPageButton:function(a){return"<a class='pager-button font-highlight-hover'>"+a+"</a>"},_createCurrentPage:function(a){return"<span class='pager-current font-highlight'>"+a+"</span>"},pageChanged:function(c,d){var e;this.pageNumPanel&&a.isFunction(c)&&(d=d||b,this.pageChangedHandler=function(){c.call(d,this.pageIndex,this.pageSize)},e=this,(!b.core.ie||b.core.ie>=8)&&b.page.hashchange(function(a,b){return e._breakHashChanged?void(e._breakHashChanged=!1):void(e._isPageHashChange(b)&&(e.pageIndex=e._getPageIndexByHash(b),e.pageChangedHandler()))}),this.pageNumPanel.click(function(c){var d=a(c.target);if("A"===d.nodeName()){var f=d.text();f=f.replace("...",""),f=parseInt(f,10),e.pageIndex=f,(!b.core.ie||b.core.ie>=8)&&e._setPageHash(e.pageIndex),e.pageChangedHandler()}}))},empty:function(){this.pageNumPanel&&this.pageNumPanel.html(""),this.pageInfoPanel&&this.pageInfoPanel.html(""),this.data=[],this.pageIndex=1},_setPageHash:function(a){a&&(this._breakHashChanged=!0,window.location.hash=d+"="+a)},_isPageHashChange:function(a){var b=0;return!!a&&("#"===a.charAt(0)&&(b=1),a.indexOf(d)==b)},_getPageIndexByHash:function(a){var b,c;return a&&(c=a.indexOf("="),c>=0)?(b=a.substring(c+1,a.length),parseInt(b,10)):1},_checkAndSetDefaultPageIndexHash:function(a){var b=window.location.hash,c=b.length;"#"===b.charAt(0)&&c--,c<=0&&this._setPageHash(a)}},b.ctrls.Pager=c}(jQuery,ui),function(a,b){"use strict";var c,d,e=640,f=480;c={up:function(){var a,b,c,d;d=this,b=document.documentElement.clientHeight,a=document.documentElement.clientWidth,c=this.animator[0],c.begin=b,c.end=(b-this.offsetHeight)/2,c.onChange=function(a){d.box.css("top",a+"px")},this.openMask(),this.animator.onEnd=function(){d.onShowed()},this.box.css({top:c.begin+"px",left:(a-this.offsetWidth)/2+"px",display:"block"})},down:function(){var a,b,c,d;d=this,b=document.documentElement.clientHeight,a=document.documentElement.clientWidth,c=this.animator[0],c.begin=-this.offsetHeight,c.end=(b-this.offsetHeight)/2,c.onChange=function(a){d.box.css("top",a+"px")},this.openMask(),this.animator.onEnd=function(){d.onShowed()},this.box.css({top:c.begin+"px",left:(a-this.offsetWidth)/2+"px",display:"block"})},left:function(){var a,b,c,d;d=this,b=document.documentElement.clientHeight,a=document.documentElement.clientWidth,c=this.animator[0],c.begin=-this.offsetWidth,c.end=(a-this.offsetWidth)/2,c.onChange=function(a){d.box.css("left",a+"px")},this.openMask(),this.animator.onEnd=function(){d.onShowed()},this.box.css({top:(b-this.offsetHeight)/2+"px",left:c.begin+"px",display:"block"})},right:function(){var a,b,c,d;d=this,b=document.documentElement.clientHeight,a=document.documentElement.clientWidth,c=this.animator[0],c.begin=a,c.end=(a-this.offsetWidth)/2,c.onChange=function(a){d.box.css("left",a+"px")},this.openMask(),this.animator.onEnd=function(){d.onShowed()},this.box.css({top:(b-this.offsetHeight)/2+"px",left:c.begin+"px",display:"block"})},fadein:function(){var a,b,c,d;d=this,b=document.documentElement.clientHeight,a=document.documentElement.clientWidth,c=this.animator[0],c.begin=0,c.end=100,c.onChange=function(a){d.box.css("opacity",a/100)},this.openMask(),this.animator.onEnd=function(){d.onShowed()},this.box.css({top:(b-this.offsetHeight)/2+"px",left:(a-this.offsetWidth)/2+"px",opacity:0,display:"block"})}},d={up:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("top")),a.end=-this.offsetHeight,a.onChange=function(a){b.box.css("top",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHided()}},down:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("top"),10),a.end=document.documentElement.clientHeight,a.onChange=function(a){b.box.css("top",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHided()}},left:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("left"),10),a.end=-this.offsetWidth,a.onChange=function(a){b.box.css("left",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHided()}},right:function(){var a,b;b=this,a=this.animator[0],a.begin=parseFloat(this.box.css("left"),10),a.end=document.documentElement.clientWidth,a.onChange=function(a){b.box.css("left",a+"px")},this.closeMask(),this.animator.onEnd=function(){b.onHided()}},fadeout:function(){var a,b;b=this,a=this.animator[0],a.begin=100,a.end=0,a.onChange=function(a){b.box.css("opacity",a/100)},this.closeMask(),this.animator.onEnd=function(){b.onHided()},this.box.css({opacity:1,display:"block"})}},b.define("ui.ctrls.DialogBox",{_defineOption:function(){return{title:"",titleHeight:48,show:"up",hide:"down",done:"up",src:null,hasIframe:!1,width:e,height:f,maskable:!0,buttons:[],operatePanelHeight:48,suitable:!0,resizeable:!1,draggable:!0,style:null,closeButtonStyle:"closable-button font-highlight-hover"}},_defineEvents:function(){return["showing","showed","closing","closed","resize"]},_create:function(){var a;this.box=null,this.mask=null,this.buttons=[],this.animator=b.animator(),this.animator.duration=500,b.core.isNumber(this.option.width)||(this.option.width=e),b.core.isNumber(this.option.height)||(this.option.height=f),this.offsetWidth=this.width=this.option.width,this.offsetHeight=this.height=this.option.height,this.contentWidth=this.width,this.contentHeight=0,a=this,b.core.each("show,hide,done",function(b){a[b+"Async"]=function(a){this._asyncCall(b,a)}})},_render:function(){var c;this.box=a("<div class='ui-dialog-box border-highlight' />"),this.titlePanel=a("<section class='ui-dialog-box-title' />"),this.contentPanel=a("<section class='ui-dialog-box-content' />"),this.operatePanel=null,this.box.append(this.titlePanel).append(this.contentPanel),this._initTitle(),this._initContent(),this._initOperateButtons(),this._initClosableButton(),this.animator.addTarget({target:this.box,ease:b.AnimationStyle.easeFromTo}),c=a(document.body),this.maskable()&&(this.mask=a("<div class='ui-dialog-box-mask' />"),c.append(this.mask),this.animator.addTarget({target:this.mask,ease:b.AnimationStyle.easeFrom})),c.append(this.box),this.draggable()&&this._initDraggable(),this.resizeable()&&this._initResizeable(),this._initSuitable(),b.core.isPlainObject(this.option.style)&&this.box.css(this.option.style),this.contentPanel.css({height:this.contentHeight+"px",top:(parseInt(this.option.titleHeight,10)||48)+"px"})},_initTitle:function(){var a=this.option.title;b.core.isPlainObject(a)?this.setTitle(a.text,a.hasHr,a.style):a&&this.setTitle(a)},_initClosableButton:function(){var b,c;b=a("<a href='javascript:void(0)'>×</a>"),b.attr("class",this.option.closeButtonStyle||"closable-button"),c=this,b.click(function(){c.hide()}),this.box.append(b)},_initContent:function(){this.option.src&&(this.option.hasIframe=!0,this.element=a("<iframe class='content-frame' frameborder='0' scrolling='auto' />"),this.element.prop("src",this.option.src)),this.contentPanel.append(this.element)},_initOperateButtons:function(){var a,c;for(Array.isArray(this.option.buttons)||(b.core.isString(this.option.buttons)?this.option.buttons=[this.option.buttons]:this.option.buttons=[]),a=0,c=this.option.buttons.length;a<c;a++)this.addButton(this.option.buttons[a])},_initDraggable:function(){var b={target:this.box,parent:a(document.body),hasIframe:this.hasIframe()};this.titlePanel.addClass("draggable-handle").draggable(b)},_initResizeable:function(){var c;this.resizeHandle=a("<u class='resize-handle' />"),this.box.append(this.resizeHandle),c={context:this,target:this.box,handle:this.resizeHandle,parent:a(document.body),hasIframe:this.hasIframe(),minWidth:320,minHeight:240,onMoving:function(a){var b,d,e,f=this.option;b=f.context,d=b.offsetWidth+a.x,e=b.offsetHeight+a.y,d<c.minWidth&&(d=c.minWidth),e<c.minHeight&&(e=c.minHeight),b._setSize(d,e)}},this.resizer=b.MouseDragger(c),this.resizer.on()},_initSuitable:function(){var a,c=this;this.suitable()?(a=function(a,b,d){c._calculateSize(b,d)},a(),b.page.resize(a,b.eventPriority.ctrlResize)):this._setSize(this.width,this.height,!1)},_calculateSize:function(a,c){var d,e;b.core.isNumber(a)||(a=document.documentElement.clientWidth),b.core.isNumber(c)||(c=document.documentElement.clientHeight),d=this.option.width,e=.85*c,this.height>e&&(e=this.height>c?c:this.height),d>a&&(d=a),this.setSize(d,e,a,c)},_setSize:function(a,c,d){var e=parseInt(this.box.css("border-top-width"),10)||0,f=parseInt(this.box.css("border-bottom-width"),10)||0,g=parseInt(this.box.css("border-left-width"),10)||0,h=parseInt(this.box.css("border-right-width"),10)||0;b.core.isNumber(a)&&a>0&&(this.offsetWidth=a,this.width=this.offsetWidth-g-h,this.box.css("width",this.width+"px")),b.core.isNumber(c)&&c>0&&(this.offsetHeight=c,this.height=this.offsetHeight-e-f,this.box.css("height",this.height+"px"),this._updateContentPanelHeight()),d!==!1&&this.fire("resize")},_updateContentPanelHeight:function(){this.contentHeight=this.height-this.option.titleHeight-(this.operatePanel?this.option.operatePanelHeight:0),this.contentPanel.css("height",this.contentHeight+"px")},_asyncCall:function(a,c){var d=null;b.core.isFunction(this[a])&&(d=this[a].call(this),d&&b.core.isFunction(c)&&d.done(c))},maskable:function(){return!!this.option.maskable},suitable:function(){return!!this.option.suitable},resizeable:function(){return!!this.option.resizeable},draggable:function(){return!!this.option.draggable},hasIframe:function(){return!!this.option.hasIframe},setTitle:function(c,d,e){var f,g,h,i;if(b.core.isString(c)?(f=a("<span class='title-text font-highlight' />").text(c),d!==!1&&(d=!0)):b.core.isDomObject(c)?f=a(c):b.core.isJQueryObject(c)&&(f=c),this.titlePanel.empty(),g=a("<div class='title-inner-panel' />"),g.append(f),d&&g.append("<hr class='ui-dialog-box-spline background-highlight' />"),this.titlePanel.append(g),Array.isArray(e))for(h=0,i=e.length;h<i;h++)this.titlePanel.addClass(e[h]);else b.core.isPlainObject(e)&&this.titlePanel.css(e)},addButton:function(c){if(c=b.getJQueryElement(c))return this.operatePanel||(this.operatePanel=a("<section class='ui-dialog-box-operate' />"),this.box.append(this.operatePanel),this._updateContentPanelHeight(),this.fire("resize")),this.operatePanel.append(c),this},isShow:function(){return"block"===this.box.css("display")},show:function(a){if(!this.animator.isStarted&&!this.isShow()&&this.fire("showing")!==!1&&(b.core.isFunction(a)||(a=c[this.option.show],b.core.isFunction(a))))return a.call(this),this.animator.start()},hide:function(a){if(!this.animator.isStarted&&this.isShow()&&this.fire("hiding")!==!1&&(b.core.isFunction(a)||(a=d[this.option.hide],b.core.isFunction(a))))return a.call(this),this.animator.start()},done:function(a){if(b.core.isFunction(a)||(a=d[this.option.done],b.core.isFunction(a)))return this.hide(a)},onShowed:function(){this.fire("showed")},onHided:function(){this.box.css("display","none"),this.maskable()&&(a(document.body).css("overflow",this._oldBodyOverflow),this.mask.css("display","none"))},openMask:function(){var b,c=a(document.body);this.maskable()&&(this._oldBodyOverflow=c.css("overflow"),c.css("overflow","hide"),this.mask.css({display:"block",opacity:0,height:document.documentElement.clientHeight+"px"}),b=this.animator[1],b.begin=0,b.end=70,b.onChange=function(a){this.target.css("opacity",a/100)})},closeMask:function(){var a;this.maskable()&&(a=this.animator[1],a.begin=70,a.end=0,a.onChange=function(a){this.target.css("opacity",a/100)})},setSize:function(a,c,d,e){b.core.isNumber(d)||(d=document.documentElement.clientWidth),b.core.isNumber(e)||(e=document.documentElement.clientHeight),this._setSize(a,c),this.box.css({top:(e-this.offsetHeight)/2+"px",left:(d-this.offsetWidth)/2+"px"}),this.maskable()&&this.mask.css("height",e+"px")}}),a.fn.dialogBox=function(a){return 0===this.length?null:b.ctrls.DialogBox(a,this)},b.ctrls.DialogBox.setShowStyle=function(a,d){b.core.isString(a)&&a.length>0&&b.core.isFunction(d)&&(c[a]=d)},b.ctrls.DialogBox.setHideStyle=function(a,c){b.core.isString(a)&&a.length>0&&b.core.isFunction(c)&&(d[a]=c)}}(jQuery,ui),function(a,b){"use strict";function c(a){return this instanceof c?void this.initialize(a):new c(a)}var d,e="c_dotsPlaying";c.prototype={constructor:c,initialize:function(a){a||(a={}),this.delay=a.delay,("number"!==b.core.type(this.delay)||this.delay<0)&&(this.delay=1e3),this.timeoutHandle=null,this.isOpening=!1,this.box=null,this.openCount=0},getBox:function(){return this.box||(this.box=a("#loadingElement")),this.box},isShow:function(){return"block"===this.getBox().css("display")},show:function(){var a;return this.isOpening||this.isShow()?void this.openCount++:(this.isOpening=!0,a=this,void(this.timeoutHandle=setTimeout(function(){a.timeoutHandle=null,a._doShow()},this.delay)))},_doShow:function(){this.getBox(),this.box.addClass(e).css("display","block")},hide:function(){return this.openCount>0?void this.openCount--:(this.isOpening=!1,this.timeoutHandle?void clearTimeout(this.timeoutHandle):(this.getBox(),void this.box.removeClass(e).css("display","none")))}},d=c(),b.loadingShow=function(){d.show()},b.loadingHide=function(){d.hide()}}(jQuery,ui),function(a,b){"use strict";function c(){return this instanceof c?void this.initialize():new c}function d(a,b){b||(b=f.message),e.show(a,b)}var e,f={message:0,warn:1,error:3,success:4,failed:5},g=5;c.prototype={constructor:c,initialize:function(){this.box=null,this.type=f,this.isStartHide=!1,this.boxAnimator=null,this.width=322,this.top=88},_initAnimator:function(){this.boxAnimator=b.animator({target:this.box,ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}),this.boxAnimator.duration=200},getIcon:function(a){return a===f.warn?"mb-warn fa fa-exclamation-triangle":a===f.error?"mb-error fa fa-times-circle":a===f.success?"mb-success fa fa-check-circle-o":a===f.failed?"mb-failed fa fa-times-circle-o":"mb-message fa fa-commenting"},getBox:function(){var b,c;if(!this.box){b=document.documentElement.clientWidth,c=document.documentElement.clientHeight,this.box=a("<div class='ui-message-box border-highlight' />"),this.box.css({top:this.top+"px",left:b+"px","max-height":c-2*this.top+"px"});var d=a("<a href='javascript:void(0)' class='closable-button'>×</a>"),e=this;d.click(function(a){e.hide(!0)}),this.box.mouseenter(function(a){e.isClosing||(e.isStartHide?e._show():clearTimeout(e.hideHandler))}),this.box.mouseleave(function(a){e.waitSeconds(g)}),this.box.append(d),a(document.body).append(this.box),this._initAnimator()}return this.box},isShow:function(){return"block"===this.getBox().css("display")},show:function(c,d){var f,h,i=[];return h=a("<div class='message-item' />"),i.push("<i class='message-icon ",this.getIcon(d),"'></i>"),i.push("<div class='message-content'>"),b.core.isFunction(c)?i.push(c()):i.push(b.str.htmlEncode(c+"")),i.push("</div>"),h.html(i.join("")),f=this.getBox(),this.isShow()?void f.append(h):(f.children(".message-item").remove(),f.append(h),void this._show(function(){e.waitSeconds(g)}))},_show:function(a){var b,c=(this.getBox(),document.documentElement.clientWidth);this.isStartHide=!1,this.boxAnimator.stop(),b=this.boxAnimator[0],b.begin=parseFloat(b.target.css("left"))||c,b.end=c-this.width,b.target.css("display","block"),this.boxAnimator.start().done(a)},hide:function(a){var b,c,d=this,e=document.documentElement.clientWidth;a&&(this.isClosing=!0),b=this.getBox(),this.isStartHide=!0,this.boxAnimator.stop(),c=this.boxAnimator[0],c.begin=parseFloat(c.target.css("left"))||e-this.width,c.end=e,this.boxAnimator.start().done(function(){b.css("display","none"),d.isClosing=!1,d.isStartHide=!1})},waitSeconds:function(a){var b=this;b.hideHandler&&window.clearTimeout(b.hideHandler),isNaN(parseInt(a))&&(a=g),b.hideHandler=window.setTimeout(function(){b.hideHandler=null,b.isStartHide===!1&&b.hide()},1e3*a)}},e=c(),b.page.resize(function(a){var b,c=e.getBox(),d=document.documentElement.clientWidth,f=document.documentElement.clientHeight;b=e.isShow()?d-e.width:d,e.waitSeconds(g),c.css({left:b+"px","max-height":f-2*e.top+"px"})}),b.messageShow=function(a){d(a,f.message)},b.warnShow=function(a){d(a,f.warn)},b.errorShow=function(a){d(a,f.error)},b.successShow=function(a){d(a,f.success)},b.failedShow=function(a){d(a,f.failed)}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.OptionBox",b.ctrls.SidebarBase,{_defineOption:function(){return a.extend(this._super(),{title:"",buttons:null})},_create:function(){this._super(),this.contentPanel=null,this.contentHeight=0,this.contentTop=40,this.buttonTop=0,this.operatePanelHeight=0,this.buttons=[],this.opacityOption={target:this.panel,ease:b.AnimationStyle.easeFromTo,onChange:function(a,b){b.css("opacity",a/100)}}},_render:function(){this._super(),this._panel.addClass("ui-option-box-panel"),this.titlePanel=a("<section class='ui-option-box-title' />"),this.contentPanel=a("<section class='ui-option-box-content' />"),this.contentPanel.append(this.element),this.contentHeight=this.element.height(),this._panel.append(this.titlePanel).append(this.contentPanel),this._initOperateButtons(),this.setTitle(this.option.title)},_initOperateButtons:function(){var a,c;for(Array.isArray(this.option.buttons)||(b.core.isString(this.option.buttons)?this.option.buttons=[this.option.buttons]:this.option.buttons=[]),a=0,c=this.option.buttons.length;a<c;a++)this.addButton(this.option.buttons[a])},addButton:function(c){var d;if(c=b.getJQueryElement(c))return this.buttons.push(c),this.operatePanel?d=this.operatePanel.children(".ui-form"):(this.operatePanel=a("<section class='ui-option-box-buttons' />"),d=a("<div class='ui-form' />"),this.operatePanel.append(d),this._panel.append(this.operatePanel),this.buttonTop=24,this.operatePanelHeight=24),d.append(c),this},setTitle:function(a){this.titlePanel.empty(),a&&(b.core.isString(a)&&(a="<span class='option-box-title-text font-highlight'>"+a+"<span>"),this.titlePanel.append(a))},setWidth:function(a){var c;this._super(a),c=this.height-this.contentTop-this.buttonTop-this.operatePanelHeight-this.buttonTop,this.contentPanel.css({"max-height":c+"px"}),this.operatePanel&&(c<this.contentHeight?this.operatePanel.css("width",this.width-b.scrollbarWidth+"px"):this.operatePanel.css("width","100%"))},show:function(){this.showTimeValue=240,this.opacityOption.begin=0,this.opacityOption.end=100,this._super(this.opacityOption)},hide:function(){this.hideTimeValue=240,this.opacityOption.begin=100,this.opacityOption.end=0,this._super(this.opacityOption)}})}(jQuery,ui),function(a,b){"use strict";
function c(a){return a<10?"0"+a:""+a}function d(a){return a+""}function e(a,b,c){var d,e,f;for(f=[],f.push(null),d=3;d<arguments.length;d++)f.push(arguments[d]);for(e=[],d=a;d<=b;d++)f[0]=d,e.push(c.apply(this,f));return e}function f(a,b,d){var f,g;return f=[],a&&(g={title:"时"},g.list=e.call(this,0,23,c),f.push(g)),b&&(g={title:"分"},g.list=e.call(this,0,59,c),f.push(g)),d&&(g={title:"秒"},g.list=e.call(this,0,59,c),f.push(g)),f}function g(a){return Math.pow(a,.25)}function h(a){var b,c,d,e;return a.beginAnimation?(a.duration=200,void(a.startTime=(new Date).getTime())):(a.startTime=(new Date).getTime(),a.duration=160,a.beginAnimation=!0,b=this,c=60,d=g,e=function(){var c=(new Date).getTime(),e=c-a.startTime,f=d(e/a.duration),g=a.scrollEnd-a.scrollBegin,h=Math.ceil(a.scrollBegin+f*g);a.target.scrollTop(h),a.duration<=e&&(a.target.scrollTop(a.scrollEnd),i.call(b,a),b._selectItem(a))},this._deselectItem(a),e(),void(a.stopScrollHandler=setInterval(e,1e3/c)))}function i(a){clearInterval(a.stopScrollHandler),a.beginAnimation=!1}function j(a,b){b<0&&(b=0),a.scrollTop(b*(this.option.itemSize+this.option.margin))}function k(a){b.hideAll(this),this.show(),this._updateSelectionState()}function l(b){var c,d,e,f;for(b.stopPropagation(),c=a(b.target);"LI"!==(d=c.nodeName());)if(c.hasClass("ui-chooser-list"))return;c.hasClass("ui-chooser-empty-item")||c.hasClass(o)||(e=parseInt(c.attr("data-index"),10),f=this.scrollData[parseInt(c.parent().parent().attr("data-index"),10)],this._chooseItem(f,e))}function m(a){var b,c,d,e,f,g;return a.stopPropagation(),b=a.data.target,c=parseInt(b.attr("data-index"),10),d=this.scrollData[c],e=this.option.itemSize+this.option.margin,f=-a.delta*e,g=-a.delta>0,null===d.lastDirection&&(d.lastDirection=g),d.lastDirection!==g&&(d.lastDirection=g,i.call(this,d)),d.beginAnimation?(d.scrollBegin=b.scrollTop(),d.scrollEnd=parseInt((d.scrollEnd+f)/e,10)*e):(d.scrollBegin=b.scrollTop(),d.scrollEnd=parseInt((d.scrollBegin+f)/e,10)*e),h.call(this,d),!1}var n,o="ui-chooser-selection-item",p={S:3,M:5,L:9},q=0,r=32,s="M",t=120;n={hourMinute:function(){var a;return a=f(!0,!0,!1),this.option.spliter=":",this.defaultSelectValue=function(){var a=new Date;return[c(a.getHours()),c(a.getMinutes())]},a},time:function(){var a;return a=f(!0,!0,!0),this.option.spliter=":",this.defaultSelectValue=function(){var a=new Date;return[c(a.getHours()),c(a.getMinutes()),c(a.getSeconds())]},a},yearMonth:function(){var a,b,f,g;return a=[],b=(new Date).getFullYear()-49,f=b+99,g={title:"年"},g.list=e.call(this,b,f,d),a.push(g),b=1,f=12,g={title:"月"},g.list=e.call(this,b,f,c),a.push(g),this.option.spliter="-",this.defaultSelectValue=function(){var a=new Date;return[c(a.getFullYear()),c(a.getMonth()+1)]},a}},b.define("ui.ctrls.Chooser",b.ctrls.DropDownBase,{_defineOption:function(){return{type:!1,title:null,viewData:null,spliter:".",margin:q,size:s,itemSize:r}},_defineEvents:function(){return["selecting","selected"]},_create:function(){this._super(),p.hasOwnProperty(this.option.size)?this.size=p[this.option.size]:this.size=p[s],(!b.core.isNumber(this.option.margin)||this.option.margin<0)&&(this.option.margin=q),(!b.core.isNumber(this.option.itemSize)||this.option.itemSize<=0)&&(this.option.itemSize=r),this.width=this.element.width(),this.width<this.itemSize+2*this.margin&&(this.width=t),this.onFocusHandler=k.bind(this),this.onItemClickHandler=l.bind(this),this.onMousewheelHandler=m.bind(this)},_render:function(){this.chooserPanel=a("<div class='ui-chooser-panel border-highlight' />"),this.chooserPanel.css("width",this.width+"px"),this._itemTitlePanel=a("<div class='ui-chooser-title-panel' />"),this._itemListPanel=a("<div class='ui-chooser-list-panel' />"),this._itemListPanel.append(this._createFocusElement()),this._createItemList(this._itemTitlePanel,this._itemListPanel),this.chooserPanel.append(this._itemTitlePanel).append(this._itemListPanel),this._selectTextClass="select-text",this._showClass="ui-chooser-show",this._clearClass="ui-chooser-clear",this._clear=function(){this.element.val("")},this.wrapElement(this.element,this.chooserPanel),this._super(),this.element.off("focus").on("focus",this.onFocusHandler),this.chooserPanel.click(function(a){a.stopPropagation()})},_createFocusElement:function(){var b=a("<div class='focus-choose-element' />");return b.addClass("border-highlight"),b.css("top",this.option.itemSize*((this.size-1)/2)),b},_createItemList:function(a,b){var c=this._fillList(a,b);this.chooserPanel.css("width",c.width+"px"),b.css("height",c.height+"px")},_fillList:function(c,d){var e,f,g,h,i,j,k,l,m,o,p;if(e={width:0,height:this.size*(this.option.itemSize+this.option.margin)+this.option.margin},this.scrollData=null,b.core.isString(this.option.type)?n.hasOwnProperty(this.option.type)&&(this.scrollData=n[this.option.type].call(this)):b.core.isFunction(this.option.type)&&(this.scrollData=this.option.type.call(this)),this.scrollData||(this.scrollData=this.option.viewData),!Array.isArray(this.scrollData)||0===this.scrollData.length)return e;for(k=this.scrollData.length,o=Math.floor(this.width/k),surWidth=this.width-o*k,m=!1,j=0;j<k;j++)if(this.scrollData[j].title){m=!0;break}for(m||c.append("<span class='font-highlight'>"+this.option.title+"</span>"),j=0;j<k;j++)i=this.scrollData[j],surWidth>0?(p=1,surWidth--):p=0,g={left:e.width+"px",width:o+p+"px"},m&&(f=a("<div class='ui-chooser-title-item font-highlight' />"),f.css(g),f.text(i.title||""),c.append(f)),f=a("<div class='ui-chooser-list' />"),f.css(g),f.attr("data-index",j),l=this.scrollData[j],l.target=f,l.lastDirection=null,e.width+=o+p+this.option.margin,f.mousewheel({target:f},this.onMousewheelHandler),f.click(this.onItemClickHandler),h=this._createList(i),f.append(h),d.append(f);return e},_createList:function(b){var c,d,e,f,g,h,i;for(i=this._getAttachmentCount(),c=b.list,d=[],e=[],h=0;h<i;h++)d.push(null),e.push(null);for(c=d.concat(c,e),f=a("<ul class='ui-chooser-list-ul' />"),h=0,i=c.length;h<i;h++)g=this._createItem(c[h]),g.attr("data-index",h),f.append(g);return g.css("margin-bottom",this.option.margin+"px"),f},_createItem:function(b){var c,d;return c=a("<li class='ui-chooser-list-li' />"),d={width:this.option.itemSize+"px",height:this.option.itemSize+"px"},c.addClass("ui-chooser-item"),b?c.text(b):c.addClass("ui-chooser-empty-item"),c},_getAttachmentCount:function(){return Math.floor((this.size-1)/2)},_getValues:function(){var a,b,c,d,e,f;for(a=this._getAttachmentCount(),b=[],c=0,d=this.scrollData.length;c<d;c++)e=this.scrollData[c],e._current?(f=parseInt(e._current.attr("data-index"),10),f-=a,b.push(e.list[f])):b.push("");return b},_setValues:function(a){var b,c,d,e,f;if(Array.isArray(a)){for(f=[],b=0;b<a.length;b++)if(e=this.scrollData[b])for(f[b]=0,c=0,d=e.list.length;c<d;c++)if(e.list[c]===a[b]){f[b]=c;break}this._setSelectionState(f)}},_setSelectionState:function(a){var b,c,d,e;if(a.length==this.scrollData.length)for(d=0,e=a.length;d<e;d++)c=a[d],b=this.scrollData[d],this._deselectItem(b),j.call(this,b.target,c),this._selectItem(b)},_updateSelectionState:function(){var a,c,d=this.element.val();if(d.length>0)this._setValues(d.split(this.option.spliter));else if(b.core.isFunction(this.defaultSelectValue))this._setValues(this.defaultSelectValue());else{for(c=[],a=0;a<this.scrollData.length;a++)c.push(0);this._setSelectionState(c)}},_chooseItem:function(a,b){a.beginAnimation&&i.call(this,a),b-=this._getAttachmentCount(),a.scrollBegin=a.target.scrollTop(),a.scrollEnd=b*(this.option.itemSize+this.option.margin),h.call(this,a)},_selectItem:function(b){var c,d,e,f,g,h;for(f=0,g=this.scrollData.length;f<g;f++)if(this.scrollData[f].beginAnimation)return;c=b.target.find("ul"),d=b.target.scrollTop(),e=parseInt(d/(this.option.itemSize+this.option.margin),10),b._current=a(c.children()[e+this._getAttachmentCount()]),b._current.addClass(o).addClass("font-highlight"),h={},h.values=this._getValues(),h.text=h.values.join(this.option.spliter),this.fire("selecting",h)!==!1&&(this.element.val(h.text),this.fire("selected",h))},_deselectItem:function(a){a._current&&a._current.removeClass(o).removeClass("font-highlight")}}),b.ctrls.Chooser.extendType=function(a,c){b.core.isFunction(c)&&b.core.isString(a)&&!n.hasOwnProperty(a)&&(n[a]=c)},a.fn.chooser=function(a){return 0===this.length?null:b.ctrls.Chooser(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(c,d){var e=this;e.eventDispatcher=new b.CustomEvent(e),e.eventDispatcher.initEvents(["selected"]),a(c).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var f=a(".farbtastic",c);e.wheel=a(".wheel",c).get(0),e.radius=84,e.square=100,e.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&a("*",f).each(function(){if("none"!=this.currentStyle.backgroundImage){var b=this.currentStyle.backgroundImage;b=this.currentStyle.backgroundImage.substring(5,b.length-2),a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+b+"')"})}}),e.linkTo=function(b){return"object"==typeof e.callback&&a(e.callback).unbind("keyup",e.updateValue),e.color=null,"function"==typeof b?e.callback=b:"object"!=typeof b&&"string"!=typeof b||(e.callback=a(b),e.callback.bind("keyup",e.updateValue),e.callback.get(0).value&&e.setColor(e.callback.get(0).value)),this},e.updateValue=function(a){this.value&&this.value!=e.color&&e.setColor(this.value)},e.setColor=function(a){var b=e.unpack(a);return e.color!=a&&b&&(e.color=a,e.rgb=b,e.hsl=e.RGBToHSL(e.rgb),e.updateDisplay()),this},e.setHSL=function(a){return e.hsl=a,e.rgb=e.HSLToRGB(a),e.color=e.pack(e.rgb),e.updateDisplay(),this},e.widgetCoords=function(b){var c,d,f,g,h=b.target||b.srcElement,i=e.wheel;if("undefined"!=typeof b.offsetX){f={x:b.offsetX,y:b.offsetY};for(var j=h;j;)j.mouseX=f.x,j.mouseY=f.y,f.x+=j.offsetLeft,f.y+=j.offsetTop,j=j.offsetParent;for(j=i,g={x:0,y:0};j;){if("undefined"!=typeof j.mouseX){c=j.mouseX-g.x,d=j.mouseY-g.y;break}g.x+=j.offsetLeft,g.y+=j.offsetTop,j=j.offsetParent}for(j=h;j;)j.mouseX=void 0,j.mouseY=void 0,j=j.offsetParent}else f=e.absolutePosition(i),c=(b.pageX||0*(b.clientX+a("html").get(0).scrollLeft))-f.x,d=(b.pageY||0*(b.clientY+a("html").get(0).scrollTop))-f.y;return{x:c-e.width/2,y:d-e.width/2}},e.mousedown=function(b){document.dragging||(a(document).bind("mousemove",e.mousemove).bind("mouseup",e.mouseup),document.dragging=!0);var c=e.widgetCoords(b);return e.circleDrag=2*Math.max(Math.abs(c.x),Math.abs(c.y))>e.square,e.mousemove(b),!1},e.mousemove=function(a){var b=e.widgetCoords(a);if(e.circleDrag){var c=Math.atan2(b.x,-b.y)/6.28;c<0&&(c+=1),e.setHSL([c,e.hsl[1],e.hsl[2]])}else{var d=Math.max(0,Math.min(1,-(b.x/e.square)+.5)),f=Math.max(0,Math.min(1,-(b.y/e.square)+.5));e.setHSL([e.hsl[0],d,f])}return!1},e.mouseup=function(){a(document).unbind("mousemove",e.mousemove),a(document).unbind("mouseup",e.mouseup),document.dragging=!1},e.updateDisplay=function(){var b=6.28*e.hsl[0];a(".h-marker",f).css({left:Math.round(Math.sin(b)*e.radius+e.width/2)+"px",top:Math.round(-Math.cos(b)*e.radius+e.width/2)+"px"}),a(".sl-marker",f).css({left:Math.round(e.square*(.5-e.hsl[1])+e.width/2)+"px",top:Math.round(e.square*(.5-e.hsl[2])+e.width/2)+"px"}),a(".color",f).css("backgroundColor",e.pack(e.HSLToRGB([e.hsl[0],1,.5]))),"object"==typeof e.callback?(a(e.callback).css({backgroundColor:e.color,color:e.hsl[2]>.5?"#000":"#fff"}),a(e.callback).each(function(){this.value&&this.value!=e.color&&(this.value=e.color)})):"function"==typeof e.callback&&e.callback.call(e,e.color),this.fire("selected",e.color)},e.absolutePosition=function(a){var b={x:a.offsetLeft,y:a.offsetTop};if(a.offsetParent){var c=e.absolutePosition(a.offsetParent);b.x+=c.x,b.y+=c.y}return b},e.pack=function(a){var b=Math.round(255*a[0]),c=Math.round(255*a[1]),d=Math.round(255*a[2]);return"#"+(b<16?"0":"")+b.toString(16)+(c<16?"0":"")+c.toString(16)+(d<16?"0":"")+d.toString(16)},e.unpack=function(a){return 7==a.length?[parseInt("0x"+a.substring(1,3))/255,parseInt("0x"+a.substring(3,5))/255,parseInt("0x"+a.substring(5,7))/255]:4==a.length?[parseInt("0x"+a.substring(1,2))/15,parseInt("0x"+a.substring(2,3))/15,parseInt("0x"+a.substring(3,4))/15]:void 0},e.HSLToRGB=function(a){var b,c,d=a[0],e=a[1],f=a[2];return c=f<=.5?f*(e+1):f+e-f*e,b=2*f-c,[this.hueToRGB(b,c,d+.33333),this.hueToRGB(b,c,d),this.hueToRGB(b,c,d-.33333)]},e.hueToRGB=function(a,b,c){return c=c<0?c+1:c>1?c-1:c,6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(.66666-c)*6:a},e.RGBToHSL=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2];return b=Math.min(h,Math.min(i,j)),c=Math.max(h,Math.max(i,j)),d=c-b,g=(b+c)/2,f=0,g>0&&g<1&&(f=d/(g<.5?2*g:2-2*g)),e=0,d>0&&(c==h&&c!=i&&(e+=(i-j)/d),c==i&&c!=j&&(e+=2+(j-h)/d),c==j&&c!=h&&(e+=4+(h-i)/d),e/=6),[e,f,g]},a("*",f).mousedown(e.mousedown),e.setColor("#000000"),d&&e.linkTo(d)}function d(b,d){return b=a(b).get(0),b.farbtastic||(b.farbtastic=new c(b,d))}function e(a,c){a=b.getJQueryElement(a),a&&(c||(c=arguments[2]||a.css("background-color")),c&&"transparent"!==c?(c=b.color.parseRGB(c),c=b.color.rgb2hex(c.red,c.green,c.blue).toLowerCase()):c="#ffffff",a.val(c),this.setColor(c))}a.fn.colorPicker=function(c){var f,g,h;return 0===this.length?null:(f=b.ctrls.DropDownBase(c,this),g=a("<div class='ui-color-picker border-highlight' />"),g.click(function(a){a.stopPropagation()}),f.colorPickerPanel=g,f._showClass="color-picker-show",f.wrapElement(this,g),f._render(),h=f.hide,d(g,this),f.farbtastic=f.colorPickerPanel[0].farbtastic,f.hide=function(){return document.dragging?"retain":void h.call(this)},f.setColorValue=function(){e.apply(this.farbtastic,arguments)},f.setColorValue(this),f)}}(jQuery,ui),function(a,b){"use strict";function c(a,b,d,e){return this instanceof c?void this.initialize(a,b,d,e):new c(a,b,d,e)}function d(a){return a<10?"0"+a:""+a}function e(a,b){return b+=1,a+"-"+d.call(this,b)+"&nbsp;▼"}function f(a,b,c){var e;return e=a.exec(c),null!==e&&e[0].length>1&&(b=d(b)),c.replace(a,b)}function g(a,b,c){var d;return d=a.exec(c),d?parseInt(b.substring(d.index,d.index+d[0].length),10):NaN}function h(a,b){var d,e,f;return d=g.call(this,F,a,b),e=g.call(this,G,a,b),f=g.call(this,H,a,b),isNaN(d)||isNaN(e)||isNaN(f)?null:c(d,e-1,f,this)}function i(a){return a.hasClass("date-chooser-prev-disabled")||a.hasClass("date-chooser-next-disabled")}function j(b){var c,d,e,f=b.data.value;c=a(b.target),i(c)||(d=this._currentYear?parseInt(this._currentYear.attr("data-year"),10):this._selYear,e=this._currentMonth?parseInt(this._currentMonth.attr("data-month"),10):this._selMonth,d+=f,this._fillYear(d,e))}function k(b){var c,d;if(b.stopPropagation(),c=a(b.target),"TD"===c.nodeName()&&!c.hasClass("disabled-year")){if(this._currentYear){if(this._currentYear[0]===c[0])return;this._currentYear.removeClass(B).removeClass("background-highlight")}this._currentYear=c,this._currentYear.addClass(B).addClass("background-highlight"),d=this._currentMonth?parseInt(this._currentMonth.attr("data-month"),10):this._selMonth,this._updateMonthsStatus(d)}}function l(b){var c;if(b.stopPropagation(),c=a(b.target),"TD"===c.nodeName()&&!c.hasClass("disabled-month")){if(this._currentMonth){if(this._currentMonth[0]===c[0])return;this._currentMonth.removeClass(C).removeClass("background-highlight")}this._currentMonth=c,this._currentMonth.addClass(C).addClass("background-highlight")}}function m(a){a.stopPropagation(),this._selYear=parseInt(this._currentYear.attr("data-year"),10),this._selMonth=parseInt(this._currentMonth.attr("data-month"),10),this._updateCalendarTitle(),this._fillMonth(this._currentDays,this._selYear,this._selMonth),this._closeYearMonthPanel()}function n(a){a.stopPropagation(),this._closeYearMonthPanel()}function o(b){var c,d,e=b.data.value;c=a(b.target),i(c)||(d=new Date(this._selYear,this._selMonth+e,1),this._changeMonth(d,e>0))}function p(a){a.stopPropagation(),this._fillYear(this._selYear,this._selMonth),this._openYearMonthPanel()}function q(b){var c,d;if(c=a(b.target),!this._currentDays.parent().hasClass("click-disabled")){for(;"TD"!==(d=c.nodeName());){if(c.hasClass("date-chooser-days-panel"))return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),this._selectItem(c)}}function r(a){var b,c,d=new Date;b=d.getFullYear(),c=d.getMonth(),b===this._selYear&&c===this._selMonth?this.setSelection(d):this._changeMonth(d,12*b+c+1>12*this._selYear+this._selMonth+1,function(){this.setSelection(d)})}function s(b){var c,e,f,g,h,i;c=a(b.target),"INPUT"===c.nodeName()&&(e=c.hasClass("hour")?24:60,f=c.val(),f=parseFloat(f),f+=-b.delta,f<0?f=e-1:f>=e&&(f=0),c.val(d(f)),g=parseInt(this.hourText.val(),10),h=parseInt(this.minuteText.val(),10),i=parseInt(this.secondText.val(),10),this.setSelection(new Date(this._selYear,this._selMonth,this._selDay,g,h,i)))}function t(b){var c,e,f,g,h;if(c=a(b.target),0!==c.val().length)return e=new Date,f=parseInt(this.hourText.val(),10),isNaN(f)||f<0||f>=24?(f=e.getHours(),void this.hourText.val(d(f))):(g=parseInt(this.minuteText.val(),10),isNaN(g)||g<0||g>=60?(g=e.getMinutes(),void this.minuteText.val(d(g))):(h=parseInt(this.secondText.val(),10),isNaN(h)||h<0||h>=60?(h=e.getSeconds(),void this.secondText.val(d(h))):void this.setSelection(new Date(this._selYear,this._selMonth,this._selDay,f,g,h))))}function u(){}function v(a,c){var d=b.ctrls.DateChooser(a,c);return d.selecting(function(a,c){if(b.core.isFunction(this.selectingHandler))return this.selectingHandler.apply(this,arguments)}),d.selected(function(a,c){b.core.isFunction(this.selectedHandler)?this.selectedHandler.apply(this,arguments):"INPUT"===this.element.nodeName()?this.element.val(c.value):this.element.html(c.value)}),d.cancel(function(){b.core.isFunction(this.cancelHandler)?this.cancelHandler.apply(this,arguments):"INPUT"===this.element.nodeName()?this.element.val(""):this.element.html("")}),d}function w(a){var b,c;return this.isShow()?(b=this.element.width(),c=a.offsetX,c||(c=a.clientX-this.element.offset().left),void(b-c<0?(this.element.css("cursor","pointer"),this._clearable=!0):(this.element.css("cursor","auto"),this._clearable=!1))):(this.element.css("cursor","auto"),void(this._clearable=!1))}function x(b){var c,d;this._clearable&&(c=this.element.width(),d=b.offsetX,d||(d=b.clientX-this.element.offset().left),c-d<0&&a.isFunction(this._clear)&&this._clear())}function y(a,b){this.option=b,this.setLayoutPanel(b.layoutPanel),this.element=a,this.selectingHandler=b.selectingHandler,this.selectedHandler=b.selectedHandler,this.clearHandler=b.cancelHandler,"INPUT"===a.nodeName()?(this.onMousemoveHandler=w.bind(this),this.onMouseupHandler=x.bind(this)):(this.onMousemoveHandler=u,this.onMouseupHandler=u)}var z,A="date-selected",B="year-selected",C="month-selected",D="yyyy-MM-dd",E="yyyy-MM-dd hh:mm:ss",F=/y+/i,G=/M+/,H=/d+/i,I=/h+/i,J=/m+/,K=/s+/i;z={},z["zh-CN"]={dateFormat:"yyyy-mm-dd",year:"年份",month:"月份",weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},z["en-US"]={dateFormat:"yyyy-mm-dd",year:"Year",month:"Month",weeks:["S","M","T","W","T","F","S"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},c.prototype={constructor:c,initialize:function(a,b,c,d){this.year=a,this.month=b,this.day=c,this.dateChooser=d,this.today=null,this._isCurrentMonth=!0},isCurrentMonth:function(a){return arguments.length>0?(this._isCurrentMonth=a,this):this._isCurrentMonth},setToday:function(a){this.today=a},isToday:function(){return this.today||(this.today=new Date),this.year===this.today.getFullYear()&&this.month===this.today.getMonth()&&this.day===this.today.getDate()},isTheDay:function(a,b,c){return this.year===a&&this.month===b&&this.day===c},isDisabled:function(){return!!this.dateChooser&&this.dateChooser._isDisabledDay(this.year,this.month,this.day)},lt:function(a,b,c){var d=new Date(this.year,this.month,this.day),e=new Date(a,b,c);return d.getTime()<e.getTime()},gt:function(a,b,c){var d=new Date(this.year,this.month,this.day),e=new Date(a,b,c);return d.getTime()>e.getTime()},toDate:function(){return new Date(this.year,this.month,this.day,0,0,0)}},b.define("ui.ctrls.DateChooser",b.ctrls.DropDownBase,{_defineOption:function(){return{dateFormat:D,language:"zh-CN",calendarPanel:null,isDateTime:!1,startDate:null,endDate:null}},_defineEvents:function(){return["selecting","selected","cancel"]},_create:function(){var a;this._super(),this.isDateTime()?this.option.dateFormat=this.option.dateFormat||E:this.option.dateFormat=this.option.dateFormat||D,this._initDateRange(),a=this.formatDateValue(new Date),this._setCurrentDate(a),this._language=z[this.option.language],this._language||(this._language=z["zh-CN"]),this.onYearChangedHandler=j.bind(this),this.onYearSelectedHandler=k.bind(this),this.onMonthSelectedHandler=l.bind(this),this.onApplyYearMonthHandler=m.bind(this),this.onCancelYearMonthHandler=n.bind(this),this.onMonthChangedHandler=o.bind(this),this.onCalendarTitleClickHandler=p.bind(this),this.onDayItemClickHandler=q.bind(this),this.onTodayButtonClickHandler=r.bind(this),this.isDateTime()&&(this.onTimeMousewheelHandler=s.bind(this),this.onTimeTextinputHandler=t.bind(this))},_initDateRange:function(){this.startDay=null,b.core.isString(this.option.startDate)&&this.option.startDate.length>0&&(this.startDay=h.call(this,this.option.startDate,this.option.dateFormat)),this.endDay=null,b.core.isString(this.option.endDate)&&this.option.endDate.length>0&&(this.endDay=h.call(this,this.option.endDate,this.option.dateFormat))},_render:function(){this._calendarPanel=b.getJQueryElement(this.option.calendarPanel),this._calendarPanel?this._calendarPanel.css("position","relative"):this._calendarPanel=a("<div />"),this._calendarPanel.addClass("ui-date-chooser-panel").addClass("border-highlight").click(function(a){a.stopPropagation()}),this._showClass="ui-date-chooser-show",this._panel=this._calendarPanel,this._selectTextClass="date-text",this._clearClass="ui-date-chooser-clear",this._clear=function(){this.cancelSelection()}.bind(this),this._initCalendarPanel(),this._initYearMonthPanel(),this._initYearMonthPanelAnimator(),this._initCalendarChangeAnimator()},_initYearMonthPanelAnimator:function(){this.ymAnimator=b.animator({target:this._settingPanel,onChange:function(a){this.target.css("top",a+"px")}}),this.ymAnimator.duration=300},_initCalendarChangeAnimator:function(){this.mcAnimator=b.animator({ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}).addTarget({ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}),this.mcAnimator.duration=300},_initYearMonthPanel:function(){var b,c,d,e,f;this._settingPanel=a("<div class='year-month-setting-panel' />"),b=a("<div class='set-title font-highlight' style='height:24px;line-height:24px;' />"),this._settingPanel.append(b),d=a("<div class='date-chooser-prev'/>"),d.click({value:-10},this.onYearChangedHandler),b.append(d),this._yearPrev=d,b.append("<div class='date-chooser-title'><span id='yearTitle'>"+this._language.year+"</span></div>"),e=a("<div class='date-chooser-next'/>"),e.click({value:10},this.onYearChangedHandler),b.append(e),this._yearNext=e,b.append(a("<br clear='left' />")),this._settingPanel.append(this._createYearPanel()),c=a("<div class='set-title font-highlight' style='text-align:center;height:27px;line-height:27px;' />"),f=[],f.push("<fieldset class='title-fieldset border-highlight'>"),f.push("<legend class='title-legend font-highlight'>",this._language.month,"</legend>"),f.push("</fieldset>"),c.html(f.join("")),this._settingPanel.append(c),this._settingPanel.append(this._createMonthPanel()),this._settingPanel.append(this._createOkCancel()),this._calendarPanel.append(this._settingPanel)},_createYearPanel:function(){var b,c,d,e,f,g;for(b=a("<div class='date-chooser-year-panel' />"),this._yearsTable=a("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),this._yearsTable.click(this.onYearSelectedHandler),c=a("<tbody />"),f=0;f<3;f++){for(d=a("<tr />"),g=0;g<5;g++)e=a("<td class='date-chooser-year-td' />"),d.append(e);c.append(d)}return this._yearsTable.append(c),b.append(this._yearsTable),b},_createMonthPanel:function(){var b,c,d,e,f,g,h;for(b=a("<div class='date-chooser-month-panel' />"),this._monthsTable=a("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),this._monthsTable.click(this.onMonthSelectedHandler),c=a("<tbody />"),h=0,f=0;f<3;f++){for(d=a("<tr />"),g=0;g<4;g++)e=a("<td class='date-chooser-month-td' />"),e.html(this._language.months[h]),e.attr("data-month",h++),d.append(e);c.append(d)}return this._monthsTable.append(c),b.append(this._monthsTable),b},_createOkCancel:function(){var b=a("<div class='date-chooser-operate-panel' />");return b.append(this._createButton(this.onApplyYearMonthHandler,"<i class='fa fa-check'></i>",null,{"margin-right":"10px"})),b.append(this._createButton(this.onCancelYearMonthHandler,"<i class='fa fa-remove'></i>")),b},_initCalendarPanel:function(){this._calendarPanel.append(this._createTitlePanel()),this._calendarPanel.append(this._createDatePanel()),this._calendarPanel.append(this._createCtrlPanel())},_createTitlePanel:function(){var b,c,d,e;return b=a("<div class='date-chooser-calendar-title' />"),c=a("<div class='date-chooser-prev' />"),c.click({value:-1},this.onMonthChangedHandler),b.append(c),this._monthPrev=c,e=a("<div class='date-chooser-title' />"),this._linkBtn=a("<a href='javascript:void(0)' class='date-chooser-title-text font-highlight' />"),this._linkBtn.click(this.onCalendarTitleClickHandler),this._updateCalendarTitle(),e.append(this._linkBtn),b.append(e),d=a("<div class='date-chooser-next' />"),d.click({value:1},this.onMonthChangedHandler),b.append(d),this._monthNext=d,b},_createDatePanel:function(){var b=a("<div class='date-chooser-calendar-panel' />");return b.append(this._createWeekHead()),b.append(this._createDaysBody()),b},_createWeekHead:function(){var b,c,d,e,f,g;for(b=a("<div class='date-chooser-week-panel'/>"),c=a("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),d=a("<tbody />"),e=a("<tr />"),g=0;g<7;g++)f=a("<th class='date-chooser-calendar-th' />"),f.text(this._language.weeks[g]),0!==g&&6!==g||f.addClass("date-chooser-weekend"),e.append(f);return d.append(e),c.append(d),b.append(c),b},_createDaysBody:function(){var b;return b=a("<div class='date-chooser-days-panel' />"),this._currentDays=this._createDaysTable(),this._nextDays=this._createDaysTable(),this._nextDays.css("display","none"),b.append(this._currentDays),b.append(this._nextDays),b.click(this.onDayItemClickHandler),b},_createDaysTable:function(){var b,c,d,e,f;for(b=a("<table class='date-chooser-table' cellpadding='0' cellspacing='0' />"),c=a("<tbody />"),e=0;e<6;e++){for(d=a("<tr />"),f=0;f<7;f++)d.append(a("<td class='date-chooser-calendar-td' />"));c.append(d)}return b.append(c),b},_createCtrlPanel:function(){var b,c,e,f;return b=a("<div class='date-chooser-operate-panel' />"),c=new Date,this.isDateTime()?(f=d(c.getHours()),this.hourText=a("<input type='text' class='hour date-chooser-time-input font-highlight-hover' />"),this.hourText.val(f),this.hourText.textinput(this.onTimeTextinputHandler),b.append(this.hourText),b.append("<span style='margin-left:2px;margin-right:2px;'>:</span>"),f=d(c.getMinutes()),this.minuteText=a("<input type='text' class='minute date-chooser-time-input font-highlight-hover' />"),this.minuteText.val(f),this.minuteText.textinput(this.onTimeTextinputHandler),b.append(this.minuteText),b.append("<span style='margin-left:2px;margin-right:2px;'>:</span>"),f=d(c.getSeconds()),this.secondText=a("<input type='text' class='second date-chooser-time-input font-highlight-hover' />"),this.secondText.val(f),this.secondText.textinput(this.onTimeTextinputHandler),b.append(this.secondText),b.mousewheel(this.onTimeMousewheelHandler)):(e=!this.startDay||this.startDay.lt(c.getFullYear(),c.getMonth(),c.getDate()),e=e&&(!this.endDay||this.endDay.gt(c.getFullYear(),c.getMonth(),c.getDate())),f=this._createButton(this.onTodayButtonClickHandler,c.getDate()),f.attr("title",this.formatDateValue(c)),e||f.prop("disabled",!0),this._todayButton=f,b.append(f)),b},_createButton:function(c,d,e,f){var g=a("<button class='icon-button date-chooser-button' />");return d&&g.html(d),e&&g.addClass(e),b.core.isObject(f)&&g.css(f),g.click(c),g},_setCurrentDate:function(a){var b=this.option.dateFormat,c=new Date;this._selYear=g.call(this,F,a,b),this._selMonth=g.call(this,G,a,b),this._selDay=g.call(this,H,a,b),(isNaN(this._selYear)||this._selYear<=1970||this._selYear>9999)&&(this._selYear=c.getFullYear()),this._selMonth--,(isNaN(this._selMonth)||this._selMonth<0||this._selMonth>11)&&(this._selMonth=c.getMonth()),(isNaN(this._selDay)||this._selDay<=0||this._selDay>31)&&(this._selDay=c.getDate()),this._isDisabledDay(this._selYear,this._selMonth,this._selDay)&&(this._selYear=this.startDay.year,this._selMonth=this.startDay.month,this._selDay=this.startDay.day)},_setCurrentTime:function(a){var b,c,e,f,h;this.isDateTime()&&(f=this.option.dateFormat,h=new Date,b=g.call(this,I,a,f),c=g.call(this,J,a,f),e=g.call(this,K,a,f),(isNaN(b)||b<0||b>=24)&&(b=h.getHours()),(isNaN(c)||c<0||c>=60)&&(c=h.getMinutes()),(isNaN(e)||e<0||e>=60)&&(e=h.getSeconds()),this.hourText.val(d(b)),this.minuteText.val(d(c)),this.secondText.val(d(e)))},_updateCalendarTitle:function(){this._linkBtn.html(e.call(this,this._selYear,this._selMonth))},_fillMonth:function(b,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(this._checkPrev(d,e,this._monthPrev),this._checkNext(d,e,this._monthNext),f=[],h=new Date(d,e,1),j=h.getDay(),j>0)for(g=new Date(d,e,0),k=g.getFullYear(),l=g.getMonth(),m=g.getDate(),n=m-(j-1);n<=m;n++)f.push(c(k,l,n,this).isCurrentMonth(!1));for(t=new Date(d,e+1,0).getDate(),n=1;n<=t;n++)f.push(c(d,e,n,this));for(i=new Date(e,e+1,1),k=i.getFullYear(),l=i.getMonth(),t=42-f.length,n=1;n<=t;n++)f.push(c(k,l,n,this).isCurrentMonth(!1));for(s=new Date,b.data("days",f),q=b[0].rows,n=0;n<6;n++)for(o=0;o<7;o++)p=7*n+o,m=f[p],m.setToday(s),r=a(q[n].cells[o]),r.attr("data-index",p),m.isDisabled()?r.addClass("disabled-day"):r.html("<span>"+m.day+"</span>"),m.isTheDay(this._selYear,this._selMonth,this._selDay)&&this._selectItem(r),m.isToday()?r.addClass("font-highlight"):r.removeClass("font-highlight"),m.isCurrentMonth()||r.addClass("other-month-day")},_fillYear:function(b,c){var d,e,f,g,h,i,j;for(e=15,d=15*Math.floor(b/15),a("#yearTitle").text(d+"年 ~ "+(d+e-1)+"年"),this._checkPrev(d-1,-1,this._yearPrev),this._checkNext(d+e,-1,this._yearNext),this._currentYear&&(this._currentYear.removeClass(B).removeClass("background-highlight"),this._currentYear=null),f=this._yearsTable[0].rows,i=0;i<3;i++)for(j=0;j<5;j++)g=a(f[i].cells[j]),h=d+(5*i+j),this.startDay&&h<this.startDay.year||this.endDay&&h>this.endDay.year?g.addClass("disabled-year"):g.html(h),g.attr("data-year",h),h===b&&(g.addClass(B).addClass("background-highlight"),this._currentYear=g);this._updateMonthsStatus(c)},_updateMonthsStatus:function(b){var c,d,e,f,g,h,i,j;if(g=parseInt(this._currentYear.attr("data-year"),10),f=new Array(12),this.startDay||this.endDay)for(startMonth=-1,endMonth=-1,this.startDay&&this.startDay.year===g&&(startMonth=this.startDay.month),this.endDay&&this.endDay.year===g&&(endMonth=this.endDay.month),i=0;i<f.length;i++)(i<startMonth||i>endMonth)&&(f[i]=!1);for(this._currentMonth&&(this._currentMonth.removeClass(C).removeClass("background-highlight"),this._currentMonth=null),c=this._monthsTable[0].rows,i=0;i<3;i++)for(j=0;j<4;j++)h=4*i+j,d=a(c[i].cells[j]),f[h]===!1?d.addClass("disabled-month"):d.removeClass("disabled-month"),e=parseInt(d.attr("data-month"),10),e===b&&(this._currentMonth=d,d.addClass(C).addClass("background-highlight"))},_checkPrev:function(a,b,c){var d,e;this.startDay&&(d=12*this.startDay.year,e=12*a,b>=0&&(d+=this.startDay.month+1,e+=b+1),e<=d?c.addClass("date-chooser-prev-disabled"):c.removeClass("date-chooser-prev-disabled"))},_checkNext:function(a,b,c){var d,e;this.endDay&&(d=12*this.endDay.year,
e=12*a,b>=0&&(d+=this.endDay.month+1,e+=b+1),e>=d?c.addClass("date-chooser-next-disabled"):c.removeClass("date-chooser-next-disabled"))},_isDisabledDay:function(a,b,c){return!(!this.startDay||!this.startDay.gt(a,b,c))||!(!this.endDay||!this.endDay.lt(a,b,c))},_getSelectionData:function(a){var b,c,d,e,f=0,g=0,h=0;return e={},this.isDateTime()&&(f=parseInt(this.hourText.val(),10)||0,g=parseInt(this.minuteText.val(),10)||0,h=parseInt(this.secondText.val(),10)||0),b=parseInt(a.attr("data-index"),10),c=a.parent().parent().parent(),c=c.data("days"),d=c[b],e.date=new Date(d.year,d.month,d.day,f,g,h),e.value=this.formatDateValue(e.date),e},_selectItem:function(b){var c;b.hasClass("disabled-day")||(c=this._getSelectionData(b),b.element=b,c.originElement=b.context?a(b.context):null,this.fire("selecting",c)!==!1&&(this._selYear=c.date.getFullYear(),this._selMonth=c.date.getMonth(),this._selDay=c.date.getDate(),this._currentDate&&this._currentDate.removeClass(A).removeClass("background-highlight"),this._currentDate=b,this._currentDate.addClass(A).addClass("background-highlight"),this.fire("selected",c)))},_openYearMonthPanel:function(){var a;a=this.ymAnimator[0],a.target.css("display","block"),a.begin=parseFloat(a.target.css("top")),a.end=0,a.ease=b.AnimationStyle.easeTo,this.ymAnimator.start()},_closeYearMonthPanel:function(){var a;a=this.ymAnimator[0],a.begin=parseFloat(a.target.css("top")),a.end=-a.target.height(),a.ease=b.AnimationStyle.easeFrom,this.ymAnimator.start().done(function(){a.target.css("display","none")}),this._currentYear.removeClass(B).removeClass("background-highlight"),this._currentMonth.removeClass(C).removeClass("background-highlight"),this._currentYear=null,this._currentMonth=null},_changeMonth:function(a,c,d){var e,f,g,h,i;this.mcAnimator.isStarted||(f=this._currentDays.parent(),h=f.width(),g=parseFloat(this._currentDays.css("left"))||0,e=this.mcAnimator[0],e.target=this._currentDays,e.begin=g,e.end=c?-h:h,e=this.mcAnimator[1],e.target=this._nextDays,e.target.css("display","block"),c?(e.begin=h-g,e.target.css("left",e.begin+"px")):(e.begin=g-h,e.target.css("left",e.begin+"px")),e.end=0,this._selYear=a.getFullYear(),this._selMonth=a.getMonth(),this._updateCalendarTitle(),this._fillMonth(this._nextDays,this._selYear,this._selMonth),f.addClass("click-disabled"),i=this,this.mcAnimator.start().done(function(){var a=i._currentDays;i._currentDays=i._nextDays,i._nextDays=a,i._nextDays.css("display","none"),f.removeClass("click-disabled"),b.core.isFunction(d)&&d.call(i)}))},isDateTime:function(){return!!this.option.isDateTime},setSelection:function(b){var c,d,e,f,g;b&&!this._isDisabledDay(b.getFullYear(),b.getMonth(),b.getDate())&&(f=new Date(b.getFullYear(),b.getMonth(),1),c=f.getDay()+b.getDate()-1,d=Math.floor(c/7),e=c-7*d,g=a(this._currentDays[0].rows[d].cells[e]),g.length>0&&this._selectItem(g))},getSelection:function(){return this._currentDate?this._getSelectionData(this._currentDate):null},cancelSelection:function(){this._currentDate&&this._currentDate.removeClass(A).removeClass("background-highlight"),this.fire("cancel")},setDateValue:function(a){this._setCurrentDate(a),this.isDateTime()&&this._setCurrentTime(a),this._updateCalendarTitle(),this._fillMonth(this._currentDays,this._selYear,this._selMonth)},formatDateValue:function(a){var b=this.option.dateFormat;return b=f(F,a.getFullYear(),b),b=f(G,a.getMonth()+1,b),b=f(H,a.getDate(),b),this.isDateTime()&&(b=f(I,a.getHours(),b),b=f(J,a.getMinutes(),b),b=f(K,a.getSeconds(),b)),b},show:function(){var a,b,c,d,e;this._todayButton&&(d=new Date,c=parseInt(this._todayButton.text(),10),d.getDate()!==c&&this._todayButton.html(d.getDate()).attr("title",this.formatDateValue(d))),a=this,b=this._super,e=function(){a.moveToElement(a.element,!0),b.call(a)},this.isShow()?this.hide(e):e()}});var L,M;a.fn.dateChooser=function(c){var d,e,f;return 0===this.length?null:(this.hasClass("date-text")&&this.css("width",parseFloat(this.css("width"),10)-23+"px"),d=this.nodeName(),"INPUT"!==d&&"A"!==d&&"SELECT"!==d&&this.attr("tabindex",0),e="INPUT"===d?function(){return this.val()}:function(){return this.text()},c&&c.isDateTime?(M||(c.dateFormat||(c.dateFormat=E),M=v(c,this)),f=M):(L||(L=v(null,this)),f=L),c=a.extend({},f.option,c),this.focus(function(d){var g,h=a(d.target);f.isShow()&&f.element&&f.element[0]===h[0]||(f.element&&f.element.removeClass(f._clearClass),y.call(f,h,c),g=e.call(h),f.setDateValue(g),b.hideAll(f),f.show())}).click(function(a){a.stopPropagation()}),f)}}(jQuery,ui),function(a,b){"use strict";function c(a){var b,c,d,e;for(c=a.split("."),b=this[c[0]],d=1,e=c.length;d<e&&(b=b[c[d]],void 0!==b&&null!==b);d++);return void 0===b&&(b=null),b}function d(a){for(var b,c=[],d=0;d<a.length;d++)b=this[a[d]],void 0===b&&(b=null),c.push(b+"");return c.join("_")}function e(c,d,e){var f="";return b.core.isString(c)?f=c:c&&(f=this._getText.call(c,this.option.textField)),a("<span />").text(f)}function f(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function g(a){return a.hasClass("fa-check-square")}function h(b){var c,d;for(this.isMultiple()&&b.stopPropagation(),c=a(b.target);"LI"!==(d=c.nodeName())&&!c.hasClass("ui-selection-list-li");){if(c.hasClass("ui-selection-list-panel"))return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),this._selectItem(c)}var i="ui-selection-list-selected",j="ui-selection-list-checkbox";b.define("ui.ctrls.SelectionList",b.ctrls.DropDownBase,{_defineOption:function(){return{multiple:!1,valueField:null,textField:null,viewData:null,itemFormatter:null}},_defineEvents:function(){return["changing","changed","cancel"]},_create:function(){var b,e;this._super(),this._current=null,this._selectList=[],b=[this.option.valueField,this.option.textField],e=["_getValue","_getText"],b.forEach(function(b,f){Array.isArray(b)?this[e[f]]=d:a.isFunction(b)?this[e[f]]=b:this[e[f]]=c},this),this.onItemClickHandler=h.bind(this)},_render:function(){this.listPanel=a("<div class='ui-selection-list-panel border-highlight' />"),this.listPanel.click(this.onItemClickHandler),this.wrapElement(this.element,this.listPanel),this._showClass="ui-selection-list-show",this._clearClass="ui-selection-list-clear",this._clear=function(){this.cancelSelection()},this._selectTextClass="select-text",this.initPanelWidth(this.option.width),b.core.isFunction(this.option.itemFormatter)?this.itemFormatter=this.option.itemFormatter:this.itemFormatter=e,Array.isArray(this.option.viewData)&&this._fill(this.option.viewData),this._super()},_fill:function(b){var c,d,e;for(this.clear(),c=a("<ul class='ui-selection-list-ul' />"),e=0;e<b.length;e++)this.option.viewData.push(b[e]),d=a("<li class='ui-selection-list-li' />"),this.isMultiple()&&d.append(this._createCheckbox()),d.append(this.itemFormatter(b[e],e,d)),d.attr("data-index",e),c.append(d);this.listPanel.append(c)},_createCheckbox:function(){var b=a("<i class='fa fa-square' />");return b.addClass(j),b},_getItemIndex:function(a){return parseInt(a.getAttribute("data-index"),10)},_getSelectionData:function(a){var b=this._getItemIndex(a),c={},d=this.getViewData();return c.itemData=d[b],c.itemIndex=b,c},_selectItem:function(c,d,e){var h,k,l,m,n;if(h=this._getSelectionData(c[0]),h.element=c,h.originElement=c.context?a(c.context):null,l=this.isMultiple(),l&&(k=c.find("."+j)),b.core.isBoolean(d)?h.isSelection=d:l?h.isSelection=!g.call(this,k):h.isSelection=!0,this.fire("changing",h)!==!1){if(l)if(h.isSelection){if(g.call(this,k))return;f.call(this,k,!0),this._selectList.push(c[0])}else{if(!g.call(this,k))return;for(m=0,n=this._selectList.length;m<n;m++)if(this._selectList[m]===c[0]){f.call(this,k,!1),this._selectList.splice(m,1);break}}else{if(this._current){if(this._current[0]==c[0])return;this._current.removeClass(i).removeClass("background-highlight")}this._current=c,this._current.addClass(i).addClass("background-highlight")}e!==!1&&this.fire("changed",h)}},_selectByValues:function(b,c){var d,e,f,g,h,i;for(d=b.length,b=b.slice(0),e=this.getViewData(),g=0,i=e.length;g<i;g++)for(f=e[g],h=0;h<d;h++)if(this._equalValue(f,b[h])){c.elem=a(this.listPanel.children("ul").children()[g]),this._selectItem(c.elem,!0,!1),d--,b.splice(h,1);break}},_equalValue:function(a,c){return b.core.isString(a)?a===c+"":b.core.isObject(a)&&!b.core.isObject(c)?this._getValue.call(a,this.option.valueField)===c:this._getValue.call(a,this.option.valueField)===this._getValue.call(c,this.option.valueField)},getSelection:function(){var a,b,c=null;if(this.isMultiple())for(c=[],a=0,b=this._selectList.length;a<b;a++)c.push(this._getSelectionData(this._selectList[a]).itemData);else this._current&&(c=this._getSelectionData(this._current[0]).itemData);return c},getSelectionValues:function(){var a,b,c,d=null;if(this.isMultiple())for(d=[],b=0,c=this._selectList.length;b<c;b++)a=this._getSelectionData(this._selectList[b]).itemData,d.push(this._getValue.call(a,this.option.valueField));else this._current&&(a=this._getSelectionData(this._current[0]).itemData,d=this._getValue.call(a,this.option.valueField));return d},setSelection:function(a){var b,c;this.cancelSelection(),this.isMultiple()?Array.isArray(a)||(a=[a]):a=Array.isArray(a)?[a[0]]:[a],b={elem:null},this._selectByValues(a,b),b.elem&&(c=this._getSelectionData(b.elem[0]),c.element=b.elem,c.originElement=null,this.fire("selected",c))},cancelSelection:function(b){var c,d,e;if(this.isMultiple()){for(d=0,e=this._selectList.length;d<e;d++)c=a(this._selectList[d]),f.call(this,c.find("."+j),!1);this._selectList=[]}else this._current&&(this._current.removeClass(i).removeClass("background-highlight"),this._current=null);b!==!1&&this.fire("cancel")},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.viewData.length},isMultiple:function(){return this.option.multiple===!0},clear:function(){this.option.viewData=[],this.listPanel.empty(),this._current=null,this._selectList=[]}}),a.fn.selectionList=function(a){return 0===this.length?null:b.ctrls.SelectionList(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(){return this[q]}function d(a){var b,c,d,e;for(c=a.split("."),b=this[c[0]],d=1,e=c.length;d<e&&(b=b[c[d]],void 0!==b&&null!==b);d++);return void 0===b&&(b=null),b}function e(a){for(var b,c=[],d=0;d<a.length;d++)b=this[a[d]],void 0===b&&(b=null),c.push(b+"");return c.join("_")}function f(b,c,d){var e=a("<span />").text(b);return c>0&&e.css("margin-left",c),e}function g(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function h(a){return a.hasClass("fa-check-square")}function i(b){var c,d,e,f;if(this.isMultiple()&&b.stopPropagation(),c=a(b.target),c.hasClass(n))return b.stopPropagation(),void this.onTreeFoldClickHandler(b);for(;"DT"!==(d=c.nodeName())&&!c.hasClass("ui-selection-tree-dt");){if(c.hasClass("ui-selection-tree-panel"))return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),e=this._getNodeData(c),f=this._hasChildren(e),this.option.nodeSelectable!==!0&&f?f&&(b.stopPropagation(),this.onTreeFoldClickHandler({target:c.children(".fold-button")[0]})):this._selectItem(c,e)}function j(b){var c,d;c=a(b.target),d=c.parent(),c.hasClass(o)?this._setChildrenExpandStatus(d,!1,c):this._setChildrenExpandStatus(d,!0,c)}function k(b){var c,d,e;c=a(b.target),d=c.parent(),e=d.next(),c.hasClass(o)?this._setChildrenExpandStatus(d,!1,c):(this._setChildrenExpandStatus(d,!0,c),0===e.children().length&&this._loadChildren(d,e,this._getNodeData(d)))}var l="ui-selection-tree-selected",m="ui-selection-tree-checkbox",n="fold-button",o="expand-button",p=0,q="_selectionTreeParentNode",r=3,s=14;b.define("ui.ctrls.SelectionTree",b.ctrls.DropDownBase,{_defineOption:function(){return{multiple:!1,valueField:null,textField:null,parentField:null,childField:null,viewData:null,nodeSelectable:!0,defaultExpandLevel:!1,lazy:!1,itemFormatter:null}},_defineEvents:function(){return["changing","changed","cancel"]},_create:function(){var c,g;this._super(),this._current=null,this._selectList=[],this._treePrefix="selectionTree_"+ ++p+"_",c=[this.option.valueField,this.option.textField,this.option.parentField],g=["_getValue","_getText","_getParent"],c.forEach(function(b,c){Array.isArray(b,c)?this[g[c]]=e:a.isFunction(b)?this[g[c]]=b:this[g[c]]=d},this),this.option.defaultExpandLevel===!1?this.expandLevel=0:b.core.isNumber(this.option.defaultExpandLevel)?this.expandLevel=this.option.defaultExpandLevel<=0?0:this.option.defaultExpandLevel:this.expandLevel=1e3,this.option.lazy?(b.core.isFunction(this.option.lazy.hasChildren)&&(this._hasChildren=this.option.lazy.hasChildren),b.core.isFunction(this.option.lazy.loadChildren)&&(this._loadChildren=this.option.lazy.loadChildren,this.expandLevel=0),this.onTreeFoldClickHandler=k.bind(this),this.option.lazy=!0):(this.onTreeFoldClickHandler=j.bind(this),this.option.lazy=!1),b.core.isFunction(this.option.itemFormatter)||(this.option.itemFormatter=f),this.onTreeItemClickHandler=i.bind(this)},_render:function(){this.treePanel=a("<div class='ui-selection-tree-panel border-highlight' />"),this.treePanel.click(this.onTreeItemClickHandler),this.wrapElement(this.element,this.treePanel),this._showClass="ui-selection-tree-show",this._clearClass="ui-selection-tree-clear",this._clear=function(){this.cancelSelection()},this._selectTextClass="select-text",this.initPanelWidth(this.option.width),b.core.isFunction(this.option.itemFormatter)?this.itemFormatter=this.option.itemFormatter:this.itemFormatter=f,Array.isArray(this.option.viewData)&&this._fill(this.option.viewData),this._super()},_fill:function(b){var c,d;this.clear(),this.option.viewData=b,c=a("<dl class='ui-selection-tree-dl' />"),d=this.getViewData(),this.option.childField?this._renderTree(d,c,0):this.option.parentField&&this._listDataToTree(d,c,0),this.treePanel.append(c)},_listDataToTree:function(a,c,d){var e;Array.isArray(a)&&0!==a.length&&(this.originalViewData=a,e="children",a=b.trans.listToTree(a,this.option.parentField,this.option.valueField,e),a?(this.option.childField=e,this.option.viewData=a,this._renderTree(a,c,d)):delete this.originalViewData)},_renderTree:function(b,d,e,f,g){var h,i,j,k,l,m,n,p,t,u,v,w;if(Array.isArray(b)&&0!==b.length)for(w=f,l=0,m=b.length;l<m;l++)n=0,k=b[l],k[q]=g||null,k.getParent=c,h=w?w+"_"+l:""+l,i=this._getText.call(k,this.option.textField)||"",t=a("<dt class='ui-selection-tree-dt' />"),this.isMultiple()&&(v=this._createCheckbox()),t.prop("id",this._treePrefix+h),d.append(t),this._hasChildren(k)?(j=this._getChildren(k),u=a("<dd class='ui-selection-tree-dd' />"),e+1<=this.expandLevel?t.append(this._createFoldButton(e,o,"fa-angle-down")):(t.append(this._createFoldButton(e,"fa-angle-right")),u.css("display","none")),this.option.nodeSelectable===!0&&v&&t.append(v),this.option.lazy?e+1<=this.expandLevel&&this._loadChildren(t,u,k):(p=a("<dl class='ui-selection-tree-dl' />"),this._renderTree(j,p,e+1,h,k),u.append(p)),d.append(u)):(n=(e+1)*(s+r)+r,v&&(v.css("margin-left",n+"px"),n=0,t.append(v))),t.append(this.option.itemFormatter.call(this,i,n,k,t))},_createCheckbox:function(){var b=a("<i class='fa fa-square' />");return b.addClass(m),b},_createFoldButton:function(b){var c,d,e;for(c=a("<i class='fold-button font-highlight-hover fa' />"),d=1,e=arguments.length;d<e;d++)c.addClass(arguments[d]);return c.css("margin-left",b*(s+r)+r+"px"),c},_setChildrenExpandStatus:function(a,b,c){var d=a.next();c&&0!==c.length||(c=a.children(".fold-button")),b?(c.addClass(o).removeClass("fa-angle-right").addClass("fa-angle-down"),d.css("display","block")):(c.removeClass(o).removeClass("fa-angle-down").addClass("fa-angle-right"),d.css("display","none"))},_getChildren:function(a){return a[this.option.childField]||null},_hasChildren:function(a){var b=this._getChildren(a);return Array.isArray(b)&&b.length>0},_loadChildren:function(a,b,c){var d=this._getChildren(c);this._appendChildren(a,b,c,d)},_getNodeData:function(a){var b;return a?(b=a.prop("id"),0===b.length||0!==b.indexOf(this._treePrefix)?null:(b=b.substring(this._treePrefix.length),this._getNodeDataByPath(b))):null},_getNodeDataByPath:function(a){var b,c,d,e,f;if(!a)return null;for(b=a.split("_"),d=this.getViewData(),c=d[parseInt(b[0],10)],e=1,f=b.length;e<f;e++)c=this._getChildren(c)[parseInt(b[e],10)];return c},_getSelectionData:function(a,b){var c={};return b||(b=this._getNodeData(a)),c.nodeData=b,c.children=this._getChildren(b),c.parent=b[q],c.isRoot=!b[q],c.isNode=this._hasChildren(b),c},_selectItem:function(c,d,e,f){var i,j,k,n,o;if(i=this._getSelectionData(c,d),i.element=c,i.originElement=c.context?a(c.context):null,k=this.isMultiple(),k&&(j=c.find("."+m)),b.core.isBoolean(e)?i.isSelection=e:k?i.isSelection=!h.call(this,j):i.isSelection=!0,this.fire("changing",i)!==!1){if(k)if(i.isSelection){if(h.call(this,j))return;g.call(this,j,!0),this._selectList.push(c[0])}else{if(!h.call(this,j))return;for(n=0,o=this._selectList.length;n<o;n++)if(this._selectList[n]===c[0]){g.call(this,j,!1),this._selectList.splice(n,1);break}}else{if(this._current){if(this._current[0]==c[0])return;this._current.removeClass(l).removeClass("background-highlight")}this._current=c,this._current.addClass(l).addClass("background-highlight")}f!==!1&&this.fire("changed",i)}},_selectTreeByValues:function(a,b,c,d,e){var f,g,h,i,j;if(Array.isArray(a)&&0!==a.length&&Array.isArray(b)&&0!==b.length)for(f=0,h=a.length;f<h;f++){for(i=a[f],j=d?d+"_"+f:""+f,g=0;g<b.length;g++)if(this._equalValue(i,b[g])){e.dt=this._selectNodeByValue(i,j),b.splice(g,1);break}if(0===b.length)break;this._selectTreeByValues(this._getChildren(i),b,c+1,j,e)}},_equalValue:function(a,c){return b.core.isObject(a)&&!b.core.isObject(c)?this._getValue.call(a,this.option.valueField)===c:this._getValue.call(a,this.option.valueField)===this._getValue.call(c,this.option.valueField)},_selectNodeByValue:function(b,c){var d,e,f,g,h,i;if(this.option.lazy){for(f=[],pathArray=c.split("_"),e="#"+this._treePrefix+c,d=a(e);0===d.length&&(f.push(e),pathArray.splice(pathArray.length-1,1),0!==pathArray.length);)e="#"+this._treePrefix+pathArray.join("_"),d=a(e);if(0===d.length)return;for(g=f.length-1;g>=0;g--)h=d,i=h.next(),this._loadChildren(h,i,this._getNodeData(h)),d=a(f[g])}else d=a("#"+this._treePrefix+c);for(i=d.parent().parent();"DD"===i.nodeName()&&i.hasClass("ui-selection-tree-dd");)h=i.prev(),"none"===i.css("display")&&this._setChildrenExpandStatus(h,!0),i=h.parent().parent();return this._selectItem(d,b,!0,!1),d},_selectChildNode:function(b,c,d){var e,f,g,h,i;if(e=this._getChildren(b),Array.isArray(e)&&0!==e.length)for(f=c.prop("id"),g=c.next(),this.option.lazy&&0===g.children().length&&this._loadChildren(c,g,b),h=0,i=e.length;h<i;h++)b=e[h],c=a("#"+f+"_"+h),this._selectItem(c,b,d,!1),this._selectChildNode(b,c,d)},_selectParentNode:function(b,c,d){var e,f,g,i,j,k,l,n;if(e=b[q]){if(f=c.substring(0,c.lastIndexOf("_")),g=a("#"+f),!d&&(i=g.next(),"DD"===i.nodeName()))for(j=i.find("dt"),k=0,l=j.length;k<l;k++)if(n=a(j[k]).find("."+m),h.call(this,n))return;this._selectItem(g,e,d,!1),this._selectParentNode(e,f,d)}},getSelection:function(){var b,c,d=null;if(this.isMultiple())for(d=[],b=0,c=this._selectList.length;b<c;b++)d.push(this._getNodeData(a(this._selectList[b])));else this._current&&(d=this._getNodeData(this._current));return d},getSelectionValues:function(){var b,c,d,e=null;if(this.isMultiple())for(e=[],c=0,d=this._selectList.length;c<d;c++)b=this._getNodeData(a(this._selectList[c])),e.push(this._getValue.call(b,this.option.valueField));else this._current&&(b=this._getNodeData(this._current),e=this._getValue.call(b,this.option.valueField));return e},setSelection:function(a){var b,c,d;this.cancelSelection(),this.isMultiple()?Array.isArray(a)||(a=[a]):a=Array.isArray(a)?[a[0]]:[a],b={elem:null},c=this.getViewData(),this._selectTreeByValues(c,a,0,null,b),b.elem&&(d=this._getSelectionData(b.elem),d.element=b.elem,d.originElement=null,this.fire("selected",d))},selectChildNode:function(a,b){var c;b=1===arguments.length||!!b,c=this._getNodeData(a),c&&this.isMultiple()&&this.option.nodeSelectable===!0&&this._selectChildNode(c,a,b)},selectParentNode:function(a,b){var c,d;b=1===arguments.length||!!b,c=this._getNodeData(a),c&&this.isMultiple()&&this.option.nodeSelectable===!0&&(d=a.prop("id"),this._selectParentNode(c,d,b))},cancelSelection:function(b){var c,d,e;if(this.isMultiple()){for(d=0,e=this._selectList.length;d<e;d++)c=a(this._selectList[d]),g.call(this,c.find("."+m),!1);this._selectList=[]}else this._current&&(this._current.removeClass(l).removeClass("background-highlight"),this._current=null);b!==!1&&this.fire("cancel")},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.viewData.length},isMultiple:function(){return this.option.multiple===!0},clear:function(){this.option.viewData=[],this.treePanel.empty(),this._current=null,this._selectList=[],delete this.originalViewData}}),a.fn.selectionTree=function(a){return 0===this.length?null:b.ctrls.SelectionTree(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a){b.hideAll(this),this._resetTreeList(),this.show()}function d(a){a.which===b.keyCode.DOWN?this._moveSelection(1):a.which===b.keyCode.UP?this._moveSelection(-1):a.which===b.keyCode.ENTER&&this._selectCompleter()}function e(b){for(var c,d=a(b.target);"DT"!==(c=d.nodeName())&&!d.hasClass("autocomplete-dt");){if(d.hasClass("autocomplete-dl"))return;d=d.parent()}this._currentCompleterElement&&this._currentCompleterElement.removeClass(h),this._currentCompleterElement=d,this._currentCompleterElement.addClass(h)}function f(a){a.stopPropagation(),this._selectCompleter()}function g(b){var c=a(b.target),d=c.val(),e=c.data("autocomplete.value");if(!this._cancelAutoComplete)return 0===d.length?(this._resetTreeList(),void this.cancelSelection()):void(this._autoCompleteListIsShow()&&e===d||(c.data("autocomplete.value",d),this.isShow()||this.show(),this._launch(d)))}var h="autocomplete-selected";b.define("ui.ctrls.AutocompleteSelectionTree",b.ctrls.SelectionTree,{_create:function(){this.option.multiple=!1,b.core.isNumber(this.option.limit)?this.option.limit<=0?this.option.limit=10:this.option.limit>100&&(this.option.limit=100):this.option.limit=10,this.onFocusHandler=c.bind(this),this.onKeyupHandler=d.bind(this),this.onMouseoverHandler=e.bind(this),this.onClickHandler=f.bind(this),this.onTextinputHandler=g.bind(this),this._super()},_render:function(){var a;this._super(),this.element.off("focus").on("focus",this.onFocusHandler).on("keyup",this.onKeyupHandler),b.browser.ie&&b.browser<9&&(a=this.fire,this.fire=function(){this._callAndCancelPropertyChange(a,arguments)}),this.element.textinput(this.onTextinputHandler),this._clear=function(){this.cancelSelection(!0,this._autoCompleteListIsShow())}},_callAndCancelPropertyChange:function(a,b){this._cancelAutoComplete=!0,a.apply(this,b),this._cancelAutoComplete=!1},_launch:function(a){var b,c=this.getViewData();0!==c.length&&(this.cancelSelection(!1,!1),b=this._search(a,c,this.option.limit),this._showSearchInfo(b,a))},_search:function(a,b,c){var d,e=[],f=[];return a=a.toLowerCase(),this._doSearch(e,f,a,b,c),d=e.concat(f),d.slice(0,c)},_doSearch:function(a,b,c,d,e,f){var g,h,i,j;for(g=0,h=d.length;g<h;g++){if(a.length>e)return;j=f?f+"_"+g:""+g,i=d[g],this._hasChildren(i)?(this.option.nodeSelectable===!0&&this._doQuery(a,b,c,i,j),this._doSearch(a,b,c,this._getChildren(i),e,j)):this._doQuery(a,b,c,i,j)}},_doQuery:function(a,b,c,d,e){var f;f=this._getText.call(d,this.option.textField).toLowerCase().search(c),0===f?a.push({nodeData:d,path:e}):f>0&&b.push({nodeData:d,path:e})},_showSearchInfo:function(b,c){var d,e,f,g,h,i,j;for(d=this._autoCompleteList,d?d.empty():(d=this._autoCompleteList=a("<dl class='autocomplete-dl' />"),d.hide(),d.click(this.onClickHandler).mouseover(this.onMouseoverHandler),this.treePanel.append(d)),e=[],g=new RegExp(c,"gi"),h="<span class='font-highlight'>"+c+"</span>",i=0,j=b.length;i<j;i++)e.push("<dt class='autocomplete-dt' data-path='"+b[i].path+"'>"),e.push("<span class='normal-text'>"),f=this._getText.call(b[i].nodeData,this.option.textField),f=f.replace(g,h),e.push(f),e.push("</span></dt>");a(this.treePanel.children()[0]).hide(),d.append(e.join("")),d.show(),this._moveSelection(1)},_autoCompleteListIsShow:function(){return!!this._autoCompleteList&&"block"===this._autoCompleteList.css("display")},_resetTreeList:function(){var b=this.treePanel.children();a(b[1]).hide(),a(b[0]).show()},_selectCompleter:function(){var a,c,d;this._currentCompleterElement&&(a=this._currentCompleterElement.attr("data-path"),c=this._getNodeDataByPath(a),c&&(d=this._selectNodeByValue(c,a),this.fire("selected",d,this._getSelectionData(d,c))),b.hideAll())},_moveSelection:function(b){var c,d;c=a(this.treePanel.children()[1]).children(),this._currentCompleterElement?this._currentCompleterElement.removeClass(h):this._currentCompleterElement=a(c[0]),0===b?this._currentCompleterElement=a(c[0]):1===b?(d=this._currentCompleterElement.next(),0===d.length&&(d=a(c[0])),this._currentCompleterElement=d):b===-1&&(d=this._currentCompleterElement.prev(),0===d.length&&(d=a(c[c.length-1])),this._currentCompleterElement=d),this._currentCompleterElement.addClass(h)},_selectItem:function(){this._callAndCancelPropertyChange(this._super,arguments)},cancelSelection:function(a,b){b?(this._callAndCancelPropertyChange(function(){this.element.val("")}),this._resetTreeList()):this._super(a)}}),a.fn.autocompleteSelectionTree=function(a){return 0===this.length?null:b.ctrls.AutocompleteSelectionTree(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(){}function d(a){return a<10?"0"+a:""+a}function e(a,b){var c,e,f=a.getHours(),g=a.getMinutes(),h=a.getSeconds();return b&&(c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0),e=a-c,e=e/1e3/60/60,e>=24&&(f=24)),[d(f),":",d(g),":",d(h)].join("")}function f(a){return a.getMonth()+1+" / "+a.getDate()+"（"+u[a.getDay()]+"）"}function g(b){for(var c,d=a(b.target);"TD"!==(c=d.nodeName());){if("TABLE"===c)return;d=d.parent()}d[0]!==b.target&&(d.context=b.target),this._selectItem(d)}function h(b){for(var c,d=a(b.target);"TD"!==(c=d.nodeName());){if("TABLE"===c)return;d=d.parent()}d[0]!==b.target&&(d.context=b.target),this._selectItem(d)}function i(b){for(var c,d=a(b.target);"TH"!==(c=d.nodeName());){if("TABLE"===c)return;d=d.parent()}this.calendar.fire("weekTitleClick",this,d[0].cellIndex)}function j(a){this.calendar.fire("weekTitleClick",this,0)}function k(a){return this instanceof k?void this.initialize(a):new k(a)}function l(a){return this instanceof l?void this.initialize(a):new l(a)}function m(a){return this instanceof m?void this.initialize(a):new m(a)}function n(a){return this instanceof n?void this.initialize(a):new n(a)}function o(a,b,c){return this instanceof o?void this.initialize(a,b,c):new o(a,b,c)}function p(c){var d,e,f;x=!0,w?f=b.StyleSheet(w):(w=a("#GlobalThemeChangeStyle"),0==w.length?(f=b.StyleSheet.createStyleSheet("GlobalThemeChangeStyle"),w=f.styleSheet):f=b.StyleSheet(w)),c||(c=b.theme.currentHighlight),d=b.theme.backgroundColor||"#FFFFFF",e=b.color.overlay(c.Color,d,.4),e=b.color.rgb2hex(e.red,e.green,e.blue),f.setRule(".ui-calendar-selector",{"background-color":e}),f.setRule(".ui-calendar-hour-panel .schedule-item-panel",{"background-color":e}),f.setRule(".ui-calendar-hour-panel .schedule-item-panel:hover",{"background-color":c.Color}),f.setRule(".ui-calendar-month-day-view .month-days-table .selected",{"background-color":e}),f.setRule(".ui-calendar-year-view .year-month-table .selected",{"background-color":e}),e=b.color.overlay(c.Color,d,.85),e=b.color.rgb2hex(e.red,e.green,e.blue),f.setRule(".ui-calendar-hour-panel .week-hour-cell-today",{"background-color":e}),e=b.color.overlay(c.Color,d,.7),e=b.color.rgb2hex(e.red,e.green,e.blue),f.setRule(".ui-calendar-month-day-view .month-days-cell .schedule-item",{"background-color":e}),f.setRule(".ui-calendar-month-day-view .month-days-cell .schedule-border",{"background-color":c.Color})}var q,r=80,s=25,t=17,u=["日","一","二","三","四","五","六"],v=["一","二","三","四","五","六","日"];k.prototype={constructor:k,initialize:function(b){this.calendar=b,this.initialled=!1,this.year=null,this._selectList=[],this._current=null,this.width=null,this.height=null,this.viewPanel=a("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this.onYearItemClickHandler=g.bind(this),this.yearPanel=a("<div class='ui-calendar-year-view' />"),this._initYear(),this.viewPanel.append(this.yearPanel),this.initialled=!0)},_initYear:function(){var b,c;for(c=0;c<12;c++)b=a("<div class='year-month-panel' />"),b.append(a("<div class='year-month-title' />").append("<span class='font-highlight'>"+(c+1)+"月</span>")),b.append("<div class='year-month-content' />"),this.yearPanel.append(b);this.yearPanel.append("<br clear='all' />")},_oddStyle:function(a,b,c){c%2&&a.addClass("year-month-odd")},_evenStyle:function(a,b,c){Math.floor(c/b)%2?c%2&&a.addClass("year-month-odd"):c%2===0&&a.addClass("year-month-odd")},_setCellSize:function(c,d){var e,f,g,h,i,j,k;if(c&&d&&(this.width!==c||this.height!==d))for(this.width=c,this.height=d,e=this.getMonthCount(c),f=e%2?this._oddStyle:this._evenStyle,g=this.yearPanel.children(),g.removeClass("year-month-odd"),i=Math.floor(c/e),j=Math.floor(i/4*3),(j*(12/e)>d||this.yearPanel[0].scrollHeight>d)&&(c-=b.scrollbarWidth,i=Math.floor(c/e)),j<248&&(j=248),k=0;k<12;k++)h=a(g[k]),h.css({width:i+"px",height:j+"px"}),h.children(".year-month-content").css("height",j-48+"px"),f.call(this,h,e,k)},_changeYear:function(a){this.calendar.currentDate=a,this.year=this.calendar.currentDate.getFullYear(),this._setCellSize(this.viewPanel.width(),this.viewPanel.height()),this._updateYear(),this._current=null,this._selectList=[]},_updateYear:function(){var b,c=this.yearPanel.children(".year-month-panel"),d=this.calendar.currentDate.getFullYear(),e=null,f=new Date;for(b=0;b<12;b++)e=a(c[b]),this._createMonth(a(e.children()[1]),d,b,f)},_createMonth:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(f=a("<table class='year-month-table unselectable' cellspacing='0' cellpadding='0' />"),g=a("<colgroup />"),h=a("<thead />"),i=a("<tbody />"),l=this.calendar.getWeekNames(),j=a("<tr />"),s=0;s<l.length;s++)g.append("<col />"),p=this.calendar.isWeekend(s)?"<th class='year-month-table-head ui-calendar-weekend'>":"<th class='year-month-table-head'>",j.append(p+l[s]+"</th>");for(h.append(j),m=1,n=this.calendar.getWeekIndexOf(new Date(c,d,m)),o=new Date(c,d+1,0).getDate(),p=!1,c===e.getFullYear()&&d===e.getMonth()&&(p=!0,q=e.getDate()),s=0;s<6;s++){for(j=a("<tr />"),t=0;t<7;t++)k=a("<td class='year-month-table-cell' />"),j.append(k),0===s&&t<n?k.addClass("ui-calendar-empty"):m<=o&&(r=a("<span>"+m+"</span>"),p&&m===q&&r.addClass("today").addClass("background-highlight"),k.append(r),m++);i.append(j)}f.append(g).append(h).append(i),b.empty().append(f),f.data("month",d),f.click(this.onYearItemClickHandler)},_isDateCell:function(a){return!a.hasClass("ui-calendar-empty")&&a.children().length>0},_getDateByCell:function(a){var b,c,d;return b=a.parent().parent().parent(),c=parseInt(b.data("month"),10),d=parseInt(a.children().text(),10),new Date(this.year,c,d)},_getCellByDate:function(b,c){var d,e,f;return d=a(a(b[c.getMonth()]).children()[1]),e=this.calendar.getTableIndexOf(c),f=a(d.children()[0].tBodies[0].rows[e.rowIndex].cells[e.cellIndex])},_selectItem:function(b){var c,d,e,f="selected";if(this._isDateCell(b)&&(c={},c.date=this._getDateByCell(b),c.view=this,c.element=b,c.originElement=b.context?a(b.context):null,this.calendar.fire("selecting",c)!==!1))if(this.isMultiple())if(b.hasClass(f)){for(b.removeClass(f),d=0,e=this._selectList.length;d<e;d++)if(this._selectList[d]===b[0]){
this._selectList.splice(d,1);break}this.calendar.fire("deselected",c)}else b.addClass(f),this._selectList.push(b[0]),this.calendar.fire("selected",c);else{if(this._current){if(this._current.removeClass(f),this._current[0]===b[0])return void this.calendar.fire("deselected",c);this._current=null}this._current=b,this._current.addClass(f),this.calendar.fire("selected",c)}},_updateSchedules:function(a,c,d){var e,f,g,h,i,j,k,l;if(Array.isArray(a))for(c||(c="date"),f=b.core.isFunction(c)?c:function(){return this[c]},l=b.core.isFunction(d),e=this.yearPanel.children(".year-month-panel"),i=0,j=a.length;i<j;i++){if(k=a[i],k instanceof Date)g=k;else if(g=f.call(k),!(g instanceof Date))continue;h=this._getCellByDate(e,g),l&&d.call(h,k)}},getMonthCount:function(a){return a>=1024?4:a>=768?3:a>=512?2:1},checkChange:function(){return this.calendar.hideTimeLine(),this.year!==this.calendar.currentDate.getFullYear()&&(this._changeYear(this.calendar.currentDate),!0)},active:c,dormant:c,previous:function(){var a=this.calendar.currentDate;this._changeYear(new Date(a.setFullYear(a.getFullYear()-1)))},next:function(){var a=this.calendar.currentDate;this._changeYear(new Date(a.setFullYear(a.getFullYear()+1)))},today:function(a){a&&a instanceof Date||(a=new Date),this._changeYear(new Date(a.getTime()))},addSchedules:function(a,c,d){var e;b.core.isFunction(d)||(d=null),e=function(a){var b=this.children(".year-day-marker");0===b.length&&this.append("<i class='year-day-marker border-highlight'></i>"),d&&d.call(this,a)},this._updateSchedules(a,c,e)},removeSchedules:function(a,c,d){var e;b.core.isFunction(d)||(d=null),e=function(a){var b=this.children(".year-day-marker");b.length>0&&b.remove(),d&&d.call(this,a)},this._updateSchedules(a,c,e)},clearSchedules:function(){var b,c,d,e,f,g,h,i;for(b=this.yearPanel.children(".year-month-panel"),g=0;g<12;g++)for(c=a(b[g]).children(".year-month-content").children(".year-month-table")[0].tBodies[0].rows,h=0;h<c.length;h++)for(d=c[h].cells,i=0;i<d.length;i++)e=a(d[i]),f=e.children(".year-day-marker"),f.length>0&&f.remove()},isMultiple:function(){return!!this.calendar.option.yearMultipleSelect},getSelection:function(){var b,c,d=null;if(this.isMultiple())for(d=[],b=0,c=this._selectList.length;b<c;b++)d.push(this._getDateByCell(a(this._selectList[b])));else this._current&&(d=this._getDateByCell(this._current));return d},setSelection:function(a){var c,d,e,f,g;for(Array.isArray(a)||(a=[a]),c=this.yearPanel.children(".year-month-panel"),f=0,g=a.length;f<g;f++)if(d=a[f],d instanceof Date){if(d.getFullYear()!==this.year)throw new Error(b.str.textFormat("the date({0}) does not belong to {1}",b.str.dateFormat(d,"yyyy-MM-dd"),this.year));e=this._getCellByDate(c,d),this._selectItem(e)}},cancelSelection:function(){var b,c,d,e;if(b="selected",this.isMultiple()){for(d=0,e=this._selectList.length;d<e;d++)c=a(this._selectList[d]),c.removeClass(b);this._selectList=[]}else this._current&&(this._current.removeClass(b),this._current=null);this.calendar.fire("cancel",this)},setSize:function(a,b){this._setCellSize(a,b)},getTitle:function(){return this.year+"年"},toString:function(){return"ui.ctrls.CalendarView.YearView"}},l.prototype={constructor:l,initialize:function(b){this.calendar=b,this.year=null,this.month=null,this.initialled=!1,this._selectList=[],this._current=null,this.width=null,this.height=null,this.viewPanel=a("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this.onMonthItemClickHandler=h.bind(this),this._setCurrent(),this.weekPanel=a("<div class='ui-calendar-month-week-view' />"),this._createWeek(),this.daysPanel=a("<div class='ui-calendar-month-day-view' />"),this._createDays(),this.viewPanel.append(this.weekPanel).append(this.daysPanel),this.initialled=!0)},_setCurrent:function(){var a=this.calendar.currentDate;this.year=a.getFullYear(),this.month=a.getMonth()},_createWeek:function(){var b,c,d,e,f,g,h;for(this.weekTable=a("<table class='month-week-table unselectable' cellspacing='0' cellpadding='0' />"),d=a("<thead />"),c=a("<colgroup />"),this.weekTable.append(c).append(d),e=a("<tr />"),b=this.calendar.getWeekNames(),g=0,h=b.length;g<h;g++)c.append("<col />"),f=a("<th class='month-week-cell' />"),this.calendar.isWeekend(g)&&f.addClass("ui-calendar-weekend"),f.append("<span class='month-week-text'>星期"+b[g]+"</span>"),g===h-1&&f.addClass("month-week-cell-last"),e.append(f);d.append(e),this.weekPanel.append(this.weekTable)},_createDays:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;for(this.daysTable?this.daysTable.html(""):(this.daysTable=a("<table class='month-days-table unselectable' cellspacing='0' cellpadding='0' />"),this.daysTable.click(this.onMonthItemClickHandler)),b=a("<tbody />"),c=a("<colgroup />"),m=0;m<7;m++)c.append("<col />");for(this.daysTable.append(c).append(b),f=this.calendar.currentDate,g=new Date(f.getFullYear(),f.getMonth(),1),i=this.calendar.getWeekIndexOf(g),h=new Date(g.getFullYear(),g.getMonth()+1,0).getDate(),g=1,j=new Date,k=j.getDate(),j.getFullYear()===f.getFullYear()&&j.getMonth()===f.getMonth()&&(l=function(a,b){b===k&&a.children().children(".month-date").addClass("font-highlight")}),o=g,m=0;m<6;m++){for(d=a("<tr />"),n=0;n<7;n++)e=a("<td class='month-days-cell' />"),d.append(e),0===m&&n<i||o>h||(e.append("<div class='day-container' />"),this.calendar.isWeekend(n)&&e.addClass("month-days-cell-weekend"),6===n&&e.addClass("month-days-cell-last"),e.children().html("<span class='month-date'>"+o+"</span>"),l&&l.call(this,e,o),o++);if(b.append(d),o>h)break}this.daysPanel.append(this.daysTable)},_setCellSize:function(b,c){var d,e,f,g,h,i,j,k,l;if(b&&c&&(this.width!==b||this.height!==c)){for(this.width=b,this.height=c,c-=26,this.daysPanel.css("height",c+"px"),d=this._setCellWidth(b),e=this.daysTable[0].rows,l=e.length,c-=l,g=Math.floor(c/l),h=c-g*(l-1),k=0;k<l;k++)k<l-1?a(e[k]).children().css("height",g+"px"):a(e[k]).children().css("height",h+"px");for(f=this.weekTable[0].tHead.rows[0].cells,i="",j=this.calendar.getWeekNames(),d>=60&&(i="星期"),k=0,l=f.length;k<l;k++)a(f[k]).children().text(i+j[k])}},_setCellWidth:function(a){var b,c,d;return b=Math.floor(a/7),c=this.weekTable.children("colgroup").children(),d=this.daysTable.children("colgroup").children("col"),c.splice(6,1),d.splice(6,1),c.css("width",b+"px"),d.css("width",b+"px"),b},_changeMonth:function(a){this.calendar.currentDate=a,this._setCurrent(),this._createDays(),this._setCellSize(this.viewPanel.width(),this.viewPanel.height()),this._current=null,this._selectList=[]},_isDateCell:function(a){return a.children(".day-container").children().length>0},_getDateByCell:function(a){var b,c;return b=a.children(".day-container"),c=b.children(".month-date"),0===c.length?null:(c=parseInt(c.text(),10),new Date(this.year,this.month,c))},_getCellByDate:function(b){var c,d,e;return c=this.daysTable[0].tBodies[0].rows,d=this.calendar.getTableIndexOf(b),e=a(c[d.rowIndex].cells[d.cellIndex])},_selectItem:k.prototype._selectItem,_updateSchedules:function(a,c,d){var e,f,g,h,i,j,k;if(Array.isArray(a))for(c||(c="date"),e=b.core.isFunction(c)?c:function(){return this[c]},k=b.core.isFunction(d),h=0,i=a.length;h<i;h++){if(j=a[h],j instanceof Date)f=j;else if(f=e.call(j),!(f instanceof Date))continue;g=this._getCellByDate(f),k&&d.call(g,j)}},checkChange:function(){var a;return this.calendar.hideTimeLine(),a=this.calendar.currentDate,(this.year!==a.getFullYear()||this.month!==a.getMonth())&&(this._changeMonth(a),!0)},active:c,dormant:c,previous:function(){var a=this.calendar.currentDate;this.width=null,this.height=null,this._changeMonth(new Date(a.setMonth(a.getMonth()-1)))},next:function(){var a=this.calendar.currentDate;this.width=null,this.height=null,this._changeMonth(new Date(a.setMonth(a.getMonth()+1)))},today:function(a){a&&a instanceof Date||(a=new Date),this.width=null,this.height=null,this._changeMonth(new Date(a.getTime()))},addSchedules:function(c,d,e){var f,g;b.core.isPlainObject(c)?(f=c,c=f.data,d=f.dateField,e=f.action):f={textField:"text"},g=b.core.isFunction(f.textField)?f.textField:function(){return this[f.textField]||null},b.core.isFunction(e)||(e=function(b){var c,d,e,f,h,i;e=this.children(".day-container"),c=e.children(".schedule-list"),0===c.length&&(c=a("<ul class='schedule-list' />"),c.data("schedule-items",[]),e.append(c)),d=c.data("schedule-items"),d.push(b),b.backgroundColor&&(h=" style='background-color:"+b.backgroundColor+"'"),b.borderColor&&(i=" style='background-color:"+b.borderColor+"'"),f=[],f.push("<li class='schedule-item'",h,">"),f.push("<b class='schedule-border'",i,"></b>"),f.push("<span class='schedule-text'>",g.call(b),"</span>"),f.push("</li>"),c.append(f.join(""))}),this._updateSchedules(c,d,e)},removeSchedules:function(c,d,e){var f,g;b.core.isPlainObject(c)?(f=c,c=f.data,d=f.dateField,e=f.action):f={idField:function(){return this}},g=b.core.isFunction(f.idField)?f.idField:function(){return this[f.idField]||null},b.core.isFunction(e)||(e=function(b){var c,d,e,f,h,i,j;if(c=this.children(".day-container"),d=c.children(".schedule-list"),0!==d.length){for(e=d.data("schedule-items"),f=-1,h=0,i=e.length;h<i;h++)if(j=e[h],g.call(j)===g.call(b)){f=h;break}f>-1&&(a(d.children()[f]).remove(),e.splice(f,1))}}),this._updateSchedules(c,d,e)},clearSchedules:function(a){var c,d,e;for(e=new Date(this.year,this.month+1,0).getDate(),b.core.isFunction(a)||(a=function(){var a,b;a=this.children(".day-container"),b=a.children(".schedule-list"),b.removeData("schedule-items"),b.remove()}),d=1;d<=e;d++)c=this._getCellByDate(new Date(this.year,this.month,d)),a.call(c)},isMultiple:function(){return!!this.calendar.option.monthMultipleSelect},getSelection:k.prototype.getSelection,setSelection:function(a){var c,d,e,f;for(Array.isArray(a)||(a=[a]),e=0,f=a.length;e<f;e++)if(c=a[e],c instanceof Date){if(c.getFullYear()!==this.year||c.getMonth()!==this.month)throw new Error(b.str.textFormat("the date({0}) does not belong to {1}-{2}",b.str.dateFormat(c,"yyyy-MM-dd"),this.year,this.month));d=this._getCellByDate(c),this._selectItem(d)}},cancelSelection:k.prototype.cancelSelection,setSize:function(a,b){this._setCellSize(a,b)},getTitle:function(){return this.year+"年"+(this.month+1)+"月"},toString:function(){return"ui.ctrls.CalendarView.MonthView"}},m.prototype={constructor:m,initialize:function(b){this.calendar=b,this.startDate=null,this.endDate=null,this.year=null,this.month=null,this.todayIndex=-1,this.weekDays=null,this.weekHours=[],this.initialled=!1,this.width=null,this.height=null,this.singleSelect=!!this.calendar.option.weekSingleSelect,this.viewPanel=a("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this._formatDayText=this.calendar.option.formatWeekDayHead,b.core.isFunction(this._formatDayText)||(this._formatDayText=f),this.onWeekHeadItemClickHandler=i.bind(this),this.weekDays=this.calendar.getWeek(this.calendar.currentDate),this._setCurrent(),this.weekDayPanel=a("<div class='ui-calendar-week-view' />"),this._createWeek(),this.hourPanel=a("<div class='ui-calendar-hour-panel' />"),this._createHourName(),this._createHour(),this._setTodayStyle(),this.viewPanel.append(this.weekDayPanel).append(this.hourPanel),this.selector=o(this,this.hourPanel,this.hourTable),this.selector.getDateByIndex=function(a){return this.view.weekDays[a]},this.hourAnimator=b.animator(this.hourPanel,{ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.scrollTop(a)}}),this.hourAnimator.duration=800,this.initialled=!0)},_setCurrent:function(){var a=this.weekDays[0];this.startDate=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),a=this.weekDays[6],this.endDate=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59),this.year=a.getFullYear(),this.month=a.getMonth()},_createWeek:function(){var b,c,d,e,f,g;for(this.weekTable=a("<table class='ui-calendar-weekday unselectable' cellspacing='0' cellpadding='0' />"),b=a("<thead />"),c=a("<colgroup />"),d=a("<tr />"),f=0;f<7;f++)g=this.weekDays[f],c.append("<col />"),e=a("<th class='weekday-cell' />"),e.text(this._formatDayText(g)),d.append(e);b.append(d),this.weekTable.append(c).append(b),this.weekDayPanel.append(this.weekTable),this.weekTable.click(this.onWeekHeadItemClickHandler)},_createHourName:function(){var b,c,d,e,f,g,h,i;for(this.hourNames=a("<div class='hour-name-panel' />"),b=a("<table class='hour-name-table unselectable' cellspacing='0' cellpadding='0' />"),c=a("<colgroup />"),c.append("<col style='width:0px;' />").append("<col />"),b.append(c),d=a("<tbody />"),i=this.calendar._getTimeCellCount(),g=0;g<24;g++)for(h=0;h<i;h++)e=a("<tr />"),f=a("<td class='hour-name-cell' />"),(h+1)%i&&f.addClass("hour-name-cell-odd"),e.append(f),0===h&&(f=a("<td class='hour-name-cell' rowspan='"+i+"' />"),f.append("<h3 class='hour-name-text'>"+g+"</h3>"),e.append(f)),d.append(e);b.append(d),this.hourNames.append(b),this.hourPanel.append(this.hourNames)},_createHour:function(){var b,c,d,e,f,g,h,i;for(this.weekHour=a("<div class='week-hour-panel' />"),this.hourTable=a("<table class='week-hour-table unselectable' cellspacing='0' cellpadding='0' />"),b=a("<tbody />"),c=a("<colgroup />"),f=0;f<7;f++)c.append("<col />");for(i=this.calendar._getTimeCellCount(),g=24*i,f=0;f<g;f++){for(d=a("<tr />"),h=0;h<7;h++)e=a("<td class='week-hour-cell' />"),this.calendar.isWeekend(h)&&e.addClass("week-hour-cell-weekend"),(f+1)%i&&e.addClass("week-hour-cell-odd"),d.append(e);b.append(d)}this.hourTable.append(c).append(b),this.weekHour.append(this.hourTable),this.hourPanel.append(this.weekHour)},_setTodayStyle:function(){var b,c,d,e,f,g;for(b=new Date,this.todayIndex=-1,f=0;f<7;f++)if(c=this.weekDays[f],c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()){this.todayIndex=f;break}if(!(this.todayIndex<0))for(d=this.hourTable[0],f=0,g=d.rows.length;f<g;f++)e=d.rows[f],a(e.cells[this.todayIndex]).addClass("week-hour-cell-today")},_clearTodayStyle:function(){var b,c,d,e,f;for(b=this.hourTable[0].tBodies[0].rows,d=-1,e=0,f=b[0].cells.length;e<f;e++)if(c=a(b[0].cells[e]),c.hasClass("week-hour-cell-today")){d=e;break}if(!(d<0))for(e=0,f=b.length;e<f;e++)c=a(b[e].cells[d]),c.removeClass("week-hour-cell-today")},_setCellSize:function(a,c){var d,e,f,g,h=0;a&&c&&(this.width===a&&this.height===c||(this.width=a,this.height=c,c<this.hourPanel[0].scrollHeight&&(h=b.scrollbarWidth),d=a-r-h,e=Math.floor(d/7),e<95&&(e=95),f=this.weekTable.find("col"),g=this.hourTable.find("col"),this.weekTable.css("width",7*e+"px"),this.hourTable.css("width",7*e+"px"),f.css("width",e+"px"),g.css("width",e+"px"),this.selector.cellWidth>1&&this._restoreSchedules(e-this.selector.cellWidth),this.selector.cellWidth=e,this.selector.cancelSelection()))},_updateWeek:function(){var b,c,d,e;for(b=this.weekTable[0].tHead.rows[0],e=0;e<7;e++)d=this.weekDays[e],c=a(b.cells[e]),c.text(this._formatDayText(d)),c.attr("class","weekday-cell")},_addScheduleItem:function(c,d,e,f,g){var h,i,j,k,l;h=a("<div class='schedule-item-panel' />"),i=a("<div class='time-title' />"),i.html("<span class='time-title-text'>"+g+"</span>"),j=a("<div class='schedule-container' />"),h.append(i).append(j),k=this._getPositionAndSize(c),l=this._getPositionAndSize(d),h.css({top:k.top+"px",left:k.left+"px",width:k.width+"px",height:l.height+l.top-k.top+"px"}),a(this.hourPanel).append(h),f.itemPanel=h,this._setScheduleInfo(f.columnIndex,f),b.core.isFunction(e)&&e.call(this,f,j)},_findSchedules:function(a,c){var d,f,g,h,i,j,k;for(k=b.core.isFunction(c),d=0;d<a.length;d++)if(g=a[d],g instanceof Date&&(h=this.calendar.getWeekIndexOf(g),i=this.calendar.timeToIndex(e(g)),j=this._getScheduleInfo(h)))for(f=j.length-1;f>=0;f--)i===j[f].beginRowIndex&&k&&c.call(this,j[f],f,j)},_restoreSchedules:function(a){var b,c,d,e,f,g,h;for(e=0;e<this.weekHours.length;e++)if(g=this.weekHours[e])for(f=0;f<g.length;f++)h=g[f].itemPanel,b=g[f].weekIndex,c=parseFloat(h.css("left")),d=parseFloat(h.css("width")),h.css({left:c+b*val+"px",width:d+val+"px"})},_setScheduleInfo:function(a,b){var c=this.weekHours[a];c||(c=[],this.weekHours[a]=c),b.weekIndex=a,c.push(b)},_getScheduleInfo:function(a){var b=this.weekHours[a];return b?b:null},_changeWeek:function(){this.calendar.currentDate=this.weekDays[0],this._setCurrent(),this.clearSchedules(),this.selector.cancelSelection(),this._updateWeek(),this._clearTodayStyle(),this._setTodayStyle()},_getUnitHourNameHeight:function(){var b;return this.hourNames?(b=this.hourNames.children("table")[0],a(b.tBodies[0].rows[0].cells[1]).outerHeight()/this.calendar._getTimeCellCount()):s},_getPositionAndSize:function(a){var b=a.position();return b.left=b.left+r,b.top=b.top,{top:b.top,left:b.left,width:a.outerWidth()-1,height:a.outerHeight()-1}},checkChange:function(){var a=this.calendar.currentDate;return this.calendar.showTimeLine(this.hourPanel,this._getUnitHourNameHeight()),!(a>=this.startDate&&a<=this.endDate)&&(this.weekDays=this.calendar.getWeek(a),this._changeWeek(),!0)},active:function(){this.selector.active()},dormant:function(){this.selector.dormant()},previous:function(){var a=this.calendar.currentDate;this.weekDays=this.calendar.getWeek(new Date(a.getFullYear(),a.getMonth(),a.getDate()-7)),this._changeWeek()},next:function(){var a=this.calendar.currentDate;this.weekDays=this.calendar.getWeek(new Date(a.getFullYear(),a.getMonth(),a.getDate()+7)),this._changeWeek()},today:function(a){a&&a instanceof Date||(a=new Date),this.weekDays=this.calendar.getWeek(a),this._changeWeek()},setBeginTime:function(a){var b,c,d,e,f,g,h;b=this.hourPanel.height(),c=this.hourPanel[0].scrollHeight,b>=c||(this.hourAnimator.stop(),d=this.calendar.timeToIndex(a),e=this.calendar._getTimeCellCount(),d>e&&(d-=e),f=c-b,g=d*s,g>f&&(g=f),h=this.hourAnimator[0],h.begin=this.hourPanel.scrollTop(),h.end=g,this.hourAnimator.start())},addSchedules:function(c,d,f,g,h){var i,j,k,l,m,n,o,p;if(Array.isArray(c))for(i=b.core.isFunction(d)?d:function(){return this[d+""]||null},j=b.core.isFunction(f)?f:function(){return this[f+""]||null},b.core.isFunction(h)||(h=function(a){return this.calendar.getWeekIndexOf(a)}),n=0,o=c.length;n<o;n++)p=c[n],k={data:p},k.beginDate=i.call(p),k.endDate=j.call(p),k.beginDate instanceof Date&&k.endDate instanceof Date&&(k.columnIndex=h.call(this,k.beginDate),l=e(k.beginDate),m=e(k.endDate,k.beginDate),k.beginRowIndex=this.calendar.timeToIndex(l),k.endRowIndex=this.calendar.timeToIndex(m)-1,this._addScheduleItem(a(this.hourTable[0].rows[k.beginRowIndex].cells[k.columnIndex]),a(this.hourTable[0].rows[k.endRowIndex].cells[k.columnIndex]),g,k,l.substring(0,5)+" - "+m.substring(0,5)))},removeSchedules:function(a){this._findSchedules(a,function(a,b,c){a.itemPanel.remove(),c.splice(b,1)})},findSchedules:function(a,c,d){var e;a instanceof Date&&(a=[a]),Array.isArray(a)&&(d||(d=this),e=b.core.isFunction(c)?function(){c.apply(d,arguments)}:null,this._findSchedules(a,e))},clearSchedules:function(){var a,b,c;for(a=0;a<this.weekHours.length;a++)if(c=this.weekHours[a])for(b=0;b<c.length;b++)c[b].itemPanel.remove();this.weekHours=[]},hasSchedule:function(a){var b=this.weekHours[a];return!!b&&b.length>0},getSelection:function(){var a,b,c,d,e,f;if(f=[],a=this.selector.getSelection(),!a)return f;for(b=this.weekDays[a.weekIndex],d=0,e=a.timeArray.length;d<e;d++)c=a.timeArray[d],f.push(new Date(b.getFullYear(),b.getMonth(),b.getDate(),c.hours,c.minutes,c.seconds));return f},setSelection:function(a,c){var d,e,f,g,h,i;if(a instanceof Date&&c instanceof Date){for(d=-1,g=0,h=this.weekDays.length;g<h;g++)if(i=this.weekDays[g],i.getFullYear()==a.getFullYear()&&i.getMonth()==a.getMonth()&&i.getDate()==a.getDate()){d=g;break}d<0||(e=b.str.dateFormat(a,"hh:mm:ss"),f=b.str.dateFormat(c,"hh:mm:ss"),this.selector.setSelectionByTime(d,e,f))}},cancelSelection:function(){this.selector.cancelSelection()},setSize:function(a,b){this.hourPanel.css("height",b-s+"px"),this._setCellSize(a,b)},getTitle:function(){return b.str.textFormat("{0}年{1}月{2}日 ~ {3}年{4}月{5}日",this.startDate.getFullYear(),this.startDate.getMonth()+1,this.startDate.getDate(),this.endDate.getFullYear(),this.endDate.getMonth()+1,this.endDate.getDate())},toString:function(){return"ui.ctrls.CalendarView.WeekView"}},n.prototype={constructor:n,initialize:function(b){this.calendar=b,this.year=null,this.month=null,this.day=null,this.dayHours=[],this.initialled=!1,this.width=null,this.height=null,this.singleSelect=!!this.calendar.option.daySingleSelect,this.viewPanel=a("<div class='calendar-view-panel' />"),this.calendar.element.append(this.viewPanel)},render:function(){this.initialled||(this._formatDayText=this.calendar.option.formatDayHead,b.core.isFunction(this._formatDayText)||(this._formatDayText=f),this.onDayHeadItemClickHandler=j.bind(this),this._setCurrent(),this.dayPanel=a("<div class='ui-calendar-day-view' />"),this._createDay(),this.hourPanel=a("<div class='ui-calendar-hour-panel' />"),this._createHourName(),this._createHour(),this.viewPanel.append(this.dayPanel).append(this.hourPanel),this.selector=o(this,this.hourPanel,this.hourTable),this.selector.getDateByIndex=function(a){return new Date(this.view.year,this.view.month,this.view.day)},this.hourAnimator=b.animator(this.hourPanel,{ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.scrollTop(a)}}),this.hourAnimator.duration=800,this.initialled=!0)},_setCurrent:function(){var a=this.calendar.currentDate;this.year=a.getFullYear(),this.month=a.getMonth(),this.day=a.getDate()},_createDay:function(){this.dayTitle=a("<div class='ui-calendar-day-title' />"),this.dayTitle.html("<span class='ui-calendar-day-title-text'>"+this._formatDayText(this.calendar.currentDate)+"</span>"),this.dayPanel.append(this.dayTitle),this.dayTitle.click(this.onDayHeadItemClickHandler)},_createHourName:m.prototype._createHourName,_createHour:function(){var b,c,d,e,f,g;for(this.weekHour=a("<div class='week-hour-panel' />"),this.hourTable=a("<table class='week-hour-table unselectable' cellspacing='0' cellpadding='0' />"),b=a("<tbody />"),e=this.calendar._getTimeCellCount(),g=24*e,f,f=0;f<g;f++)c=a("<tr />"),d=a("<td class='week-hour-cell' style='width:100%' />"),(f+1)%e&&d.addClass("week-hour-cell-odd"),c.append(d),b.append(c);this.hourTable.append(b),this.weekHour.append(this.hourTable),this.hourPanel.append(this.weekHour)},_setCellSize:function(a,c){var d,e=0;a&&c&&(this.width===a&&this.height===c||(this.width=a,this.height=c,c<this.hourPanel[0].scrollHeight&&(e=b.scrollbarWidth),d=a-r-e-2,this.dayTitle.css("width",d+"px"),this.hourTable.css("width",d+"px"),this.selector.cellWidth>1&&this._restoreSchedules(d-this.selector.cellWidth),this.selector.cellWidth=d,this.selector.cancelSelection()))},_addScheduleItem:m.prototype._addScheduleItem,_restoreSchedules:function(a){var b,c,d,e,f;for(e=0;e<this.dayHours.length;e++)f=this.dayHours[e].itemPanel,b=this.dayHours[e].weekIndex,c=parseFloat(f.css("left")),d=parseFloat(f.css("width")),f.css({left:c+b*val+"px",width:d+val+"px"})},_setScheduleInfo:function(a,b){this.dayHours.push(b)},_getScheduleInfo:function(a){return this.dayHours},_changeDay:function(){this._setCurrent(),this.clearSchedules(),this.selector.cancelSelection(),this.dayTitle.html("<span class='ui-calendar-day-title-text'>"+this._formatDayText(this.calendar.currentDate)+"</span>")},_getUnitHourNameHeight:m.prototype._getUnitHourNameHeight,_getPositionAndSize:m.prototype._getPositionAndSize,checkChange:function(){var a=this.calendar.currentDate;return this.calendar.showTimeLine(this.hourPanel,this._getUnitHourNameHeight()),(this.year!=a.getFullYear()||this.month!=a.getMonth()||this.day!=a.getDate())&&(this._changeDay(),!0)},active:function(){this.selector.active()},dormant:function(){this.selector.dormant()},previous:function(){var a=this.calendar.currentDate;this.calendar.currentDate=new Date(a.setDate(a.getDate()-1)),this._changeDay()},next:function(){var a=this.calendar.currentDate;this.calendar.currentDate=new Date(a.setDate(a.getDate()+1)),this._changeDay()},today:function(a){a&&a instanceof Date||(a=new Date),this.calendar.currentDate=new Date(a.getTime()),this._changeDay()},setBeginTime:m.prototype.setBeginTime,addSchedules:function(a,b,c,d,e){m.prototype.addSchedules.call(this,a,b,c,d,function(){return 0})},clearSchedules:function(){for(var a=0;a<this.dayHours.length;a++)this.dayHours[a].itemPanel.remove();this.dayHours=[]},hasSchedule:function(){return this.dayHours.length>0},getSelection:function(){var a,b,c,d,e,f;if(f=[],a=this.selector.getSelection(),!a)return f;for(b=new Date(this.year,this.month,this.day),d=0,e=a.timeArray.length;d<e;d++)c=a.timeArray[d],f.push(new Date(b.getFullYear(),b.getMonth(),b.getDate(),c.hours,c.minutes,c.seconds));return f},setSelection:function(a,c){var d,e;a instanceof Date&&c instanceof Date&&(d=b.str.dateFormat(a,"hh:mm:ss"),e=b.str.dateFormat(c,"hh:mm:ss"),this.selector.setSelectionByTime(0,d,e))},cancelSelection:function(){this.selector.cancelSelection()},setSize:function(a,b){this.hourPanel.css("height",b-s+"px"),this._setCellSize(a,b)},getTitle:function(){return b.str.textFormat("{0}年{1}月{2}日",this.year,this.month+1,this.day)},toString:function(){return"ui.ctrls.CalendarView.DayView"}},o.prototype={constructor:o,initialize:function(b,c,d){this.view=b,this.panel=c,this.grid=d,this.cellWidth=1,this.cellHeight=25,this.grid[0].onselectstart=function(){return!1},this.selectionBox=a("<div class='ui-calendar-selector unselectable click-enabled border-highlight' />"),this.selectionBox.boxTextSpan=a("<span class='ui-calendar-selector-time click-enabled' />"),this.selectionBox.append(this.selectionBox.boxTextSpan),this.panel.append(this.selectionBox),this._initEvents(),this._initAnimator()},_initEvents:function(){this.mouseLeftButtonDownHandler=function(b){1===b.which&&(a(document).on("mousemove",this.mouseMoveHandler),a(document).on("mouseup",this.mouseLeftButtonUpHandler),this.onMouseDown(a(b.target),b.clientX,b.clientY)&&(this._isBeginSelect=!0))}.bind(this),this.mouseMoveHandler=function(a){this._isBeginSelect&&this.onMouseMove(a)}.bind(this),this.mouseLeftButtonUpHandler=function(b){1===b.which&&this._isBeginSelect&&(this._isBeginSelect=!1,a(document).off("mousemove",this.mouseMoveHandler),a(document).off("mouseup",this.mouseLeftButtonUpHandler),this.onMouseUp(b))}.bind(this)},_initAnimator:function(){var a=this;this.selectAnimator=b.animator(this.selectionBox,{ease:b.AnimationStyle.swing,onChange:function(b,c){"up"!==a._selectDirection&&c.css("top",b+"px")}}).addTarget(this.selectionBox,{ease:b.AnimationStyle.swing,onChange:function(a,b){b.css("left",a+"px")}}).addTarget(this.selectionBox,{ease:b.AnimationStyle.swing,onChange:function(a,b){b.css("width",a+"px")}}).addTarget(this.selectionBox,{ease:b.AnimationStyle.swing,onChange:function(b,c){a._selectDirection||c.css("height",b+"px")}}),this.selectAnimator.onEnd=function(){a._isNotCompletedYet&&(a._isNotCompletedYet=!1,a.onSelectCompleted())},this.selectAnimator.duration=200,this.selectAnimator.fps=60},_getSelectedCells:function(){var c,d,e,f,g,h,i,j,k,l,m,n,o=[],p=this.selectionBox;if("none"===p.css("display"))return o;if(c=p.text().split("-"),d=b.str.trim(c[0]||""),e=b.str.trim(c[1]||""),!d||!e)return o;for(d=this.view.calendar.timeToIndex(d),e=this.view.calendar.timeToIndex(e)-1,f=parseFloat(p.css("border-top-width")),g=d*this.cellHeight+1,h=parseFloat(p.css("left"))+f+1,i=this._getCellByPoint(h,g),o.push(i),j=e-d+1,k=this.grid[0],n=1;n<j;n++)l=k.rows[n+i.hourIndex],m=a(l.cells[i.weekIndex]),m.hourIndex=n+i.hourIndex,m.weekIndex=i.weekIndex,o.push(m);return o},_getCellByPoint:function(b,c){var d,e,f,g,h,i;return d=Math.ceil(b/this.cellWidth),e=Math.ceil(c/this.cellHeight),f=24*this.view.calendar._getTimeCellCount(),d<1&&(d=1),d>7&&(d=7),e<1&&(e=1),e>f&&(e=f),e--,d--,g=this.grid[0],h=g.rows[e],i=a(h.cells[d]),i.hourIndex=e,i.weekIndex=d,i},_selectCell:function(a){var b,c,d,e,f;if(b=this.selectionBox,c=this._getPositionAndSize(a),d=a.hourIndex,e=a.hourIndex+1,arguments.length>1&&arguments[1]){e=arguments[1].hourIndex+1;var g=this._getPositionAndSize(arguments[1]);c.height=g.top+g.height-c.top}this._selectDirection=null,this.selectAnimator.stop(),f=this.selectAnimator[0],f.begin=parseFloat(f.target.css("top")),f.end=c.top,f=this.selectAnimator[1],f.begin=parseFloat(f.target.css("left")),f.end=c.left,f=this.selectAnimator[2],f.begin=parseFloat(f.target.css("width")),f.end=c.width,f=this.selectAnimator[3],f.begin=parseFloat(f.target.css("height")),f.end=c.height,b.css("display","block"),this._isNotCompletedYet=!1,this.selectAnimator.start(),this._beginTime=this.view.calendar.indexToTime(d),this._endTime=this.view.calendar.indexToTime(e),b.boxTextSpan.text(this._beginTime+" - "+this._endTime)},_autoScrollY:function(a,b){var c,d;c=this.panel.scrollTop(),"up"===b?a<c&&this.panel.scrollTop(c<this.cellHeight?0:c-this.cellHeight):"down"===b&&(d=c+this.panel.height(),a>d&&this.panel.scrollTop(c+this.cellHeight))},_isClickInGrid:function(a,c){var d,e,f,g,h,i,j;return d=this.panel.offset(),e=d.left+r,f=d.top,i=this.grid.width(),j=this.panel.height(),g=e+i-1,h=f+j,j<this.panel[0].scrollHeight&&(g-=b.scrollbarWidth),a>=e&&a<=g&&c>=f&&c<=h},_changeToGridPoint:function(a,b){var c=this.panel.offset();return c.left=c.left+r,{gridX:a-c.left+this.panel.scrollLeft(),gridY:b-c.top+this.panel.scrollTop()}},_getPositionAndSize:function(a){var b=a.position();return b.left=b.left+r,{top:b.top-2,left:b.left-2,width:a.outerWidth()-1,height:a.outerHeight()-1}},onMouseDown:function(a,b,c){var d,e,f;if(!this._isClickInGrid(b,c))return void(this._clickInGrid=!1);if(this._clickInGrid=!0,e=this._changeToGridPoint(b,c),"TD"!=a.nodeName()){if(!a.hasClass("click-enabled"))return;d=this._getCellByPoint(e.gridX,e.gridY)}else d=a,d.weekIndex=d[0].cellIndex,d.hourIndex=d.parent()[0].rowIndex;return f={view:this.view,element:this.selectionBox,weekIndex:d.weekIndex,hourIndex:d.hourIndex,originElement:null},this.view.calendar.fire("selecting",f)!==!1?(this._startCell=d,this._selectCell(d),this.checkSelectable(d),this.focusX=e.gridX,this.focusY=e.gridY,!0):void 0},onMouseMove:function(a){var b,c,d,e,f,g,h;b=this._changeToGridPoint(a.clientX,a.clientY),c=this._getCellByPoint(this.focusX,b.gridY),d=this._getPositionAndSize(c),e=this._getPositionAndSize(this._startCell),c.hourIndex<this.selectableMin||c.hourIndex>this.selectableMax||(f=this.selectionBox,b.gridY>this.focusY?(g=this._startCell,h=c,f.css({height:d.top+d.height-e.top+"px"}),this._selectDirection="down",this._autoScrollY(d.top+d.height,this._selectDirection)):(g=c,h=this._startCell,f.css({top:d.top+"px",height:e.top+e.height-d.top+"px"}),this._selectDirection="up",this._autoScrollY(d.top,this._selectDirection)),this._beginTime=this.view.calendar.indexToTime(g.hourIndex),this._endTime=this.view.calendar.indexToTime(h.hourIndex+1),f.boxTextSpan.text(this._beginTime+" - "+this._endTime))},onMouseUp:function(a){this._clickInGrid&&(this.selectAnimator.isStarted?this._isNotCompletedYet=!0:this.onSelectCompleted())},onSelectCompleted:function(){var a,b,c,d,e,f,g,h;a=arguments.length>0&&arguments[0]?arguments[0]:this.selectionBox,b=this.getDateByIndex(this._startCell.weekIndex),c=this._beginTime.split(":"),d=parseInt(c[0],10),e=parseInt(c[1],10),c=this._endTime.split(":"),f=parseInt(c[0],10),g=parseInt(c[1],10),this._startCell=null,this._beginTime=null,this._endTime=null,h=this,setTimeout(function(){var c={view:h.view,beginTime:new Date(b.getFullYear(),b.getMonth(),b.getDate(),d,e,0),endTime:new Date(b.getFullYear(),b.getMonth(),b.getDate(),f,g,0),element:a,originElement:null,top:parseFloat(a.css("top")),left:parseFloat(a.css("left")),parentWidth:h.view.viewPanel.width()-r,parentHeight:h.view.hourTable.outerHeight()};h.view.calendar.fire("selected",c)},50)},checkSelectable:function(a){var b,c,d,e,f,g;if(b=this.view.calendar._getTimeCellCount(),this.selectableMin=0,this.selectableMax=24*b-1,this.view.singleSelect){if(c=this.view._getScheduleInfo(a.weekIndex),d=-1,e=24*b,c)for(g=0;g<c.length;g++)f=c[g],f.beginRowIndex<a.hourIndex?f.beginRowIndex>d&&(d=f.beginRowIndex):f.beginRowIndex<e&&(e=f.beginRowIndex),
f.endRowIndex<a.hourIndex?f.endRowIndex>d&&(d=f.endRowIndex):f.endRowIndex<e&&(e=f.endRowIndex);this.selectableMin=d+1,this.selectableMax=e-1}},getSelection:function(){var a,b,c,d,e,f;if(b=this._getSelectedCells(),0===b.length)return null;for(a={weekIndex:null,timeArray:[]},c=this.view.calendar._getTimeCellCount(),d=function(a){var b,d;return b=Math.floor(a/c),d=60*(a/c-b),{hours:b,minutes:d,seconds:0}},a.weekIndex=b[0].weekIndex,a.timeArray.push(d(b[0].hourIndex)),e=0,f=b.length;e<f;e++)a.timeArray.push(d(b[e].hourIndex+1));return a},setSelectionByTime:function(a,b,c){var d,e,f,g,h;d=(a+1)*this.cellWidth-1,e=(this.view.calendar.timeToIndex(b)+1)*this.cellHeight-1,f=this.view.calendar.timeToIndex(c)*this.cellHeight-1,g=this._getCellByPoint(d,e),h=this._getCellByPoint(d,f),this.focusX=d,this.focusY=e,this.view.setBeginTime(b),this._startCell=g,this._selectCell(g,h)},cancelSelection:function(){var a=this.selectionBox;a.css("display","none"),this._startCell=null,this.focusX=0,this.focusY=0,this.view.calendar.fire("deselected",{view:this.view,element:a})},active:function(b){b||this.selectionBox.css("display","none"),a(document).on("mousedown",this.mouseLeftButtonDownHandler)},dormant:function(b){b||this.cancelSelection(),a(document).off("mousedown",this.mouseLeftButtonDownHandler)}},q={YEARVIEW:k,MONTHVIEW:l,WEEKVIEW:m,DAYVIEW:n},b.define("ui.ctrls.CalendarView",{_defineOption:function(){return{views:["YearView","MonthView","WeekView","DayView"],defaultView:"WeekView",unitTime:30,sundayFirst:!1,startDate:null,yearMultipleSelect:!1,monthMultipleSelect:!1,weekSingleSelect:!1,daySingleSelect:!1,formatWeekDayHead:null,formatDayHead:null}},_defineEvents:function(){return["viewChanging","viewChanged","changing","changed","selecting","selected","deselected","weekTitleClick","cancel"]},_create:function(){var a;b.core.isNumber(this.option.unitTime)?(a=60/this.option.unitTime,a%2&&(a-=1,this.option.unitTime=60/a)):this.option.unitTime=30,this.views={},b.core.isString(this.option.defaultView)&&0!==this.option.defaultView.length||(this.option.defaultView="WeekView"),this.option.startDate instanceof Date?this.currentDate=this.option.startDate:this.currentDate=new Date,this.viewChangeAnimator=b.animator({ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}),this.viewChangeAnimator.addTarget({ease:b.AnimationStyle.easeFrom,onChange:function(a,b){b.css("opacity",a/100)}}),this.viewChangeAnimator.duration=500},_render:function(){var a,c,d,e;for(this.element.addClass("ui-calendar-view").css("position","relative"),a=0,c=this.option.views.length;a<c;a++)d=this.option.views[a],b.core.isString(d)&&(d=d.toUpperCase(),q.hasOwnProperty(d)&&(this.views[d]=q[d](this)));if(!this.hasView(this.option.defaultView))for(a in this.views)if(this.views.hasOwnProperty(a)){this.option.defaultView=a;break}e=this,setTimeout(function(){e.changeView(e.option.defaultView,!1)})},_getTimeCellCount:function(){return Math.floor(60/this.option.unitTime)||1},_timeToCellNumber:function(a){var b,c,d,e,f;return b=a.split(":"),c=this._getTimeCellCount(),d=parseInt(b[0],10),e=parseInt(b[1],10),f=parseInt(b[2],10),(d+e/60)*c},_doChange:function(a){this.fire("changing",this.currentView,a)!==!1&&(this.currentView[a].call(this.currentView),this.fire("changed",this.currentView,a))},isSundayFirst:function(){return!!this.option.sundayFirst},getWeek:function(a){var b,c,d,e,f=null;if(a instanceof Date)for(a=new Date(a.getTime()),f=[],e=7,this.isSundayFirst()?(b=a.getDay(),a.setDate(a.getDate()-b)):(b=a.getDay()||e,a.setDate(a.getDate()-b+1)),c=new Date(a.getTime()),f.push(c),d=1;d<e;d++)f.push(new Date(a.setDate(a.getDate()+1)));return f},getWeekStartEnd:function(a){var b,c=null;a instanceof Date&&(a=new Date(a.getTime()),c={year:a.getFullYear(),month:a.getMonth()+1},this.isSundayFirst()?(b=a.getDay(),a.setDate(a.getDate()-b)):(b=a.getDay()||7,a.setDate(a.getDate()-b+1)),c.weekStartDate=new Date(a.getTime()),c.weekStartDay=c.weekStartDate.getDate(),c.weekEndDate=new Date(a.setDate(a.getDate()+6)),c.weekEndDay=c.weekEndDate.getDate())},getWeekIndexOf:function(a){var b=null;return a instanceof Date&&(b=a.getDay(),this.isSundayFirst()||(0===b?b=6:b--)),b},getWeekendIndexes:function(){var a={saturday:6,sunday:0};return this.isSundayFirst()||(a.saturday=5,a.sunday=6),a},isWeekend:function(a){return this.isSundayFirst()?6===a||0===a:5===a||6===a},getTableIndexOf:function(a){var b,c,d,e=null;return a instanceof Date&&(b=new Date(a.getFullYear(),a.getMonth(),1),c=this.getWeekIndexOf(b),d=a.getDate()+c-1,e={rowIndex:Math.floor(d/7),cellIndex:0},e.cellIndex=d-7*e.rowIndex),e},getWeekNames:function(){return this.isSundayFirst()?u:v},indexToTime:function(a){var b,c,e,f;return b=this._getTimeCellCount(),c=d(a/b),e=c.split("."),f=e[0]+":",f+=e.length>1?d(60*parseFloat("0."+e[1])):"00"},timeToIndex:function(a){return a||(a="00:00"),Math.ceil(this._timeToCellNumber(a))},timeToPosition:function(a,b){return a||(a="00:00"),this._timeToCellNumber(a)*b},showTimeLine:function(b,c){var d,f,g;this.currentTimeElement?this.currentTimeElement.css("display","block"):(this.currentTimeElement=a("<div class='ui-current-time border-highlight font-highlight' />"),this.currentTimeElement.css("width",r+"px"),this.element.append(this.currentTimeElement)),this._timeoutHandler&&(clearTimeout(this._timeoutHandler),this._timeoutHandler=null),b.append(this.currentTimeElement),d=3e4,g=this,f=function(){var a,b,h,i;a=e(new Date),b=g.timeToIndex(a),h=g.timeToPosition(a,c),i=g.currentTimeElement,i.html("<span class='ui-current-time-text'>"+a.substring(0,5)+"</span>"),b<=1?i.addClass("ui-current-time-top").css("top",h+"px"):i.removeClass("ui-current-time-top").css("top",h-t+"px"),g._timeoutHandler=setTimeout(f,d)},this._timeoutHandler=setTimeout(f)},hideTimeLine:function(){this._timeoutHandler&&clearTimeout(this._timeoutHandler),this.currentTimeElement&&this.currentTimeElement.css("display","none")},previous:function(){this._doChange("previous")},next:function(){this._doChange("next")},today:function(){this._doChange("today")},hasView:function(a){return this.views.hasOwnProperty((a+"").toUpperCase())},isView:function(a,b){return!!a&&(b=(b+"").toUpperCase(),a.toString().toUpperCase().lastIndexOf(b)!==-1)},getView:function(a){return a=(a+"").toUpperCase(),this.views.hasOwnProperty(a)?this.views[a]:null},changeView:function(a,c){var d,e,f,g,h,i,j;if(d=this.views[(a+"").toUpperCase()],!d)throw new Error(b.str.textFormat("没有注册名为{0}的视图",a));if(this.fire("viewChanging",this.currentView,d)!==!1){if(this.currentView&&(this.viewChangeAnimator.stop(),this.currentView.viewPanel.css({display:"none",opacity:0}),this.currentView.dormant(),this.currentView=null),this.currentView=d,g=this.element.width(),this.currentView.viewPanel.css({display:"block",left:g/3+"px"}),e=!1,d.initialled||(d.render(),e=!0),f=d.checkChange(),d.setSize(this.element.width(),this.element.height()),h=this,j=function(){h.currentView.active(),h.fire("viewChanged",h.currentView),(e||f)&&h.fire("changed",h.currentView)},c===!1)return this.currentView.viewPanel.css({display:"block",left:"0",opacity:1}),void j();i=this.viewChangeAnimator[0],i.target=this.currentView.viewPanel,i.begin=g/3,i.end=0,i=this.viewChangeAnimator[1],i.target=this.currentView.viewPanel,i.begin=0,i.end=100,this.viewChangeAnimator.onEnd=j,this.viewChangeAnimator.start()}},setSize:function(a,b){this.element.css("height",b+"px"),this.currentView&&this.currentView.setSize(a,b)},getTitle:function(){return this.currentView?this.currentView.getTitle():""}}),a.fn.calendarView=function(a){return 0===this.length?null:(x||p(),b.ctrls.CalendarView(a,this))};var w,x=!1;b.page.hlchanged(function(a,b){p(b)})}(jQuery,ui),function(a,b){"use strict";function c(){}function d(a){var d;if(d=b.core.type(a),"string"===d)this.option.group={groupField:a,itemsField:"_items",groupListHandler:e,headFormatter:f,headRearrangeHandler:g};else if("object"===d){if(b.core.isFunction(a.groupListHandler)||(a.groupListHandler=e),!a.groupField)throw new TypeError("the groupField can not be null or empty.");a.itemsField||(a.itemsField="_items"),b.core.isFunction(a.headFormatter)||(a.headFormatter=f),b.core.isFunction(a.headRearrangeHandler)||(a.headRearrangeHandler=c)}else this.option.group=!1}function e(a,c,d){var e=b.trans.listToGroup(a,c,null,d);return e}function f(a,c){return b.str.textFormat("<span style='margin-left:{0}px;margin-right:{0}px' class='item-head-title font-highlight'>{1}</span>",c,a[this.option.group.groupField])}function g(a,b,c,d){var e=a.children(".item-head-title");e.css({"margin-left":d+"px","margin-right":d+"px"}),0===b&&a.css("margin-top",d+"px")}function h(a){a.showPageInfo===!0&&(a.pageInfoFormatter||(a.pageInfoFormatter={currentRowNum:function(a){return"<span>本页"+a+"项</span>"},rowCount:function(a){return"<span class='font-highlight'>共"+a+"项</span>"},pageCount:function(a){return"<span>"+a+"页</span>"}})),this.pager=b.ctrls.Pager(a),this.pageIndex=this.pager.pageIndex,this.pageSize=this.pager.pageSize}function i(b){for(var c=a(b.target);!c.hasClass("view-item");){if(c.hasClass("ui-card-view-body"))return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),this._selectItem(c)}var j="ui-card-view-selection",k=30,l=4,m=4;b.define("ui.ctrls.CardView",{_defineOption:function(){return{viewData:null,promptText:"没有数据",group:!1,width:!1,height:!1,itemWidth:200,itemHeight:200,renderItemFormatter:null,pager:{pageIndex:1,pageSize:30,pageButtonCount:10,showPageInfo:!1,pageInfoFormatter:null},selection:{multiple:!1}}},_defineEvents:function(){var a=["selecting","selected","deselected","rebind","cancel"];return this.option.pager&&a.push("pagechanging"),a},_create:function(){this._itemBodyList=[],this._selectList=[],this._hasPrompt=!!this.option.promptText,this._currentMarginInfo=null,this.viewBody=null,this.pagerHeight=30,this.option.group&&d.call(this,this.option.group),this.option.pager&&h.call(this,this.option.pager),(!b.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=!1),(!b.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=!1),this.onBodyClickHandler=i.bind(this)},_render:function(){this.element.hasClass("ui-card-view")||this.element.addClass("ui-card-view"),this._initBorderWidth(),this.viewBody=a("<div class='ui-card-view-body' />"),this._initDataPrompt(),this.element.append(this.viewBody),this.option.selection&&this.viewBody.click(this.onBodyClickHandler),this._initPagerPanel(),this.setSize(this.option.width,this.option.height),this.option.selection?"disabled"===this.option.selection.type&&(this.option.selection=!1):this.option.selection=!1,Array.isArray(this.option.viewData)&&this.fill(this.option.viewData,this.option.viewData.length)},_initBorderWidth:function(){var a=function(a){return parseInt(this.element.css(a),10)||0};this.borderWidth=0,this.borderHeight=0,this.borderWidth+=a.call(this,"border-left-width"),this.borderWidth+=a.call(this,"border-right-width"),this.borderHeight+=a.call(this,"border-top-width"),this.borderHeight+=a.call(this,"border-bottom-width")},_initDataPrompt:function(){var c;this._hasPrompt&&(this._dataPrompt=a("<div class='data-prompt' />"),c=this.option.promptText,b.core.isString(c)&&c.length>0?this._dataPrompt.html("<span class='font-highlight'>"+c+"</span>"):b.core.isFunction(c)&&(c=c(),this._dataPrompt.append(c)),this.viewBody.append(this._dataPrompt))},_initPagerPanel:function(){this.pager&&(this.gridFoot=a("<div class='ui-card-view-foot clear' />"),this.element.append(this.gridFoot),this.pager.pageNumPanel=a("<div class='page-panel' />"),this.option.pager.displayDataInfo?(this.pager.pageInfoPanel=a("<div class='data-info' />"),this.gridFoot.append(this.pager.pageInfoPanel)):this.pager.pageNumPanel.css("width","100%"),this.gridFoot.append(this.pager.pageNumPanel),this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this))},_rasterizeItems:function(a,c){var d,e,f,g,h,i,j,k;e=this.getViewData(),0!==e.length&&(f=this.isGroup(),f&&(this._groupData||(g=this.option.group,this._groupData=g.groupListHandler.call(this,e,g.groupField,g.itemsField)),e=this._groupData),d=this._getMargin(e),this._currentMarginInfo=d,0!==d.count&&(k=b.core.isFunction(c),j=[],h=this,this._viewDataIndex=-1,f?e.forEach(function(a,b){i=h._getItemBody(b,f,j,d.margin),h._fillItemBody(a[h.option.group.itemsField],b,i,d,k,c)}):(i=this._getItemBody(0,f,j,d.margin),this._fillItemBody(e,0,i,d,k,c)),delete this._viewDataIndex,j.length>0&&h.viewBody.append(j)))},_getItemBody:function(b,c,d,e){var f,g;return f=this._itemBodyList[b],f?c&&(g=f.prev(),this.option.group.headRearrangeHandler.call(this,g,b,this._groupData[b],e)):(c&&(g=a("<div class='item-head' />"),g.append(this.option.group.headFormatter.call(this,this._groupData[b],e)),0===d.length&&g.css("margin-top",e+"px"),d.push(g)),f=a("<div class='item-body' />"),d.push(f),this._itemBodyList.push(f)),f},_fillItemBody:function(a,b,c,d,e,f){var g,h,i,j,k,l,m;for(g=Math.floor((a.length+d.count-1)/d.count),c.css("height",g*(this.option.itemHeight+d.margin)+d.margin+"px"),h=0;h<g;h++)for(i=0;i<d.count;i++){if(j=h*d.count+i,j>=a.length)return;this._viewDataIndex++,k=(h+1)*d.margin+h*this.option.itemHeight,l=(i+1)*d.margin+i*this.option.itemWidth,m=a[j],m._group={index:b,itemIndex:j},e&&f.call(this,c,m,this._viewDataIndex,k,l)}},_getMargin:function(a,c){var d,e,f,g,h,i,j;return d=this.viewBody.width(),e=this.viewBody.height(),i=this.isGroup(),j=function(a,b){var c,d,f;if(0===b.count)return b;if(i)for(c=b.margin,d=0,f=a.length;d<f;d++)c+=k,c+=Math.floor((a[d][this.option.group.itemsField].length+b.count-1)/b.count)*(b.margin+this.option.itemHeight)+b.margin;else c=Math.floor((a.length+b.count-1)/b.count)*(b.margin+this.option.itemHeight)+b.margin;return c>e?this._getMargin(f,c):b},c&&(h=!0,c>e&&(d-=b.scrollbarWidth)),f={count:Math.floor(d/this.option.itemWidth),margin:0},g=d-f.count*this.option.itemWidth,f.margin=Math.floor(g/(f.count+1)),f.margin>=l?h?f:j.call(this,a,f):(f.margin=l,f.count=Math.floor((d-(f.count+1)*f.margin)/this.option.itemWidth),g=d-f.count*this.option.itemWidth,f.margin=Math.floor(g/(f.count+1)),h?f:j.call(this,a,f))},_createItem:function(b,c){var d=a("<div class='view-item' />");return d.css({width:this.option.itemWidth+"px",height:this.option.itemHeight+"px"}),d.attr("data-index",c),d},_renderItem:function(c,d,e){var f,g,h;h=this.option.renderItemFormatter,b.core.isFunction(h)&&(f=h.call(this,d,e),f&&c.append(f)),g=a("<div class='frame-panel border-highlight'/>"),g.css({width:this.option.itemWidth-2*m+"px",height:this.option.itemHeight-2*m+"px"}),c.append(g),c.append("<i class='check-marker border-highlight'></i>"),c.append("<i class='check-icon fa fa-check'></i>")},_renderPageList:function(a){this.pager&&(this.pager.data=this.option.viewData,this.pager.pageIndex=this.pageIndex,this.pager.pageSize=this.pageSize,this.pager.renderPageList(a))},_rearrangeItems:function(){var b,c,d;if(0!==!this._itemBodyList.length){for(d=[],b=0,c=this._itemBodyList.length;b<c;b++)d.push(this._itemBodyList[b].children());this._rasterizeItems(!1,function(b,c,e,f,g){var h,i;i=c._group,h=d[i.index][i.itemIndex],a(h).css({top:f+"px",left:g+"px"})})}},_getSelectionData:function(a){var b,c,d;return b=parseInt(a.attr("data-index"),10),d=this.getViewData(),c={itemIndex:b,itemData:d[b]},this.isGroup()&&(c.group={index:c.itemData._group.index,itemIndex:c.itemData._group.itemIndex}),c},_selectItem:function(b){var c,d,e,f;if(c=this._getSelectionData(b),c.element=b,c.originElement=b.context?a(b.context):null,d=this.fire("selecting",c),d!==!1)if(this.isMultiple())if(b.hasClass(j)){for(e=0,f=this._selectList.length;e<f;e++)if(this._selectList[e]===b[0]){this._selectList.splice(e,1);break}b.removeClass(j),this.fire("deselected",c)}else this._selectList.push(b[0]),b.addClass(j),this.fire("selected",c);else if(this._current){if(this._current.removeClass(j),this_current[0]===b[0])return this._current=null,void this.fire("deselected",c);this._current=b,b.addClass(j),this.fire("selected",c)}},_getItemElement:function(b){var c,d,e,f,g;return d=this.getViewData(),0===d.length?null:(g=d[b],c=g._group,(e=this._itemBodyList[c.index])?(f=e.children(),g=f[c.itemIndex],g?a(g):null):null)},_updateIndexes:function(b,c,d){var e,f,g,h,i,j;for(f=this.getViewData(),i=b;i<this._itemBodyList.length;i++){for(e=this._itemBodyList[i],g=e.children(),j=c;j<g.length;j++)a(g[j]).attr("data-index",d),h=f[d],h._group={index:i,itemIndex:j},d++;c=0}},_removeGroup:function(a){var b;b=a.prev(),b.length>0&&b.hasClass("item-head")&&b.remove(),a.remove()},_promptIsShow:function(){return this._hasPrompt&&"block"===this._dataPrompt.css("display")},_setPromptLocation:function(){var a=this._dataPrompt.height();this._dataPrompt.css("margin-top",-(a/2)+"px")},_showDataPrompt:function(){this._hasPrompt&&(this._dataPrompt.css("display","block"),this._setPromptLocation())},_hideDataPrompt:function(){this._hasPrompt&&this._dataPrompt.css("display","none")},fill:function(b,c){var d;return d=!1,this._itemBodyList.length>0&&(d=!0,this.viewBody.scrollTop(0),this.clear(!1)),Array.isArray(b)||(b=[]),this.option.viewData=b,0===b.length?void this._showDataPrompt():(this._hideDataPrompt(),this._rasterizeItems(!0,function(a,b,c,d,e){var f=this._createItem(b,c);f.css({top:d+"px",left:e+"px"}),this._renderItem(f,b,c),a.append(f)}),a.isNumeric(c)&&this._renderPageList(c),void(d&&this.fire("rebind")))},getSelection:function(){var b,c,d;if(!this.isSelectable())return null;if(this.isMultiple())for(b=[],c=0,d=this._selectList.length;c<d;c++)b.push(this._getSelectionData(a(this._selectList[c])));else b=null,this._current&&(b=this._getSelectionData(this._current));return b},cancelSelection:function(){var b,c;if(this.isSelectable()){if(this.isMultiple()){if(0===this._selectList.length)return;for(b=0,c=this._selectList.length;b<c;b++)elem=a(this._selectList[b]),fn.call(this,elem);this._selectList=[]}else{if(!this._current)return;fn.call(this,this._current),this._current=null}this.fire("cancel")}},removeAt:function(){var a,c,d,e,f,g,h,i;if(c=this.getViewData(),0!==c.length&&(g=arguments.length,0!==g)){for(e=[],f=0;f<g;f++)d=arguments[f],b.core.isNumber(d)&&d>=0&&d<c.length&&e.push(d);if(g=e.length,g>0){for(e.sort(function(a,b){return b-a}),f=0;f<g;f++)if(d=e[f],a=this._getItemElement(d),a&&(i=c[d]._group,this.option.viewData.splice(d,1),this.isGroup()?1===this._groupData[i.index][this.option.group.itemsField].length?(this._groupData.splice(i.index,1),this._itemBodyList.splice(i.index,1),this._removeGroup(a.parent())):(this._groupData[i.index][this.option.group.itemsField].splice(i.index,1),a.remove()):a.remove(),this.isSelectable()))if(this.isMultiple()){for(h=0;h<this._selectList.length;h++)if(this._selectList[h]===a[0]){this._selectList.splice(h,1);break}}else this._current&&this._current[0]===a[0]&&(this._current=null);this._updateIndexes(i.index,i.itemIndex,d),this._rearrangeItems()}}},updateItem:function(a,c){var d;!b.core.isNumber(a)||a<0||a>=this.count()||(d=this._getItemElement(a),d&&(d.empty(),this.option.viewData[a]=c,this._renderItem(d,c,a)))},addItem:function(a){var b,c,d,e,f,g,h,i,j,k;if(a){if(b=this.option.viewData,!Array.isArray(b)||0===b.length)return this.bodyPanel&&(this.bodyPanel.remove(),this.bodyPanel=null),void this.fill([a]);if(h={},this.isGroup()){for(e=a[this.option.group.groupField]+"",d=-1,j=0,k=this._groupData.length;j<k;j++)if(this._groupData[j][this.option.group.groupField]===e){d=j;break}d===-1?(h.index=this._groupData.length,h.itemIndex=0,g={},g[this.option.group.groupField]=e,g[this.option.group.itemsField]=[a],this._groupData.push(g),i=[],f=this._getItemBody(h.index,!0,i,this._currentMarginInfo.margin),this.viewBody.append(i)):(f=this._itemBodyList[d],h.index=d,h.itemIndex=this._groupData[d][this.option.group.itemsField].length,this._groupData[d][this.option.group.itemsField].push(a))}else h.index=0,h.itemIndex=b.length,f=this._itemBodyList[h.index];a._group=h,c=this._createItem(a,b.length),this._renderItem(c,a,b.length),b.push(a),f.append(c),this._rearrangeItems()}},insertItem:function(a,b){var c,d,e,f;if(b){if(f=this.option.viewData,!Array.isArray(f)||0===f.length)return void this.addItem(b);if(a<0&&(a=0),a>=0&&a<f.length){if(d={},this.isGroup()){if(e=f[a],e[this.option.group.groupField]!==b[this.option.group.groupField])throw new Error("the data not belong to the destination group.");d.index=e._group.index,d.itemIndex=e._group.itemIndex,this._groupData[d.index][this.option.group.itemsField].splice(d.itemIndex,0,b)}else d.index=0,d.itemIndex=a;b._group=d,c=this._createItem(b,a),this._renderItem(c,b,a),this._getItemElement(a).before(c),f.splice(a,0,b),this._updateIndexes(d.index,d.itemIndex,a),this._rearrangeItems()}else this.addItem(b)}},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},getColumnCount:function(){return this._currentMarginInfo?this._currentMarginInfo.count:0},getItemMargin:function(){return this._currentMarginInfo?this._currentMarginInfo.margin:0},count:function(){return Array.isArray(this.option.viewData)?this.option.viewData.length:0},isSelectable:function(){return!!this.option.selection},isMultiple:function(){return this.option.selection.multiple===!0},isGroup:function(){return!!this.option.group},clear:function(){var a;this._itemBodyList.length>0&&(a=this,this._itemBodyList.forEach(function(b){a._removeGroup(b)}),this.isGroup()&&(this._groupData=null),this._itemBodyList=[],this.option.viewData=[],this._selectList=[],this._current=null),this.pager&&this.pager.empty(),arguments[0]!==!1&&this._showDataPrompt()},setSize:function(a,c){var d=!1;1===arguments.length&&(c=a,a=null),b.core.isNumber(c)&&(c-=this.borderHeight,this.pager&&(c-=this.pagerHeight),this.viewBody.css("height",c+"px"),d=!0),b.core.isNumber(a)&&(a-=this.borderWidth,this.element.css("width",a+"px"),d=!0),d&&this._rearrangeItems(),this._promptIsShow()&&this._setPromptLocation()}}),a.fn.cardView=function(a){if(0!==this.length)return b.ctrls.CardView(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(b){var c,d,e,f;for(b.stopPropagation(),c=a(b.target);"DT"!==(d=c.nodeName())||!c.hasClass("ui-fold-view-title");){if(c.hasClass("ui-fold-view"))return;c=c.parent()}f=c.children(".ui-fold-view-icon"),e=c.next(),"none"===e.css("display")?(f.removeClass("background-highlight").addClass("font-highlight").html("<i class='fa fa-angle-up' />"),e.css("display","block")):(f.removeClass("font-highlight").addClass("background-highlight").html("<i class='fa fa-angle-down' />"),e.css("display","none"))}function d(a){return this instanceof d?void this.initialize(a):new d(a)}d.prototype={constructor:d,initialize:function(b){this.element=b,this.onFoldTitleClickHandler=a.proxy(c,this)},_render:function(){var b,c,d,e,f,g;for(b=this.element.children("dt"),g=b.length,g>0&&this.element.click(this.onFoldTitleClickHandler),f=0;f<g;f++)c=a(b[f]),e=c.text(),c.addClass("ui-fold-view-title"),d=a("<div class='ui-fold-view-icon border-highlight' />"),"none"===c.next().css("display")?d.addClass("background-highlight").html("<i class='fa fa-angle-down' />"):d.addClass("font-highlight").html("<i class='fa fa-angle-up' />"),c.empty(),c.append(d).append("<span class='font-highlight'>"+e+"</span>")}},a.fn.foldView=function(){var b,c,e;if(0!==this.length)for(b=0;b<this.length;b++)c=a(this[b]),c.isNodeName("dl")&&c.hasClass("ui-fold-view")&&(e=d(c),e._render(),c[0].foldView=e)}}(jQuery,ui),function(a,b){"use strict";function c(a){return{groupText:a}}function d(){return"array"===b.core.type(this.itemIndexes)}function e(a,b,c,d){return d.isFinale=!0,d.attr("colspan",this.option.columns.length),d.click(this.group.onGroupRowClickHandler),this.group._last_group_index_=a.groupIndex,this.group.groupItemFormatter.apply(this,arguments)}function f(b){var c,d,e;for(b.stopPropagation(),d=a(b.target);!d.isNodeName("td");){if(d.isNodeName("tr"))return;d=d.parent()}c=this.gridview.getViewData(),e=c[d.parent()[0].rowIndex],d.hasClass("group-fold")?(d.removeClass("group-fold"),this._operateChildren(e.itemIndexes,function(b,c){a(c).css("display","table-row")})):(d.addClass("group-fold"),this._operateChildren(e.itemIndexes,function(b,c){a(c).css("display","none")}))}function g(){return this instanceof g?void this.initialize():new g}g.prototype={constructor:g,initialize:function(){this.gridview=null,this.onGroupRowClickHandler=f.bind(this)},_operateChildren:function(a,b){var c,d,e,f,g,h;for(c=this.gridview.getViewData(),e=this.gridview.tableBody[0].rows,g=0,h=a.length;g<h;g++)d=a[g],f=c[d],b.call(this,f,e[d])},setGridView:function(a){a instanceof b.ctrls.GridView&&(this.gridview=a,this.gridview.group=this)},listGroup:function(b,d,e){var f=[],g={};if(!Array.isArray(b)||0===b.length)return f;e=a.isFunction(e)?e:c;for(var h,i,j,k=0,l=b.length;k<l;k++)h=b[k],i=h[d],g.hasOwnProperty(i)?g[i].itemIndexes.push(k):(j=e.call(h,i),j.itemIndexes=[k],g[i]=j);for(i in g)for(j=g[i],f.push(j),j.groupIndex=f.length-1,k=0,l=j.itemIndexes.length;k<l;k++)f.push(b[j.itemIndexes[k]]),j.itemIndexes[k]=f.length-1;return f},rowNumber:function(a,b,c,f){var g,h;return g=this.getViewData(),h=g[c],d.call(h)?e.call(this,h,b,c,f):"<span>"+(c-this.group._last_group_index_)+"</span>"},formatText:function(a,c,f,g){var h,i;return h=this.getViewData(),i=h[f],d.call(i)?e.call(this,i,c,f,g):b.ColumnStyle.cfn.defaultText.apply(this,arguments)},groupItemFormatter:function(a,b,c,d){return null}},b.ctrls.GridViewGroup=g}(jQuery,ui),function(a,b){"use strict";function c(a){return this[a]}function d(a){return!!a[g]}function e(b){var c,d,e;b.stopPropagation(),c=a(b.target),d=c.parent().parent()[0].rowIndex,e=this.gridview.getRowData(d),c.hasClass("unfold")?(e._isFolded=!0,c.removeClass("unfold").removeClass("fa-angle-down").addClass("fa-angle-right"),this._hideChildren(e,d)):(e._isFolded=!1,c.addClass("unfold").removeClass("fa-angle-right").addClass("fa-angle-down"),this._showChildren(e,d))}function f(){return this instanceof f?void this.initialize():new f}var g="_children",h="_parent",i="_fromList";f.prototype={constructor:f,initialize:function(){this.lazy=!1,this.loadChildrenHandler=null,this.gridview=null,this.isTreeNode=d,this.onFoldButtonClickHandler=e.bind(this)},_fixParentIndexes:function(a,b,c){var d=a[h];if(d){for(var e=d[g],f=e.length,i=0;i<f;i++)e[i]>b&&(e[i]=e[i]+c);b=e[0]-1,b>=0&&this._fixParentIndexes(d,b,c)}},_fixTreeIndexes:function(a,b,c,d){for(var e,f,h,i=a,j=b;i<j;i++)if(e=c[i],this.isTreeNode(e)){if(f=e[g],!f)continue;for(h=0;h<f.length;h++)f[h]=f[h]+d}},_showChildren:function(b,c){b[g]?this._operateChildren(b[g],function(b,c){if(a(c).css("display","table-row"),b._isFolded===!0)return!1}):this.lazy&&a.isFunction(this.loadChildrenHandler)&&this.loadChildrenHandler(b,c)},_hideChildren:function(b){b[g]&&this._operateChildren(b[g],function(b,c){a(c).css("display","none")})},_operateChildren:function(a,b){var c,d,e,f,h,i,j;if(a)for(c=this.gridview.getViewData(),e=this.gridview.tableBody[0].rows,i=0,j=a.length;i<j;i++)d=a[i],f=c[d],h=b.call(this,f,e[d]),h!==!1&&f[g]&&this._operateChildren(f[g],b)},_changeLevel:function(b,c,d,e){var f=d._level+e;f<0&&(f=0),d._level=f;var g=this.gridview.option.columns[c],h=a(this.gridview.tableBody.get(0).rows[b].cells[c]);h.empty(),h.append(g.handler.call(this.gridview,this.gridview.prepareValue(d,g),g,b,h))},_sortListTree:function(a,b,c,d){for(var e,f=0,j=a.length;f<j;f++)e=a[f],delete e[i],e._level=d,e[h]=c,b.push(e),a[f]=b.length-1,e[g].length>0?this._sortListTree(e[g],b,e,d+1):delete e[g]},setGridView:function(a){a instanceof b.ctrls.GridView&&(this.gridview=a,this.gridview.tree=this)},listTree:function(b,d,e){var f=[],h=c,j=c;if(!Array.isArray(b)||0===b.length)return f;a.isFunction(d)&&(h=d),a.isFunction(e)&&(j=e);var k,l,m,n,o,p,q={};for(n=0;n<b.length;n++)m=b[n],p=h.call(m,d)+""||"__",q.hasOwnProperty(p)?(k=q[p],k[g].push(m)):(k={},k[g]=[],k[g].push(m),q[p]=k),o=j.call(m,e)+"",q.hasOwnProperty(o)?(k=q[o],m[g]=k[g],q[o]=m,m[i]=!0):(m[g]=[],m[i]=!0,q[o]=m);for(var r in q)if(q.hasOwnProperty(r)&&(k=q[r],!k.hasOwnProperty(i))){l=k;break}return this._sortListTree(l[g],f,null,0),f},listTreeByLevel:function(a,b,d){var e=[],f=c;if(!Array.isArray(a)||0===a.length)return e;var h,i,j,k,l=[],m=[];for(h=0;h<a.length;h++)i=a[h],i[g]=[],i[b]=null,h>0?i._level-a[h-1]._level>1&&(i._level=a[h-1]._level+1):i._level=0,k=i._level,l[k]=i,0!==k?(j=l[k-1],j[g].push(i),i[b]=f.call(j,d)):m.push(i);return this._sortListTree(m,e,null,0),e},treeNode:function(b,c,d,e){var f,g,h,i;return b?(f=this.getViewData(),g=f[d],a.isNumeric(g._level)||(g._level=0),h=a("<span />").text(b),this.tree.isTreeNode(g)?(g._isFolded=!1,h=[null,h[0]],i=a(this.tree.lazy?"<i class='fold font-highlight-hover fa fa-angle-right' />":"<i class='fold unfold font-highlight-hover fa fa-angle-down' />"),i.css("margin-left",17*g._level+5+"px"),i.click(this.tree.onFoldButtonClickHandler),h[0]=i[0]):h.css("margin-left",17*(g._level+1)+5+"px"),h):null},levelNode:function(c,d,e,f){var g,h,i;return c?(g=this.getViewData(),h=g[e],b.type.isNumber(h._level)||(h._level=0),i=a("<span />").text(c),i.css("margin-left",17*(h._level+1)+5+"px"),i):null},addChildren:function(b,c,d){var e,f,i,j,k,l=c+1;for(b[g]=[],e=this.gridview.getViewData(),j=0,k=d.length;j<k;j++)f=d[j],f._level=b._level+1,f[h]=b,b[g].push(l),i=a("<tr />"),e.splice(l,0,f),this.gridview._createRowCells(i,f,l),l<e.length-1?a(this.gridview.tableBody[0].rows[l]).before(i):this.gridview.tableBody.append(i),l++;this.gridview._updateScrollState(),this.gridview._refreshRowNumber(l-1),this._fixParentIndexes(b,c,k),this._fixTreeIndexes(c+1+k,e.length,e,k)},changeLevel:function(a,c,d,e){var f,g,h,i;if(g=this.gridview.getViewData(),!("number"!==b.core.type(a)||a<0||a>=g.length)&&(f=g[a],e=!!e,h=f._level,this._changeLevel(a,c,f,d),e))for(i=a+1;i<g.length;){if(f=g[i],f._level<=h)return;this._changeLevel(i,c,f,d),i++}}},b.ctrls.GridViewTree=f}(jQuery,ui),function(a,b){"use strict";function c(a){a.showPageInfo===!0&&(a.pageInfoFormatter||(a.pageInfoFormatter={currentRowNum:function(a){return"<span>本页"+a+"行</span>"},rowCount:function(a){return"<span class='font-highlight'>共"+a+"行</span>"},pageCount:function(a){return"<span>"+a+"页</span>"}})),this.pager=b.ctrls.Pager(a),this.pageIndex=this.pager.pageIndex,this.pageSize=this.pager.pageSize}function d(a,b){for(var c,d=0,e=a.length-1,f=a.length/2;d<f;d++,e--)c=a[d],a[d]=a[e],a[e]=c,c=b[d],b[d]=b[e],b[e]=c}function e(a,c){var d,e,g,h;return d=this._lastSortColumn,e=d.sort,b.core.isFunction(e)||(e=f),g=this._prepareValue(a,d),h=this._prepareValue(c,d),e(g,h)}function f(a,b){var c,d,e;if(Array.isArray(a)){for(c=0,d=0,e=a.length;d<e;d++)if(c=g(a[d],b[d]),0!==c)return c;return c}return g(a,b)}function g(a,b){return"string"==typeof a?a.localeCompare(b):a<b?-1:a>b?1:0}function h(){var a,c;for(c in this.resetColumnStateHandlers)if(this.resetColumnStateHandlers.hasOwnProperty(c)&&(a=this.resetColumnStateHandlers[c],b.core.isFunction(a)))try{a.call(this)}catch(a){}}function i(b){var c,d,e,f;for(b||(b=this.tableHead.find("tr")),d=b.children(),e=0,f=this._sorterIndexes.length;e<f;e++)if(c=a(d[this._sorterIndexes[e]]),c=c.find("i"),!c.hasClass(s))return void c.attr("class","fa fa-sort")}function j(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function k(b){var c,d=!b.hasClass("fa-check-square");if(j(b,d),!this._gridCheckboxAll){if(c=this._getColumnIndexByFormatter(x,"text"),c===-1)return;this._gridCheckboxAll=a(this.tableHead[0].tHead.rows[0].cells[c]).find("."+q)}d?this._checkedCount++:this._checkedCount--,this._checkedCount===this.count()?j(this._gridCheckboxAll,!0):j(this._gridCheckboxAll,!1)}function l(b){var c,f,g,h,j,k,l,m,n,o;if(b.stopPropagation(),c=this.option.viewData,Array.isArray(c)&&0!==c.length){for(f=a(b.target);"TH"!==(g=f.nodeName());){if("TR"===g)return;f=f.parent()}if(h=f[0].cellIndex,j=this.option.columns[h],this._lastSortColumn!==j&&i.call(this,f.parent()),
k=e.bind(this),l=this._lastSortColumn==j,this._lastSortColumn=j,m=this.tableBody.children("tbody"),n=m.children().get(),!Array.isArray(n)||n.length!=c.length)throw new Error("data row error");o=f.find("i"),o.hasClass(t)?(d(c,n),o.removeClass(s).removeClass(t).addClass(u)):(l?d(c,n):(this.sorter.items=n,this.sorter.sort(c,k)),o.removeClass(s).removeClass(u).addClass(t)),m.append(n),this._refreshRowNumber()}}function m(c){var d,e,f,g,h,i;if(this.isSelectable()&&(d=a(c.target),g=this.option.selection.exclude,!g||(h=!0,b.core.isString(g)?h=this._excludeElement(d,g):b.core.isFunction(g)&&(h=g.call(this,d)),h!==!1))){if(d.hasClass(p)&&!this.option.selection.isRelateCheckbox)return void k.call(this,d);for(e="cell"===this.option.selection.type?"TD":"TR",f="cell"===this.option.selection.type?"cell-selected":"row-selected";(i=d.nodeName())!==e;){if("TBODY"===i)return;d=d.parent()}d[0]!==c.target&&(d.context=c.target),this._selectItem(d,f)}}function n(a){this.gridHead.scrollLeft(this.gridBody.scrollLeft())}function o(c){var d,e,f,g,h,i,k,l,m,n;if(c.stopPropagation(),d=a(c.target),h=d.parent().prop("cellIndex"),h!==-1){if(g=!d.hasClass("fa-check-square"),j.call(this,d,g),this.option.selection.isRelateCheckbox===!0&&this.isMultiple())if(k="cell"===this.option.selection.type?"cell-selected":"row-selected",g)l=function(a,b){var c;c="cell"===this.option.selection.type?a:a.parent(),c.context=b[0],this._selectItem(c,k,g)};else{for(m=0,n=this._selectList.length;m<n;m++)a(this._selectList[m]).removeClass(k).removeClass("background-highlight");this._selectList=[]}for(i=this.tableBody[0].tBodies[0].rows,m=0,n=i.length;m<n;m++)f=a(i[m].cells[h]),e=f.find("."+p),e.length>0&&(b.core.isFunction(l)?l.call(this,f,e):j.call(this,e,g));g?this._checkedCount=this.count():this._checkedCount=0}}var p="grid-checkbox",q="grid-checkbox-all",r="last-cell",s="fa-sort",t="fa-sort-asc",u="fa-sort-desc",v=/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,w=/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,x=b.ColumnStyle.cnfn.checkAll,y=b.ColumnStyle.cfn.check,z=b.ColumnStyle.cnfn.columnText,A=b.ColumnStyle.cfn.text,B=b.ColumnStyle.cfn.rowNumber,C=100;b.define("ui.ctrls.GridView",{_defineOption:function(){return{columns:[],viewData:null,promptText:"没有数据",height:!1,width:!1,pager:{pageIndex:1,pageSize:C,pageButtonCount:10,showPageInfo:!1,pageInfoFormatter:null},selection:{type:"row",exclude:!1,multiple:!1,isRelateCheckbox:!0}}},_defineEvents:function(){var a=["selecting","selected","deselected","rebind","cancel"];return this.option.pager&&a.push("pagechanging"),a},_create:function(){this._selectList=[],this._sorterIndexes=[],this._hasPrompt=!!this.option.promptText,this.resetColumnStateHandlers={},this.gridHead=null,this.gridBody=null,this.columnHeight=30,this.pagerHeight=30,this.option.pager?c.call(this,this.option.pager):(this.pageIndex=1,this.pageSize=C),this.option.selection?(b.core.isString(this.option.selection.type)?this.option.selection.type=this.option.selection.type.toLowerCase():this.option.selection.type="disabled",this.option.selection.multiple||(this.option.selection.isRelateCheckbox=!1)):this.option.selection={type:"disabled"},(!b.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=!1),(!b.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=!1),this.sorter=b.Introsort(),this._checkedCount=0,this.onSortHandler=l.bind(this),this.onTableBodyClickHandler=m.bind(this),this.onCheckboxAllClickHandler=o.bind(this),this.onScrollingXHandler=n.bind(this)},_render:function(){this.element.hasClass("ui-grid-view")||this.element.addClass("ui-grid-view"),this._initBorderWidth(),this.gridHead=a("<div class='ui-grid-head' />"),this.element.append(this.gridHead),this.gridBody=a("<div class='ui-grid-body' />"),this._initDataPrompt(),this.gridBody.scroll(this.onScrollingXHandler),this.element.append(this.gridBody),this._initPagerPanel(),this.setSize(this.option.width,this.option.height),this.createGridHead(),Array.isArray(this.option.viewData)?this.createGridBody(this.option.viewData,this.option.viewData.length):this.option.viewData=[]},_initBorderWidth:function(){var a=function(a){return parseInt(this.element.css(a),10)||0};this.borderWidth=0,this.borderHeight=0,this.borderWidth+=a.call(this,"border-left-width"),this.borderWidth+=a.call(this,"border-right-width"),this.borderHeight+=a.call(this,"border-top-width"),this.borderHeight+=a.call(this,"border-bottom-width")},_initDataPrompt:function(){var c;this._hasPrompt&&(this._dataPrompt=a("<div class='data-prompt' />"),c=this.option.promptText,b.core.isString(c)&&c.length>0?this._dataPrompt.html("<span class='font-highlight'>"+c+"</span>"):b.core.isFunction(c)&&(c=c(),this._dataPrompt.append(c)),this.gridBody.append(this._dataPrompt))},_initPagerPanel:function(){this.pager&&(this.gridFoot=a("<div class='ui-grid-foot clear' />"),this.element.append(this.gridFoot),this.pager.pageNumPanel=a("<div class='page-panel' />"),this.option.pager.displayDataInfo?(this.pager.pageInfoPanel=a("<div class='data-info' />"),this.gridFoot.append(this.pager.pageInfoPanel)):this.pager.pageNumPanel.css("width","100%"),this.gridFoot.append(this.pager.pageNumPanel),this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this))},_createRowCells:function(a,c,d){var e,f,g,h,i,j,k,l;for(l="cell"!==this.option.selection.type,l&&a.addClass("table-body-row-hover"),e=0,f=this.option.columns.length;e<f;e++)if(g=this.option.columns[e],k=g.formatter,b.core.isFunction(g.formatter)||(k=A),h=this._prepareValue(c,g),i=this._createCell("td",g),i.addClass("ui-table-body-cell"),l||i.addClass("table-body-cell-hover"),j=k.call(this,h,g,d,i),!i.isAnnulment&&(j&&i.append(j),e===f-1&&i.addClass(r),a.append(i),i.isFinale)){i.addClass(r);break}},_prepareValue:function(a,b){var c,d,e;if(Array.isArray(b.column))for(c={},d=0,e=b.column.length;d<e;d++)c[d]=c[b.column[d]]=this._getValue(a,b.column[d],b);else c=this._getValue(a,b.column,b);return c},_getValue:function(a,c,d){var e,f,g=0;if(!b.core.isString(c))return null;for(d._columnKeys.hasOwnProperty(c)||(d._columnKeys[c]=c.split(".")),e=d._columnKeys[c],f=a[e[g]],g=1;g<e.length;g++)if(f=f[e[g]],void 0===f||null===f)return f;return f},_createCol:function(c){var d=a("<col />");return b.core.isNumber(c.len)&&d.css("width",c.len+"px"),d},_createCell:function(b,c){var d=a("<"+b+" />"),e={};return c.align&&(e["text-align"]=c.align),d.css(e),d},_setSorter:function(a,c,d){(c.sort===!0||b.core.isFunction(c.sort))&&(a.click(this.onSortHandler),a.addClass("sorter"),a.append("<i class='fa fa-sort' />"),this._sorterIndexes.push(d))},_renderPageList:function(a){this.pager&&(this.pager.data=this.option.viewData,this.pager.pageIndex=this.pageIndex,this.pager.pageSize=this.pageSize,this.pager.renderPageList(a))},_updateScrollState:function(){this.tableHead&&(this.gridBody[0].scrollHeight>this.gridBody.height()?this._headScrollCol.css("width",b.scrollbarWidth+.1+"px"):this._headScrollCol.css("width","0"))},_refreshRowNumber:function(c,d){var e,f,g,h,i,j,k,l;if(e=this.option.viewData,e&&0!==e.length&&(g=B,f=this._getColumnIndexByFormatter(g),f!=-1))for(b.core.isNumber(c)||(c=0),h=this.tableBody[0].rows,j=this.option.columns[f],l=b.core.isNumber(d)?d+1:h.length,k=c;k<l;k++)i=a(h[k].cells[f]),i.html(""),i.append(g.call(this,null,j,k))},_getColumnIndexByFormatter:function(a,b){var c,d=this.option.columns.length;for(b||(b="formatter"),c=0;c<d;c++)if(this.option.columns[c][b]===a)return c;return-1},_getSelectionData:function(a){var b={};return"cell"===this.option.selection.type?(b.rowIndex=a.parent().prop("rowIndex"),b.cellIndex=a.prop("cellIndex"),b.rowData=this.option.viewData[b.rowIndex],b.column=this.option.columns[b.cellIndex].column):(b.rowIndex=a.prop("rowIndex"),b.rowData=this.option.viewData[b.rowIndex]),b},_excludeElement:function(a,c){var d,e,f,g,h=a.nodeName().toLowerCase(),i=c.split(",");for(f=0,g=i.length;f<g;f++)if(d=b.str.trim(i[f]),e=d.match(w)){if(d=d.match(v)[1],d===h)return a.attr(e[1])!==e[4]}else if(d.toLowerCase()===h)return!1},_selectItem:function(b,c,d){var e,f,g,h,i,k;if(e=this._getSelectionData(b),e.element=b,e.originElement=b.context?a(b.context):null,f=this.fire("selecting",e),f!==!1)if(this.isMultiple()){if(b.hasClass(c)){if(d===!0)return;for(d=!1,i=0,k=this._selectList.length;i<k;i++)if(this._selectList[i]===b[0]){this._selectList.splice(i,1);break}b.removeClass(c).removeClass("background-highlight"),this.fire("deselected",e)}else{if(d===!1)return;d=!0,this._selectList.push(b[0]),b.addClass(c).addClass("background-highlight"),this.fire("selected",e)}this.option.selection.isRelateCheckbox&&(e.originElement&&e.originElement.hasClass(p)&&(h=e.originElement),h||(g=this._getColumnIndexByFormatter(y),g>-1&&(h=a("cell"===this.option.selection.type?b.parent()[0].cells[g]:b[0].cells[g]),h=h.find("."+p))),h&&h.length>0&&j.call(this,h,d))}else{if(this._current&&(this._current.removeClass(c).removeClass("background-highlight"),this._current[0]===b[0]))return this._current=null,void this.fire("deselected",e);this._current=b,b.addClass(c).addClass("background-highlight"),this.fire("selected",e)}},_promptIsShow:function(){return this._hasPrompt&&"block"===this._dataPrompt.css("display")},_setPromptLocation:function(){var a=this._dataPrompt.height();this._dataPrompt.css("margin-top",-(a/2)+"px")},_showDataPrompt:function(){this._hasPrompt&&(this._dataPrompt.css("display","block"),this._setPromptLocation())},_hideDataPrompt:function(){this._hasPrompt&&this._dataPrompt.css("display","none")},createGridHead:function(c){var d,e,f,g,h,i;for(Array.isArray(c)?this.option.columns=c:c=this.option.columns,this.tableHead?this.tableHead.html(""):(this.tableHead=a("<table class='ui-table-head' cellspacing='0' cellpadding='0' />"),this.gridHead.append(this.tableHead)),d=a("<colgroup />"),e=a("<thead />"),f=a("<tr />"),i=0;i<c.length;i++)h=c[i],h._columnKeys||(h._columnKeys={}),d.append(this._createCol(h)),g=this._createCell("th",h),g.addClass("ui-table-head-cell"),b.core.isFunction(h.text)?g.append(h.text.call(this,h,g)):h.text&&g.append(z.call(this,h,g)),this._setSorter(g,h,i),i==c.length-1&&g.addClass(r),f.append(g);this._headScrollCol=a("<col style='width:0' />"),d.append(this._headScrollCol),f.append(a("<th class='ui-table-head-cell scroll-cell' />")),e.append(f),this.tableHead.append(d),this.tableHead.append(e)},createGridBody:function(c,d){var e,f,g,h,i,j,k=!1;if(this.tableBody?(this.gridBody.scrollTop(0),this.clear(!1),k=!0):(this.tableBody=a("<table class='ui-table-body' cellspacing='0' cellpadding='0' />"),this.tableBody.click(this.onTableBodyClickHandler),this.gridBody.append(this.tableBody)),Array.isArray(c)||(c=[]),this.option.viewData=c,0===c.length)return void this._showDataPrompt();for(this._hideDataPrompt(),e=a("<colgroup />"),f=a("<tbody />"),this.tableBody.append(e),i=0;i<this.option.columns.length;i++)j=this.option.columns[i],e.append(this._createCol(j));for(h=0;h<c.length;h++)g=a("<tr />"),this._createRowCells(g,c[h],h),f.append(g);this.tableBody.append(f),this._updateScrollState(),b.core.isNumber(d)&&this._renderPageList(d),k&&this.fire("rebind")},getCheckedValues:function(){var c,d,e,f,g,h="."+p,i=[];if(c=this._getColumnIndexByFormatter(y),c===-1)return i;for(d=this.gridBody[0].tBodies[0].rows,f=0,g=d.length;f<g;f++)e=a(d[f].cells[c]).find(h),e.length>0&&i.push(b.str.htmlDecode(e.attr("data-value")));return i},getSelection:function(){var b,c,d;if(!this.isSelectable())return null;if(this.isMultiple())for(b=[],c=0,d=this._selectList.length;c<d;c++)b.push(this._getSelectionData(a(this._selectList[c])));else b=null,this._current&&(b=this._getSelectionData(this._current));return b},cancelSelection:function(){var b,c,d,e,f,g,h;if(this.isSelectable()){if(b="cell"===this.option.selection.type?"cell-selected":"row-selected",this.option.selection.isRelateCheckbox?(e="."+p,d=this._getColumnIndexByFormatter(y),f=function(c){var f;d!==-1&&(f=a("cell"===this.option.selection.type?c.parent()[0].cells[d]:c[0].cells[d]),f=f.find(e),j(f,!1)),c.removeClass(b).removeClass("background-highlight")}):f=function(a){a.removeClass(b).removeClass("background-highlight")},this.isMultiple()){if(0===this._selectList.length)return;for(g=0,h=this._selectList.length;g<h;g++)c=a(this._selectList[g]),f.call(this,c);this._selectList=[]}else{if(!this._current)return;f.call(this,this._current),this._current=null}this.fire("cancel")}},removeRowAt:function(){var c,d,e,f,g,h,i,j,k;if(e=this.option.viewData,e&&(h=arguments.length,0!==h)){for(d=[],g=0;g<h;g++)c=arguments[g],b.core.isNumber(c)&&c>=0&&c<e.length&&d.push(c);if(h=d.length,h>0){for(d.sort(function(a,b){return b-a}),j=this.option.selection.type,i=this.isMultiple(),"row"===j?k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&this._current[0].rowIndex===a&&(this._current=null)}:"cell"===j&&(k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],d=d.parentNode,a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&(d=this._current.parent(),d[0].rowIndex===a&&(this._current=null))}),g=0;g<h;g++)c=d[g],f=a(this.tableBody[0].rows[c]),f.remove(),e.splice(c,1),k&&k.call(this,c);this._updateScrollState(),this._refreshRowNumber(c)}}},updateRow:function(b,c){var d,e;d=this.option.viewData,d&&(b<0||b>d.length||(e=a(this.tableBody[0].rows[b]),0!==e.length&&(e.empty(),d[b]=c,this._createRowCells(e,c,b))))},addRow:function(b){var c,d;if(b){if(c=this.option.viewData,!Array.isArray(c)||0===c.length)return this.tableBody&&(this.tableBody.remove(),this.tableBody=null),void this.createGridBody([b]);d=a("<tr />"),this._createRowCells(d,b,c.length),a(this.tableBody[0].tBodies[0]).append(d),c.push(b),this._updateScrollState()}},insertRow:function(b,c){var d,e;if(c){if(d=this.option.viewData,!Array.isArray(d)||0===d.length)return void this.addRow(c);b<0&&(b=0),b<d.length?(e=a("<tr />"),this._createRowCells(e,c,b),a(this.tableBody[0].rows[b]).before(e),d.splice(b,0,c),this._updateScrollState(),this._refreshRowNumber()):this.addRow(c)}},currentRowUp:function(){var a;if(this.isMultiple())throw new Error("The currentRowUp can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowUp can not support for cell selection");a=this.getSelection(),a&&0!==a.rowIndex&&this.moveRow(a.rowIndex,a.rowIndex-1)},currentRowDown:function(){var a;if(this.isMultiple())throw new Error("The currentRowDown can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowDown can not support for cell selection");a=this.getSelection(),!a||a.rowIndex>=this.count()||this.moveRow(a.rowIndex,a.rowIndex+1)},moveRow:function(b,c){var d,e,f,g;d=this.option.viewData,0!==d.length&&(c<0?c=0:c>=d.length&&(c=d.length-1),b!==c&&(e=this.tableBody[0].tBodies[0].rows,f=a(e[c]),c>rowIndex?(f.after(a(e[b])),this._refreshRowNumber(b,c)):(f.before(a(e[b])),this._refreshRowNumber(c,b)),g=d[b],d.splice(b,1),d.splice(c,0,g)))},getRowData:function(a){var c=this.option.viewData;return Array.isArray(c)&&0!==c.length?!b.core.isNumber(a)||a<0||a>=c.length?null:c[a]:null},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return Array.isArray(this.option.viewData)?this.option.viewData.length:0},isSelectable:function(){var a=this.option.selection.type;return"row"===a||"cell"===a},isMultiple:function(){return this.option.selection.multiple===!0},clear:function(){this.tableBody&&(this.tableBody.html(""),this.option.listView=null,this._selectList=[],this._current=null,h.call(this)),this.tableHead&&(i.call(this),this._lastSortColumn=null),this.pager&&this.pager.empty(),arguments[0]!==!1&&this._showDataPrompt()},setSize:function(a,c){1===arguments.length&&(c=a,a=null),b.core.isNumber(c)&&(c-=this.columnHeight+this.borderHeight,this.pager&&(c-=this.pagerHeight),this.gridBody.css("height",c+"px")),b.core.isNumber(a)&&(a-=this.borderWidth,this.element.css("width",a+"px")),this._updateScrollState(),this._promptIsShow()&&this._setPromptLocation()}}),a.fn.gridView=function(a){if(0!==this.length)return b.ctrls.GridView(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a,b){return"<span class='ui-list-view-item-text'>"+a+"</span>"}function d(a,b){var d=c(a),e=c(b);return d<e?-1:d>e?1:0}function e(b){var c,d,e;for(c=a(b.target),d=c.hasClass("close-button");!c.isNodeName("li");){if(c.hasClass("ui-list-view-ul"))return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),e=this._getItemIndex(c[0]),this.option.hasRemoveButton&&d?this._removeItem(c,e):this._selectItem(c,e)}var f="data-index",g="ui-list-view-selection";b.define("ui.ctrls.ListView",{_defineOption:function(){return{multiple:!1,viewData:null,itemFormatter:!1,hasRemoveButton:!1,animatable:!0,pager:!1}},_defineEvents:function(){var a=["selecting","selected","deselected","cancel","removing","removed"];return this.option.pager&&a.push("pageChanging"),a},_create:function(){this._selectList=[],this.sorter=Introsort(),b.core.isFunction(this.option.itemFormatter)||(this.option.itemFormatter=c),this.option.hasRemoveButton=!!this.option.hasRemoveButton,this.onListItemClickHandler=e.bind(this)},_render:function(){this.element.addClass("ui-list-view"),this.listPanel=a("<ul class='ui-list-view-ul' />"),this.listPanel.click(this.onListItemClickHandler),this.element.append(this.listPanel),this.option.pager&&this._initPager(this.option.pager),this._initAnimator(),this.setData(this.option.viewData)},_initPager:function(c){this.pagerPanel=a("<div class='ui-list-view-pager clear' />"),this.element.append(this.pagerPanel),this.listPanel.addClass("ui-list-view-pagelist"),this.pager=b.ctrls.Pager(c),this.pageIndex=this.pager.Index,this.pageSize=this.pager.pageSize,this.pager.pageNumPanel=this.pagerPanel,this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this)},_initAnimator:function(){this.removeFirstAnimator=b.animator({ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("margin-left",a+"px")}}),this.removeFirstAnimator.duration=300,this.removeSecondAnimator=b.animator({ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px")}}),this.removeSecondAnimator.duration=300},_fill:function(a){var b,c,d,e=[];for(this.listPanel.empty(),this.option.viewData=[],b=0,c=a.length;b<c;b++)d=a[b],null!==d&&void 0!==d&&(this._createItemHtml(builder,d,b),this.option.viewData.push(d));this.listPanel.html(e.join(""))},_createItemHtml:function(a,c,d){var e,g,h;if(a.push("<li ",f,"='",d,"' class='ui-list-view-item'>"),e=this.option.itemFormatter.call(this,c,d),b.core.isString(e))a.push("<div class='ui-list-view-container'>"),a.push(e),a.push("</div>");else if(b.core.isPlainObject(e)){if(h=a[a.length-1],g=h.lastIndexOf("'"),a[a.length-1]=h.substring(0,g),b.core.isString(e.class)?a.push(" ",e.class):Array.isArray(e.class)&&a.push(" ",e.class.join(" ")),a.push("'"),e.style&&!b.core.isEmptyObject(e.style)){a.push(" style='");for(h in e.style)e.style.hasOwnProperty(h)&&a.push(h,":",e.style[h],";");a.push("'")}a.push(">"),a.push("<div class='ui-list-view-container'>"),e.html&&a.push(e.html),a.push("</div>")}this._appendOperateElements(a),a.push("</li>")},_createItem:function(c,d){var e=[],g=a("<li class='ui-list-view-item' />"),h=a("<div class='ui-list-view-container' />"),i=this.option.itemFormatter.call(this,c,d);return g.attr(f,d),b.core.isString(i)?h.append(i):b.core.isPlainObject(i)&&(b.core.isString(i.class)?g.addClass(i.class):Array.isArray(i.class)&&g.addClass(i.class.join(" ")),i.style&&!b.core.isEmptyObject(i.style)&&g.css(i.style),i.html&&h.html(i.html)),this._appendOperateElements(e),h.append(e.join("")),g.append(h),g},_appendOperateElements:function(a){a.push("<b class='ui-list-view-b background-highlight' />"),this.option.hasRemoveButton&&a.push("<a href='javascript:void(0)' class='close-button ui-item-view-remove'>×</a>")},_indexOf:function(a){var b,c,d=this.getViewData();for(b=0,c=d.length;b>c;b++)if(a===d[b])return b;return-1},_getItemIndex:function(a){return parseInt(a.getAttribute(f),10)},_itemIndexAdd:function(a,b){this._itemIndexSet(f,this._getItemIndex(a)+b)},_itemIndexSet:function(a,b){a.setAttribute(f,b)},_getSelectionData:function(a){var b=this._getItemIndex(a),c={},d=this.getViewData();return c.itemData=d[b],c.itemIndex=b,c},_removeItem:function(b,c){var d,e,f,g,h,i=this;if(h=this.getViewData(),e=this._getSelectionData(b[0]),e.element=b,e.originElement=b.context?a(b.context):null,f=this.fire("removing",e),f!==!1){if(1===arguments.length&&(c=this._getItemIndex(b[0])),d=function(){for(var a,d=b.next();d.length>0;)this._itemIndexAdd(d[0],-1),d=d.next();if(this.isMultiple()){for(a=0;a<this._selectList.length;a++)if(b[0]===this._selectList[a]){this._selectList(a,1);break}}else this._current&&this._current[0]===b[0]&&(this._current=null);this.fire("removed",e),b.remove(),h.splice(c,1)},this.option.animatable===!1)return void d.call(this);g=this.removeFirstAnimator[0],g.target=b,g.begin=0,g.end=-g.target.width(),g=this.removeSecondAnimator[0],g.target=b,g.begin=g.target.height(),g.end=0,g.target.css({height:g.begin+"px",overflow:"hidden"}),this.removeFirstAnimator.start().done(function(){return i.removeSecondAnimator.start()}).done(function(){d.call(i)})}},_selectItem:function(b,c,d,e){var f,h,i;if(f=this._getSelectionData(b[0]),f.element=b,f.originElement=b.context?a(b.context):null,h=this.fire("selecting",f),h!==!1){if(d=2===arguments.length?!b.hasClass(g):!!d,this.isMultiple())if(d)this._selectList.push(b[0]),b.addClass(g);else{for(i=0;i<this._selectList.length;i++)if(this._selectList[i]===b[0]){this._selectList.splice(i,1);break}b.removeClass(g)}else d?(this._current&&this._current.removeClass(g),this._current=b,this._current.addClass(g)):(b.removeClass(g),this._current=null);e!==!1&&(d?this.fire("selected",f):this.fire("deselected",f))}},add:function(a){var b;a&&(b=this._createItem(a,this.option.viewData.length),this.listPanel.append(b),this.option.viewData.push(a))},remove:function(a){a||this.removeAt(this._indexOf(a))},removeAt:function(b){var c;b<0||b>=this.count()||(c=a(this.listPanel.children()[b]),this._removeItem(c))},insert:function(b,c){var d,e,f,g;if(c<0&&(c=0),c>=this.option.viewData.length)return void this.add(b);for(f=this._createItem(b,c),e=this.listPanel.children(),d=a(e[c]),g=c;g<e.length;g++)this._itemIndexAdd(e[g],1);f.insertBefore(d),this.option.viewData.splice(c,0,b)},currentUp:function(){var a;if(this.isMultiple())throw new Error("The currentUp can not support for multiple selection");this._current&&(a=this._getItemIndex(this._current[0]),a>0&&this.moveTo(a,a-1))},currentDown:function(){var a;if(this.isMultiple())throw new Error("The currentDown can not support for multiple selection");this._current&&(a=this._getItemIndex(this._current[0]),a<this.count()-1&&this.moveTo(a,a+1))},moveTo:function(b,c){var d,e,f,g,h,i,j;if(g=this.getViewData(),h=this.count(),0!==h&&!(b<0||b>=h||c<0||c>=h||b===c)){if(d=this.listPanel.children(),e=a(d[b]),f=a(d[c]),b<c){for(j=c;j>b;j--)this._itemIndexAdd(d[j],-1);this._itemIndexSet(e[0],c),f.after(e)}else{for(j=c;j<b;j++)this._itemIndexAdd(d[j],1);this._itemIndexSet(e[0],c),f.before(e)}i=g[b],g.splice(b,1),g.splice(c,0,i)}},getSelection:function(){var a,b=null;if(this.isMultiple())for(b=[],a=0;a<this._selectList.length;a++)b.push(this._getSelectionData(this._selectItem[a]));else this._current&&(b=this._getSelectionData(this._current));return b},setSelection:function(b){var c,d,e,f,g;for(this.cancelSelection(),this.isMultiple()?Array.isArray(b)||(b=[b]):b=Array.isArray(b)?[b[0]]:[b],f=this.listPanel.children(),c=0,d=b.length;c<d;c++)e=b[c],g=f[e],g&&this._selectItem(a(g),e,!0,c>=d-1)},cancelSelection:function(){var b,c,d;if(this.isMultiple())for(c=0,d=this._selectList.length;c<d;c++)b=a(this._selectList[c]),b.removeClass(g);else this._current&&(this._current.removeClass(g),this._current=null);this.fire("cancel")},sort:function(a){var c,e,f,g;if(0!==this.count()){for(b.core.isFunction(a)||(a=d),c=this.listPanel.children(),this.sorter.items=c,this.sorter.sort(this.option.viewData,a),e=document.createDocumentFragment(),f=0,g=c.length;f<g;f++)this._itemIndexSet(c[f],f),e.appendChild(c[f]);this.listPanel.empty(),this.listPanel[0].appendChild(e)}},setViewData:function(a){Array.isArray(a)&&this._fill(a)},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return this.option.viewData.length},isMultiple:function(){return this.option.multiple===!0},clear:function(){this.option.viewData=[],this.listPanel.empty(),this._current=null,this._selectList=[]}}),a.fn.listView=function(a){return 0===this.length?null:b.ctrls.ListView(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a){a.showPageInfo===!0&&(a.pageInfoFormatter||(a.pageInfoFormatter={currentRowNum:function(a){return"<span>本页"+a+"行</span>"},rowCount:function(a){return"<span class='font-highlight'>共"+a+"行</span>"},pageCount:function(a){return"<span>"+a+"页</span>"}})),this.pager=b.ctrls.Pager(a),this.pageIndex=this.pager.pageIndex,this.pageSize=this.pager.pageSize}function d(a,b){for(var c,d=0,e=a.length-1,f=a.length/2;d<f;d++,e--)c=a[d],a[d]=a[e],a[e]=c,c=b[d],b[d]=b[e],b[e]=c}function e(a,c){var d,e,g,h;return d=this._lastSortColumn,e=d.sort,b.core.isFunction(e)||(e=f),g=this._prepareValue(a,d),h=this._prepareValue(c,d),e(g,h)}function f(a,b){var c,d,e;if(Array.isArray(a)){for(c=0,d=0,e=a.length;d<e;d++)if(c=g(a[d],b[d]),0!==c)return c;return c}return g(a,b)}function g(a,b){return"string"==typeof a?a.localeCompare(b):a<b?-1:a>b?1:0}function h(){var a,c;for(c in this.resetColumnStateHandlers)if(this.resetColumnStateHandlers.hasOwnProperty(c)&&(a=this.resetColumnStateHandlers[c],b.core.isFunction(a)))try{a.call(this)}catch(a){}}function i(){var a,b,c,d,e,f,g,h;if(this.tableFixedHead&&(b=this.fixedColumns),this.tableDataHead&&(c=this.dataColumns),a=b,a||(a=c),a)for(g=-1,e=0,f=this._sorterIndexes.length;e<f;e++)if(h=this._sorterIndexes[e],h<=g||!a[h]?(a=c,g=-1):g=h,d=a[h].cell,d=d.find("i"),!d.hasClass(u))return void d.attr("class","fa fa-sort")}function j(a,b){b?a.removeClass("fa-square").addClass("fa-check-square").addClass("font-highlight"):a.removeClass("fa-check-square").removeClass("font-highlight").addClass("fa-square")}function k(b){var c,d=!b.hasClass("fa-check-square");if(j(b,d),!this._gridCheckboxAll){if(c=this._getColumnIndexAndTableByFormatter(D,"text"),c===-1)return;this._gridCheckboxAll=a(this.tableHead[0].tBodies[0].rows[0].cells[c]).find("."+s)}d?this._checkedCount++:this._checkedCount--,this._checkedCount===this.count()?j(this._gridCheckboxAll,!0):j(this._gridCheckboxAll,!1)}function l(a){var c=this.option.selection.exclude,d=!0;return c&&(b.core.isString(c)?d=this._excludeElement(a,c):b.core.isFunction(c)&&(d=c.call(this,a))),d}function m(b){var c,f,g,h,j,k,l,m,n,o,p,q,r,s,t;if(b.stopPropagation(),c=this.option.viewData,Array.isArray(c)&&0!==c.length){for(f=a(b.target);"TH"!==(g=f.nodeName());){if("TR"===g)return;f=f.parent()}if(h=f.parent().parent().parent(),j=f.data("data-columnIndex")||f[0].cellIndex,k=h.hasClass("table-fixed-head")?this.fixedColumns[j]:this.dataColumns[j],this._lastSortColumn!==k&&i.call(this,f.parent()),l=e.bind(this),m=this._lastSortColumn==k,this._lastSortColumn=k,n=this.tableFixedBody?this.tableFixedBody.children("tbody"):this.tableDataBody.children("tbody"),p=n.children().get(),!Array.isArray(p)||p.length!=c.length)throw new Error("data row error");if(q=p.slice(0),o=f.find("i"),o.hasClass(v)?(d(c,p),o.removeClass(u).removeClass(v).addClass(w)):(m?d(c,p):(this.sorter.items=p,this.sorter.sort(c,l)),o.removeClass(u).removeClass(w).addClass(v)),n.append(p),this.tableFixedBody&&this.tableDataBody){for(n=this.tableDataBody.find("tbody"),p=n.children().get(),r=new Array(p.length),s=0,t=q.length;s<t;s++)r[q[s].rowIndex]=p[s];n.append(r)}this._refreshRowNumber()}}function n(a){this.reportDataHead.scrollLeft(this.reportDataBody.scrollLeft()),this.reportFixedBody.scrollTop(this.reportDataBody.scrollTop())}function o(c){var d,e,f,g,h,i,k,l,m,n,o;if(c.stopPropagation(),g=this._getColumnIndexAndTableByFormatter(D,"text")){if(d=a(c.target),f=!d.hasClass("fa-check-square"),j.call(this,d,f),this.option.selection.isRelateCheckbox===!0&&this.isMultiple())if(l="cell"===this.option.seletion.type?"cell-selected":"row-selected",f)m=function(a,b){var c;c="cell"===this.option.selection.type?a:a.parent(),c.context=b[0],this._selectItem(c,l,f)};else{for(n=0,o=this._selectList.length;n<o;n++)a(this._selectList[n]).removeClass(l).removeClass("background-highlight");this._selectList=[]}for(h=g.bodyTable[0].tBodies[0].rows,n=0,o=h.length;n<o;n++)e=a(h[n].cells[g.columnIndex]).find("."+r),e.length>0&&(b.core.isFunction(m)?(i||(i=this.tableDataBody[0].tBodies[0].rows),k=a(i[n].cells[0]),m.call(this,k,e)):j.call(this,e,f));f?this._checkedCount=this.count():this._checkedCount=0}}function p(b){var c,d,e;if(c=a(b.target),l.call(this,c)!==!1){if(c.hasClass(r)&&!this.option.selection.isRelateCheckbox)return void k.call(this,c);if("cell"!==this.option.selection.type&&this.tableDataBody){for(;"TR"!==(e=c.nodeName());){if("TBODY"===e)return;c=c.parent()}d=c[0].rowIndex,c=a(this.tableDataBody[0].rows[d]),c.context=b.target,this._selectItem(c,"row-selected")}}}function q(b){var c,d,e,f;if(c=a(b.target),l.call(this,c)!==!1){if(c.hasClass(r)&&!this.option.selection.isRelateCheckbox)return void k.call(this,c);for(d="cell"===this.option.selection.type?"TD":"TR",e="cell"===this.option.selection.type?"cell-selected":"row-selected";(f=c.nodeName())!==d;){if("TBODY"===f)return;c=c.parent()}c[0]!==b.target&&(c.context=b.target),this._selectItem(c,e)}}var r="grid-checkbox",s="grid-checkbox-all",t="last-cell",u="fa-sort",v="fa-sort-asc",w="fa-sort-desc",x="empty-row",y="DataBody",z=30,A=40,B=/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,C=/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,D=b.ColumnStyle.cnfn.checkAll,E=b.ColumnStyle.cfn.check,F=b.ColumnStyle.cnfn.columnText,G=b.ColumnStyle.cfn.text,H=b.ColumnStyle.cfn.rowNumber;b.define("ui.ctrls.ReportView",{_defineOption:function(){return{fixedGroupColumns:null,dataGroupColumns:null,viewData:null,promptText:"没有数据",height:!1,width:!1,suitable:!0,pager:{pageIndex:1,pageSize:100,pageButtonCount:10,showPageInfo:!1,pageInfoFormatter:null},selection:{type:"row",exclude:!1,multiple:!1,isRelateCheckbox:!0}}},_defineEvents:function(){var a=["selecting","selected","deselected","rebind","cancel"];return this.option.pager&&a.push("pagechanging"),a},_create:function(){this._selectList=[],this._sorterIndexes=[],this._hasPrompt=!!this.option.promptText,this.resetColumnStateHandlers={},this.reportHead=null,this.reportFixedHead=null,this.reportDataHead=null,this.reportBody=null,this.reportFixedBody=null,this.reportDataBody=null,this.columnHeight=this.rowHeight=z,this.pagerHeight=30,this.option.pager&&c.call(this,this.option.pager),this.option.selection?(b.core.isString(this.option.selection.type)?this.option.selection.type=this.option.selection.type.toLowerCase():this.option.selection.type="disabled",this.option.selection.multiple||(this.option.selection.isRelateCheckbox=!1)):this.option.selection={type:"disabled"},(!b.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=!1),(!b.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=!1),this.sorter=b.Introsort(),this._checkedCount=0,this.onSortHandler=m.bind(this),this.onCheckboxAllClickHandler=o.bind(this),this.onScrollingHandler=n.bind(this),this.onTableFixedBodyClickHandler=p.bind(this),this.onTableDataBodyClickHandler=q.bind(this)},_render:function(){this.element.hasClass("ui-report-view")||this.element.addClass("ui-report-view"),this._initBorderWidth(),this.reportHead=a("<div class='ui-report-head' />"),
this.reportFixedHead=a("<div class='fixed-head' />"),this.reportDataHead=a("<div class='data-head'>"),this.reportHead.append(this.reportFixedHead).append(this.reportDataHead),this.element.append(this.reportHead),this._initSuitable(),this.reportBody=a("<div class='ui-report-body' />"),this.reportFixedBody=a("<div class='fixed-body' />"),this._fixedBodyScroll=a("<div class='fixed-body-scroll' />").css("height",b.scrollbarHeight),this.reportDataBody=a("<div class='data-body' />"),this._initDataPrompt(),this.reportDataBody.scroll(this.onScrollingHandler),this.reportBody.append(this.reportFixedBody).append(this._fixedBodyScroll).append(this.reportDataBody),this.element.append(this.reportBody),this._initPagerPanel(),this.setSize(this.option.width,this.option.height),this.createReportHead(this.option.fixedGroupColumns,this.option.dataGroupColumns),Array.isArray(this.option.viewData)&&this.createReportBody(this.option.viewData,this.option.viewData.length)},_initBorderWidth:function(){var a=function(a){return parseInt(this.element.css(a),10)||0};this.borderWidth=0,this.borderHeight=0,this.borderWidth+=a.call(this,"border-left-width"),this.borderWidth+=a.call(this,"border-right-width"),this.borderHeight+=a.call(this,"border-top-width"),this.borderHeight+=a.call(this,"border-bottom-width")},_initDataPrompt:function(){var c;this._hasPrompt&&(this._dataPrompt=a("<div class='data-prompt' />"),c=this.option.promptText,b.core.isString(c)&&c.length>0?this._dataPrompt.html("<span class='font-highlight'>"+c+"</span>"):b.core.isFunction(c)&&(c=c(),this._dataPrompt.append(c)),this.reportDataBody.append(this._dataPrompt))},_initSuitable:function(){this.option.suitable&&(this._fitLine=a("<hr class='fit-line background-highlight' />"),this.element.append(this._fitLine),this.dragger=b.MouseDragger({context:this,target:this._fitLine,handle:this.reportDataHead,onBeginDrag:function(b){var c,d,e,f,g,h;return c=a(b.target),!!c.isNodeName("b")&&(e=this.option,d=e.context,f=c.offset(),g=d.element.offset(),h=f.left-g.left+c.width(),e.th=c.parent(),e.beginLeft=h,e.endLeft=h,e.leftLimit=g.left,e.rightLimit=g.left+d.element.outerWidth(),void e.target.css({left:h+"px",display:"block"}))},onMoving:function(a){var b,c,d;b=this.option,c=b.context,d=parseFloat(b.target.css("left")),d+=a.x,d<b.leftLimit?d=b.leftLimit:d>b.rightLimit&&(d=b.rightLimit),b.endLeft=d,b.target.css("left",d+"px")},onEndDrag:function(b){var c,d,e,f,g,h;c=this.option,d=c.context,c.target.css("display","none"),e=c.th.data("data-columnIndex"),f=d.dataColumns[e],f&&c.endLeft!==c.beginLeft&&(g=f.len+(c.endLeft-c.beginLeft),g<30&&(g=30),f.len=g,h=function(b){var c;b&&(c=b.children("colgroup").children()[e],c&&(c=a(c),c.css("width",f.len+"px")))},h(d.tableDataHead),h(d.tableDataBody),d._updateScrollState())}}),this.dragger.on())},_initPagerPanel:function(){this.pager&&(this.reportFoot=a("<div class='ui-report-foot clear' />"),this.element.append(this.reportFoot),this.pager.pageNumPanel=a("<div class='page-panel' />"),this.option.pager.displayDataInfo?(this.pager.pageInfoPanel=a("<div class='data-info' />"),this.reportFoot.append(this.pager.pageInfoPanel)):this.pager.pageNumPanel.css("width","100%"),this.reportFoot.append(this.pager.pageNumPanel),this.pager.pageChanged(function(a,b){this.pageIndex=a,this.pageSize=b,this.fire("pagechanging",a,b)},this))},_createFixedHead:function(b,c){this.tableFixedHead?this.tableFixedHead.html(""):(this.tableFixedHead=a("<table class='table-fixed-head' cellspacing='0' cellpadding='0' />"),this.reportFixedHead.append(this.tableFixedHead)),this._fixedColumnWidth=0,this._createHeadTable(this.tableFixedHead,b,c,function(a){a.len||(a.len=A),this._fixedColumnWidth+=a.len+1}),this.reportFixedHead.css("width",this._fixedColumnWidth+"px")},_createDataHead:function(b,c){this.tableDataHead?this.tableDataHead.html(""):(this.tableDataHead=a("<table class='table-data-head' cellspacing='0' cellpadding='0' />"),this.reportDataHead.append(this.tableDataHead),this.reportDataHead.css("left",this._fixedColumnWidth+"px")),this._createHeadTable(this.tableDataHead,b,c,function(a,b,c,d){c==d-1&&b.addClass(t)},function(b,c,d){var e,f,g;this._dataHeadScrollCol=a("<col style='width:0' />"),d.append(this._dataHeadScrollCol),e=c.parent().children(),f=e.length,g=a("<th class='ui-report-head-cell scroll-cell' />"),f>1&&g.attr("rowspan",f),a(e[0]).append(g)})},_createFixedBody:function(b,c){this.tableFixedBody?(this.reportFixedBody.scrollTop(0),this._emptyFixed()):(this.tableFixedBody=a("<table class='table-fixed-body' cellspacing='0' cellpadding='0' />"),this.isSelectable()&&this.tableFixedBody.click(this.onTableFixedBodyClickHandler),this.reportFixedBody.append(this.tableFixedBody)),0!==b.length&&(this._createBodyTable(this.tableFixedBody,b,c),this.reportFixedBody.css("width",this._fixedColumnWidth+"px"),this._fixedBodyScroll.css("width",this._fixedColumnWidth+"px"))},_createDataBody:function(c,d,e){var f=!1;return this.tableDataBody?(this.reportDataBody.scrollTop(0),this._emptyData(),f=!0):(this.tableDataBody=a("<table class='table-data-body' cellspacing='0' cellpadding='0' />"),this.isSelectable()&&this.tableDataBody.click(this.onTableDataBodyClickHandler),this.reportDataBody.append(this.tableDataBody),this.reportDataBody.css("left",this._fixedColumnWidth+"px")),0===c.length?void this._showDataPrompt():(this._hideDataPrompt(),this._createBodyTable(this.tableDataBody,c,d,{type:y}),this._updateScrollState(),b.core.isNumber(e)&&this._renderPageList(e),void(f&&this.fire("rebind")))},_createHeadTable:function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=0;if(h=b.core.isFunction(f),t=c.hasClass("table-data-head"),j=a("<thead />"),Array.isArray(e))for(o=0;o<e.length;o++){for(q=e[o],k=a("<tr />"),q&&0!==q.length||k.addClass(x),s=0,p=0;p<q.length;p++){if(m=q[p],l=this._createCell("th",m),l.addClass("ui-report-head-cell"),b.core.isFunction(m.text)?n=m.text.call(this,m,l):m.text&&(n=F.call(this,m,l)),n&&l.append(n),m.column||b.core.isFunction(m.formatter)){for(m._columnKeys||(m._columnKeys={});d[s];)s++;this._setSorter(l,m,s),delete m.rowspan,delete m.colspan,l.data("data-columnIndex",s),m.cell=l,m.columnIndex=s,d[s]=m}this.option.fitColumns&&t&&l.append("<b class='fit-column-handle' />"),k.append(l),s+=m.colspan||1}j.append(k),u+=this.rowHeight}for(i=a("<colgroup />"),o=0;o<d.length;o++)m=d[o],m.cellIndex=o,i.append(this._createCol(m)),r=[m,m.cell],h&&(r.push(o),r.push(d.length),f.apply(this,r));b.core.isFunction(g)&&g.call(this,c,k,i),u>this.columnHeight&&(this.columnHeight=u),c.append(i),c.append(j)},_createBodyTable:function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p;for(o=e.length,p=f&&f.type===y,this._tempHandler=null,h=a("<colgroup />"),n=0;n<o;n++)l=e[n],h.append(this._createCol(l));for(i=a("<tbody />"),m=0;m<d.length;m++)k=a("<tr />"),j=d[m],this._createRowCells(k,j,m,e,p),i.append(k);c.append(h),c.append(i),b.core.isFunction(g)&&g.call(this,c)},_createRowCells:function(a,c,d,e,f){var g,h,i,j,k,l,m,n;for(i="cell"!==this.option.selection.type,i&&a.addClass("table-body-row-hover"),g=e.length,j=0;j<g;j++)k=e[j],h=k.formatter,b.core.isFunction(h)||(h=G),l=this._prepareValue(c,k),m=this._createCell("td",k),m.addClass("ui-table-body-cell"),i||m.addClass("table-body-cell-hover"),n=h.call(this,l,k,d,m),m.isAnnulment||(n&&m.append(n),f&&j===g-1&&m.addClass(t),a.append(m))},_prepareValue:function(a,b){var c,d,e;if(Array.isArray(b.column))for(c={},d=0,e=b.column.length;d<e;d++)c[d]=c[b.column[d]]=this._getValue(a,b.column[d],b);else c=this._getValue(a,b.column,b);return c},_getValue:function(a,c,d){var e,f,g=0;if(!b.core.isString(c))return null;for(d._columnKeys.hasOwnProperty(c)||(d._columnKeys[c]=c.split(".")),e=d._columnKeys[c],f=a[e[g]],g=1;g<e.length;g++)if(f=f[e[g]],void 0===f||null===f)return f;return f},_createCol:function(c){var d=a("<col />");return b.core.isNumber(c.len)&&d.css("width",c.len+"px"),d},_createCell:function(c,d){var e=a("<"+c+" />"),f={};return b.core.isNumber(d.colspan)&&e.prop("colspan",d.colspan),b.core.isNumber(d.rowspan)&&(e.prop("rowspan",d.rowspan),d.rowspan>1&&e.css("height",d.rowspan*this.rowHeight-1)),d.align&&(f["text-align"]=d.align),e.css(f),e},_setSorter:function(a,c,d){(c.sort===!0||b.core.isFunction(c.sort))&&(a.click(this.onSortHandler),a.addClass("sorter"),a.append("<i class='fa fa-sort' />"),this._sorterIndexes.push(d))},_renderPageList:function(a){this.pager&&(this.pager.data=this.option.viewData,this.pager.pageIndex=this.pageIndex,this.pager.pageSize=this.pageSize,this.pager.renderPageList(a))},_updateScrollState:function(){var a,c,d,e;this.reportDataBody&&this.tableDataHead&&(a=this.reportDataBody.height(),c=this.reportDataBody.width(),d=this.reportDataBody[0].scrollHeight,e=this.reportDataBody[0].scrollWidth,d>a?this._dataHeadScrollCol.css("width",b.scrollbarWidth+.1+"px"):this._dataHeadScrollCol.css("width","0"),e>c?(this.reportFixedBody.css("height",a-b.scrollbarWidth+"px"),this._fixedBodyScroll.css("display","block")):(this.reportFixedBody.css("height",a+"px"),this._fixedBodyScroll.css("display","none")))},_refreshRowNumber:function(c,d){var e,f,g,h,i,j,k,l;if(e=this.option.viewData,e&&0!==e.length&&(g=H,f=this._getColumnIndexAndTableByFormatter(g)))for(b.core.isNumber(c)||(c=0),h=f.bodyTable[0].rows,j=f.columns[f.columnIndex],l=b.core.isNumber(d)?d+1:h.length,k=c;k<l;k++)i=a(h[k].cells[f.columnIndex]),i.html(""),i.append(g.call(this,null,j,k))},_emptyFixed:function(){this.tableFixedBody&&(this.tableFixedBody.html(""),h.call(this),this._lastSortColumn=null)},_emptyData:function(){this.tableDataBody&&(this.tableDataBody.html(""),this._selectList=[],this._current=null),this.pager&&this.pager.empty()},_getColumnIndexAndTableByFormatter:function(a,b){var c,d,e;if(c={columnIndex:-1,columns:null,headTable:null,bodyTable:null},b||(b="formatter"),this.fixedColumns)for(d=0,e=this.fixedColumns.length;d<e;d++)if(this.fixedColumns[d][b]===a)return c.columnIndex=d,c.columns=this.fixedColumns,c.headTable=this.tableFixedHead,c.bodyTable=this.tableFixedBody,c;if(this.dataColumns)for(d=0,e=this.dataColumns.length;d<e;d++)if(this.dataColumns[d][b]===a)return c.columnIndex=d,c.columns=this.dataColumns,c.headTable=this.tableDataHead,c.bodyTable=this.tableDataBody,c;if(c.columnIndex===-1)return null},_getSelectionData:function(a){var b={};return"cell"===this.option.selection.type?(b.rowIndex=a.parent().prop("rowIndex"),b.cellIndex=a.prop("cellIndex"),b.rowData=this.option.viewData[b.rowIndex],b.column=this.option.columns[b.cellIndex].column):(b.rowIndex=a.prop("rowIndex"),b.rowData=this.option.viewData[b.rowIndex]),b},_excludeElement:function(a,c){var d,e,f,g,h=a.nodeName().toLowerCase(),i=c.split(",");for(f=0,g=i.length;f<g;f++)if(d=b.str.trim(i[f]),e=d.match(C)){if(d=d.match(B)[1],d===h)return a.attr(e[1])!==e[4]}else if(d.toLowerCase()===h)return!1},_selectItem:function(b,c,d){var e,f,g,h,i,k;if(e=this._getSelectionData(b),e.element=b,e.originElement=b.context?a(b.context):null,f=this.fire("selecting",e),f!==!1)if(this.isMultiple()){if(b.hasClass(c)){if(d===!0)return;for(d=!1,i=0,k=this._selectList.length;i<k;i++)if(this._selectList[i]===b[0]){this._selectList.splice(i,1);break}b.removeClass(c).removeClass("background-highlight"),this.fire("deselected",e)}else{if(d===!1)return;d=!0,this._selectList.push(b[0]),b.addClass(c).addClass("background-highlight"),this.fire("selected",e)}this.option.selection.isRelateCheckbox&&(e.originElement&&e.originElement.hasClass(r)&&(h=e.originElement),h||(g=this._getColumnIndexAndTableByFormatter(E),g&&(h=a("cell"===this.option.selection.type?b.parent()[0].cells[colIndex]:b[0].cells[colIndex]),h=h.find("."+r))),h&&h.length>0&&j.call(this,h,d))}else{if(this._current&&(this._current.removeClass(c).removeClass("background-highlight"),this._current[0]===b[0]))return this._current=null,void this.fire("deselected",e);this._current=b,b.addClass(c).addClass("background-highlight"),this.fire("selected",e)}},_promptIsShow:function(){return this._hasPrompt&&"block"===this._dataPrompt.css("display")},_setPromptLocation:function(){var a=this._dataPrompt.height();this._dataPrompt.css("margin-top",-(a/2)+"px")},_showDataPrompt:function(){this._hasPrompt&&(this._dataPrompt.css("display","block"),this._setPromptLocation())},_hideDataPrompt:function(){this._hasPrompt&&this._dataPrompt.css("display","none")},createReportHead:function(a,b){Array.isArray(a)&&(this.fixedColumns=[],Array.isArray(a[0])||(a=[a]),this._createFixedHead(this.fixedColumns,a)),Array.isArray(b)&&(this.dataColumns=[],Array.isArray(b[0])||(b=[b]),this._createDataHead(this.dataColumns,b)),this.reportFixedHead.css("height",this.columnHeight+"px"),this.reportDataHead.css("height",this.columnHeight+"px"),this.reportHead.css("height",this.columnHeight+"px")},createReportBody:function(a,b){Array.isArray(a)||(a=[]),this.option.viewData=a,this.fixedColumns&&Array.isArray(this.fixedColumns)&&this._createFixedBody(a,this.fixedColumns),this.dataColumns&&Array.isArray(this.dataColumns)&&this._createDataBody(a,this.dataColumns,b)},getCheckedValues:function(){var c,d,e,f,g,h="."+r,i=[];if(c=this._getColumnIndexAndTableByFormatter(E),!c)return i;for(d=c.bodyTable[0].tBodies[0].rows,f=0,g=d.length;f<g;f++)e=a(d[f].cells[c.columnIndex]).find(h),e.length>0&&i.push(b.str.htmlDecode(e.attr("data-value")));return i},getSelection:function(){var b,c,d;if(!this.isSelectable())return null;if(this.isMultiple())for(b=[],c=0,d=this._selectList.length;c<d;c++)b.push(this._getSelectionData(a(this._selectList[c])));else b=null,this._current&&(b=this._getSelectionData(this._current));return b},cancelSelection:function(){var b,c,d,e,f,g,h;if(this.isSelectable()){if(b="cell"===this.option.selection.type?"cell-selected":"row-selected",this.option.selection.isRelateCheckbox?(e="."+r,d=this._getColumnIndexAndTableByFormatter(E),f=function(c){var f,g,h;d&&(g="cell"===this.option.selection.type?c.parent()[0].rowIndex:c[0].rowIndex,h=a(d.bodyTable[0].tBodies[0].rows[g]),f=a(h[0].cells[d.columnIndex]),f=f.find(e),j(f,!1)),c.removeClass(b).removeClass("background-highlight")}):f=function(a){a.removeClass(b).removeClass("background-highlight")},this.isMultiple()){if(0===this._selectList.length)return;for(g=0,h=this._selectList.length;g<h;g++)c=a(this._selectList[g]),f.call(this,c);this._selectList=[]}else{if(!this._current)return;f.call(this,this._current),this._current=null}this.fire("cancel")}},removeRowAt:function(){var c,d,e,f,g,h,i,j,k;if(e=this.option.viewData,e&&(h=arguments.length,0!==h)){for(d=[],g=0;g<h;g++)c=arguments[g],b.core.isNumber(c)&&c>=0&&c<e.length&&d.push(c);if(h=d.length,h>0){for(d.sort(function(a,b){return b-a}),j=this.option.selection.type,i=this.isMultiple(),"row"===j?k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&this._current[0].rowIndex===a&&(this._current=null)}:"cell"===j&&(k=function(a){var b,c,d;if(i){for(b=0,c=this._selectList.length;b<c;b++)if(d=this._selectList[b],d=d.parentNode,a===d.rowIndex)return void this._selectList.splice(b,1)}else this._current&&(d=this._current.parent(),d[0].rowIndex===a&&(this._current=null))}),g=0;g<h;g++)c=d[g],f=a(this.tableDataBody[0].rows[c]),f.remove(),this.tableFixedBody&&a(this.tableFixedBody[0].rows[c]).remove(),e.splice(c,1),k&&k.call(this,c);this._updateScrollState(),this._refreshRowNumber(c)}}},updateRow:function(b,c){var d,e,f;d=this.option.viewData,d&&(b<0||b>d.length||(f=a(this.tableBody[0].rows[b]),0!==f.length&&(thsi.tableFixedBody&&(e=a(this.tableFixedBody[0].rows[b]),e.empty(),this._createRowCells(e,c,b,this.fixedColumns)),f.empty(),d[b]=c,this._createRowCells(f,c,b,this.dataColumns,!0))))},addRow:function(b){var c,d;if(b){if(c=this.option.viewData,!Array.isArray(c)||0===c.length)return this.tableFixedBody&&(this.tableFixedBody.remove(),this.tableFixedBody=null),this.tableDataBody&&(this.tableDataBody.remove(),this.tableDataBody=null),void this.createReportBody([data]);this.tableFixedBody&&(d=a("<tr />"),this._createRowCells(d,b,c.length,this.fixedColumns),a(this.tableFixedBody[0].tBodies[0]).append(d)),this.tableDataBody&&(d=a("<tr />"),this._createRowCells(d,b,c.length,this.dataColumns,!0),a(this.tableDataBody[0].tBodies[0]).append(d)),c.push(b),this._updateScrollState()}},insertRow:function(b,c){var d,e;if(c){if(d=this.option.viewData,!Array.isArray(d)||0===d.length)return void this.addRow(c);b<0&&(b=0),b<d.length?(this.tableFixedBody&&(e=a("<tr />"),this._createRowCells(e,c,b,this.fixedColumns),a(this.tableFixedBody[0].rows[b]).before(e),d.splice(b,0,c)),this.tableDataBody&&(e=a("<tr />"),this._createRowCells(e,c,b,this.dataColumns,!0),a(this.tableDataBody[0].rows[b]).before(e),d.splice(b,0,c)),this._updateScrollState(),this._refreshRowNumber()):this.addRow(c)}},currentRowUp:function(){var a;if(this.isMultiple())throw new Error("The currentRowUp can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowUp can not support for cell selection");a=this.getSelection(),a&&0!==a.rowIndex&&this.moveRow(a.rowIndex,a.rowIndex-1)},currentRowDown:function(){var a;if(this.isMultiple())throw new Error("The currentRowDown can not support for multiple selection");if("cell"===this.option.selection.type)throw new Error("The currentRowDown can not support for cell selection");a=this.getSelection(),!a||a.rowIndex>=this.count()||this.moveRow(a.rowIndex,a.rowIndex+1)},moveRow:function(b,c){var d,e,f,g;d=this.option.viewData,0!==d.length&&(c<0?c=0:c>=d.length&&(c=d.length-1),b!==c&&(c>rowIndex?(this.tableFixedBody&&(e=this.tableFixedBody[0].tBodies[0].rows,f=a(e[c]),f.after(a(e[b]))),thsi.tableDataBody&&(e=this.tableDataBody[0].tBodies[0].rows,f=a(e[c]),f.after(a(e[b]))),this._refreshRowNumber(b,c)):(this.tableFixedBody&&(e=this.tableFixedBody[0].tBodies[0].rows,f=a(e[c]),f.before(a(e[b]))),thsi.tableDataBody&&(e=this.tableDataBody[0].tBodies[0].rows,f=a(e[c]),f.before(a(e[b]))),this._refreshRowNumber(c,b)),g=d[b],d.splice(b,1),d.splice(c,0,g)))},getRowData:function(a){var c=this.option.viewData;return Array.isArray(c)&&0!==c.length?!b.core.isNumber(a)||a<0||a>=c.length?null:c[a]:null},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},count:function(){return Array.isArray(this.option.viewData)?0:this.option.viewData.length},isSelectable:function(){var a=this.option.selection.type;return"row"===a||"cell"===a},isMultiple:function(){return this.option.selection.multiple===!0},clear:function(){this.option.viewData=[],this._checkedCount=0,this._emptyFixed(),this._emptyData(),i.call(this),this._showDataPrompt()},setSize:function(a,c){1===arguments.length&&(c=a,a=null),b.core.isNumber(c)&&(c-=this.columnHeight+this.borderHeight,this.pager&&(c-=this.pagerHeight),this.reportBody.css("height",c+"px"),this.reportFixedBody.css("height",c+"px"),this.reportDataBody.css("height",c+"px")),b.core.isNumber(a)&&(a-=this.borderWidth,this.element.css("width",a+"px")),this._updateScrollState(),this._promptIsShow()&&this._setPromptLocation()}}),a.fn.reportView=function(a){if(0!==this.length)return b.ctrls.ReportView(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a){return this instanceof c?void this.initialize(a):new c(a)}function d(a){return this instanceof d?void this.initialize(a):new d(a)}function e(){return this instanceof e?void this.initialize():new e}var f="ui-tab-selection";c.prototype={constructor:c,initialize:function(a){var c;this.tabView=a,this.animationCssItem=a.isHorizontal?"left":"top",c=this,this.animator=b.animator({ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css(c.animationCssItem,a+"px")}}).addTarget({ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css(c.animationCssItem,a+"px")}}),this.animator.onEnd=function(){a._current.css("display","none"),a._current=c.nextView,c.nextView=null,a.fire("changed",c.currentIndex)},b.core.isNumber(a.option.duration)?this.animator.duration=a.option.duration:this.animator.duration=500,this._initBodies()},_initBodies:function(){var b,c,d;for(b=this.tabView,b._current=a(b.bodies[0]),c=1,d=b.bodies.length;c<d;c++)a(b.bodies[c]).css("display","none")},_setCurrent:function(a,b,c){var d,e,f,g;if(d=this.tabView,this.currentIndex!==b&&(result=d.fire("changing",b),result!==!1)){if(c===!1)return this.bodySet(b),void d.fire("changed",b);this.nextView=a,g=d.isHorizontal?d.bodyWidth:d.bodyHeight,b>this.currentIndex?(this.nextView.css(this.animationCssItem,g+"px"),f=!0):(this.nextView.css(this.animationCssItem,-g+"px"),f=!1),e=this.animator[0],e.target=d._current,e.begin=parseFloat(e.target.css(this.animationCssItem)),f?e.end=-g:e.end=g,e=this.animator[1],e.target=this.nextView,e.begin=parseFloat(e.target.css(this.animationCssItem)),e.end=0,e.target.css("display","block"),this.animator.start()}},bodySet:function(b){var c,d;d=this.tabView,c=d.bodies,d._current&&d._current.removeClass(f).css("display","none"),this.currentIndex=b,d._current=a(c[b]),d._current.css({display:"block",top:"0",left:"0"})},showIndex:function(b,c){var d,e;d=this.tabView,e=d.bodies,b>=0&&b<e.length&&this._setCurrent(a(e[b]),b,c)},putBodies:function(a,b){},restore:function(a){}},d.prototype={constructor:d,initialize:function(a){var c;this.tabView=a,this.animator=b.animator({target:a.bodyPanel,ease:b.AnimationStyle.easeFromTo}),b.core.isNumber(a.option.duration)?this.animator.duration=a.option.duration:this.animator.duration=800,c=this,a.isHorizontal?(this.animator[0].onChange=function(b){a.bodyPanel.scrollLeft(b)},this.bodyShow=function(b){return c.animator.stop(),c.animator[0].begin=a.bodyPanel.scrollLeft(),c.animator[0].end=b*a.bodyWidth,c.animator.start()}):(this.animator[0].onChange=function(b){a.bodyPanel.scrollTop(b)},this.bodyShow=function(b){return c.animator.stop(),c.animator[0].begin=a.bodyPanel.scrollTop(),c.animator[0].end=b*a.bodyHeight,c.animator.start()}),this._initTabs(),this._initBodies()},_initTabs:function(){var b,c;c=this.tabView,c.tabPanel&&0!==c.tabPanel.length&&(c.tabs=c.tabPanel.find(".ui-tab-button"),c.tabs.addClass("font-highlight-hover"),b=this,c.tabPanel.click(function(d){for(var e=a(d.target);!e.hasClass("ui-tab-button");){if(e[0]===c.tabPanel[0])return;e=e.parent()}b._setCurrent(e)}))},_initBodies:function(){},_setCurrent:function(a,c,d){var e,g;e=this.tabView,e._current&&e._current[0]===a[0]||(b.core.isNumber(c)||(c=e.getViewIndex(a)),g=e.fire("changing",c),g!==!1&&(e._current&&e.tabs&&e._current.removeClass(f).removeClass("border-highlight").removeClass("font-highlight"),e._current=a,e._current.addClass(f),e.tabs&&e._current.addClass("border-highlight").addClass("font-highlight"),d===!1?(this.bodySet(c),e.fire("changed",c)):this.bodyShow(c).done(function(){e.fire("changed",c)})))},bodySet:function(a){var b=this.tabView;b.isHorizontal?b.bodyPanel.scrollLeft(b.bodyWidth*a):b.bodyPanel.scrollTop(b.bodyHeight*a)},showIndex:function(b,c){var d,e;d=this.tabView,e=d.tabs||d.bodies,b>=0&&b<e.length&&this._setCurrent(a(e[b]),b,c)},putBodies:function(b,c){var d,e,f,g,h=0;if(d=this.tabView,d.isHorizontal)for(e=0,f=d.bodies.length;e<f;e++)g=a(d.bodies[e]),g.css("left",h+"px"),h+=b||0;else for(e=0,f=d.bodies.length;e<f;e++)g=a(d.bodies[e]),g.css("top",h+"px"),h+=c||0},restore:function(a){var b,c;c=this.tabView,c._current&&(b=c.getViewIndex(c._current),a===!1?this.bodySet(b):this.bodyShow(b))}},b.define("ctrls.TabView",{_defineOption:function(){return{type:"tab",tabPanel:null,bodyPanel:null,bodies:null,direction:"horizontal",duration:800}},_defineEvents:function(){return["changing","changed"]},_create:function(){this.tabPanel=null,this.bodyPanel=null,this.option.tabPanel&&(this.tabPanel=b.getJQueryElement(this.option.tabPanel)),this.option.bodyPanel&&(this.bodyPanel=b.getJQueryElement(this.option.bodyPanel)),this.bodies=this.option.bodies,this.bodies?this.bodyPanel||(this.bodyPanel=this.bodies.parent()):this.bodies=this.bodyPanel.children(".ui-tab-body"),this.isHorizontal="vertical"!==this.option.direction},_render:function(){"view"===this.option.type?this.model=c(this):this.model=d(this)},getCurrentIndex:function(){return this.getViewIndex(this._current)},getViewIndex:function(a){var b,c,d;if(d=this.tabs||this.bodies,a=a||this._current,d&&a)for(b=0,c=d.length;b<c;b++)if(d[b]===a[0])return b;return 0},showIndex:function(a,c){b.core.isNumber(a)||(a=0),this.model.showIndex(a,!!c)},putBodies:function(a,c){b.core.isNumber(a)||(a=this.bodyPanel.width()),b.core.isNumber(c)||(c=this.bodyPanel.height()),this.bodyWidth=a,this.bodyHeight=c,this.model.putBodies(a,c)},restore:function(){this.model.restore()}}),e.prototype={constructor:e,initialize:function(){this.tabTools=[],this.tabLoadStates=[],this.tabChanging=function(a,b){this.showTools(b)},this.tabChanged=null},addTools:function(){var c,d,e,f,g;for(c=0,d=arguments.length;c<d;c++){if(f=arguments[c],b.core.isString(f))e=a("#"+f),0===e.length&&(e=void 0);else if(Array.isArray(f)){for(e=[],g=0;g<f.length;g++)e.push(a("#"+f[g])),0===e[e.length-1].length&&e.pop();1===e.length&&(e=e[0])}this.tabTools.push(e)}},showTools:function(a){var b,c,d,e,f;for(b=0,c=this.tabTools.length;b<c;b++)if(e=this.tabTools[b])if(f=b===a?"block":"none",Array.isArray(e))for(d=0;d<e.length;d++)e[d].css("display",f);else e.css("display",f)},callWithCache:function(a,c,d){var e,f,g;if(b.core.isFunction(c)){for(e=[],g=arguments.length,f=3;f<g;f++)e.push(arguments[f]);this.tabLoadStates[a]||(func.apply(d,e),this.tabLoadStates[a]=!0)}},resetAt:function(a){a<0||a>=this.tabLoadStates.length||(this.tabLoadStates[a]=!1)},reset:function(){var a,b;for(a=0,b=this.tabLoadStates.length;a<b;a++)this.tabLoadStates[a]=!1}},b.ctrls.TabView.TabManager=e}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.TreeView",b.ctrls.SelectionTree,{_render:function(){var a;this.treePanel=this.element,a=this.treePanel.css("position"),this.treePanel.addClass("ui-selection-tree-panel").addClass("ui-tree-view-panel").css("position",a),this.treePanel.click(this.onTreeItemClickHandler),Array.isArray(this.option.viewData)&&this._fill(this.option.viewData)}}),a.fn.treeView=function(a){if(0!==this.length)return b.ctrls.TreeView(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(){}function d(a){var c=this.option.checkHandler,d=this;this.disabled||(clearTimeout(this.backTimeHandler),b.core.isFunction(c)&&c.call(this)===!1||(0===this.state?(this._next(),this.backTimeHandler=setTimeout(function(){d._back()},this.option.backTime)):1===this.state&&(this._next(),this.option.handler.call(this))))}b.define("ui.ctrls.ConfirmButton",{_defineOption:function(){return{disabled:!1,backTime:3e3,checkHandler:!1,handler:!1,color:null,backgroundColor:null}},_create:function(){this.state=0,this.animating=!1,("number"!==b.core.type(this.option.backTime)||this.option.backTime<=0)&&(this.option.backTime=5e3),b.core.isFunction(this.option.handler)||(this.option.handler=c),this.option.disabled=!!this.option.disabled,this.onButtonClickHandler=d.bind(this),this.defineProperty("disabled",this.getDisabled,this.setDisabled),this.defineProperty("text",this.getText,this.setText)},_render:function(){var b,c,d;b=this.element.text().trim(),c=a("<span class='text-state' />"),d=a("<i class='confirm-state' />"),c.text(b),this.option.backgroundColor||(this.option.backgroundColor=this.element.css("color")),d.text("确定").css("background-color",this.option.backgroundColor),this.option.color&&d.css("color",this.option.color),this.element.addClass("confirm-button"),this.element.css("width",this.element.width()+"px"),this.element.empty().append(c).append(d),this.element.click(this.onButtonClickHandler),this._initAnimation(),this.disabled=this.option.disabled},_initAnimation:function(){this.changeAnimator=b.animator({target:textState,ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("margin-left",a+"%")}}).addTarget({target:confirmState,ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"%")}}),this.changeAnimator.duration=200},_back:function(){var a,b;this.animating||(this.state=0,b=this.changeAnimator[0],b.target.css("margin-left","-200%"),b.begin=-200,b.end=0,b=this.changeAnimator[1],b.target.css("left","0%"),b.begin=0,b.end=100,this.animating=!0,a=this,this.changeAnimator.start().done(function(){a.animating=!1}))},_next:function(a){var b,c;this.animating||(0===this.state?(c=this.changeAnimator[0],c.target.css("margin-left","0%"),c.begin=0,c.end=-200,c=this.changeAnimator[1],c.target.css("left","100%"),c.begin=100,c.end=0,this.state=1):(c=this.changeAnimator[0],c.target.css("margin-left","100%"),c.begin=100,c.end=0,c=this.changeAnimator[1],c.target.css("left","0%"),c.begin=0,c.end=-100,this.state=0),this.animating=!0,b=this,this.changeAnimator.start().done(function(){b.animating=!1}))},getDisabled:function(){return this.option.disabled},setDisabled:function(a){this.option.disabled=!!a,this.option.disabled?this.element.attr("disabled","disabled"):this.element.removeAttr("disabled")},getText:function(){var a=this.element.children(".text-state");return a.text()},setText:function(a){var c=this.element.children(".text-state");c.text(b.str.trim(a+""))}}),a.fn.confirmClick=function(a){return this&&0!==this.length?(b.core.isFunction(a)&&(a=b.core.isFunction(arguments[1])?{checkHandler:a,handler:arguments[1]}:{handler:a}),b.ctrls.ConfirmButton(a,this)):null}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.ExtendButton",{_defineOption:function(){return{buttonSize:32,centerIcon:"close",centerSize:null,buttons:[],parent:null}},_defineEvents:function(){return["showing","showed","hiding","hided"]},_create:function(){this.parent=b.getJQueryElement(this.option.parent),this.parent?this.isBodyInside=!1:(this.parent=a(document.body),this.isBodyInside=!0),this.buttonPanelBGBorderWidth=0,"number"!==b.core.type(this.option.buttonSize)&&(this.option.buttonSize=32),this.centerSize=this.option.centerSize,"number"!==b.core.type(this.centerSize)&&(this.centerSize=this.option.buttonSize),"array"!==b.core.type(this.option.buttons)&&(this.option.buttons=[]),this.buttonPanel=a("<div class='extend-button-panel' />"),this.buttonPanelBackground=a("<div class='extend-button-background border-highlight' />"),this.hasCloseButton=!1,"close"===this.option.centerIcon?(this.hasCloseButton=!0,this.centerIcon=a("<a class='center-icon close-button font-highlight' style='font-size:24px !important;' title='关闭'>×</a>")):"none"===this.option.centerIcon?(this.centerIcon=a("<a class='center-icon center-none border-highlight' />"),this.backgroundColorPanel=a("<div class='background-panel' />"),this.buttonPanelBackground.append(this.backgroundColorPanel),this.buttonPanelBackground.append(this.centerIcon),this.buttonPanelBackground.css("background-color","transparent")):(this.centerIcon=a("<a class='center-icon' />"),b.str.isNullOrEmpty(this.option.centerIcon)||this.centerIcon.append(this.option.centerIcon))},_render:function(){var c,d=0,e=this;for(this._caculateSize(),this.buttonPanel.append(this.buttonPanelBackground),"none"===this.option.centerIcon?(this.backgroundColorPanel.css({width:this.centerSize+"px",height:this.centerSize+"px"}),this.buttonPanelAnimator[2].onChange=function(a){var b=(e.buttonPanelSize-e.centerSize)/2;b=a>e.centerSize?Math.ceil(b*(a/e.buttonPanelSize)):0,this.target.css({width:a+"px",height:a+"px"}),e.backgroundColorPanel.css("border-width",b+"px")},this.centerIcon.css({width:this.centerSize+"px",height:this.centerSize+"px","margin-left":-(this.centerSize/2+1)+"px","margin-top":-(this.centerSize/2+1)+"px"})):(this.centerIcon.css({width:this.centerSize+"px",height:this.centerSize+"px","line-height":this.centerSize+"px",top:this.centerTop-this.centerSize/2+"px",left:this.centerLeft-this.centerSize/2+"px"}),this.buttonPanel.append(this.centerIcon)),c=this.option.buttons.length;d<c;d++)this._createButton(this.option.buttons[d],this.deg*d);a.isFunction(this.element.addClass)&&this.element.addClass("extend-element"),this.parent.append(this.buttonPanel),this.buttonPanelBGBorderWidth=parseFloat(this.buttonPanelBackground.css("border-top-width"))||0,
this.element.click(function(a){a.stopPropagation(),e.show()}),this.hasCloseButton?this.centerIcon.click(function(a){e.hide()}):b.docClick(function(a){e.hide()}),this.buttonPanel.click(function(a){a.stopPropagation()}),this._createAnimator()},_createAnimator:function(){this.buttonPanelAnimator=b.animator({target:this.buttonPanelBackground,onChange:function(a){this.target.css("top",a+"px")}}).addTarget({target:this.buttonPanelBackground,onChange:function(a){this.target.css("left",a+"px")}}).addTarget({target:this.buttonPanelBackground,onChange:function(a){this.target.css({width:a+"px",height:a+"px"})}}).addTarget({target:this.buttonPanelBackground,onChange:function(a){this.target.css({opacity:a/100,filter:"Alpha(opacity="+a+")"})}}),this.buttonPanelAnimator.duration=240,this.buttonAnimator=b.animator(),this.buttonAnimator.duration=240},_getElementCenter:function(){var a=this.isBodyInside?this.element.offset():this.element.position();return a.left=a.left+this.element.outerWidth()/2,a.top=a.top+this.element.outerHeight()/2,a},_setButtonPanelAnimationOpenValue:function(a){var c,d;c=a[0],d=c.target,c.begin=this.centerTop-this.centerSize/2,c.end=0-this.buttonPanelBGBorderWidth,c.ease=b.AnimationStyle.easeTo,c=a[1],c.begin=this.centerLeft-this.centerSize/2,c.end=0-this.buttonPanelBGBorderWidth,c.ease=b.AnimationStyle.easeTo,c=a[2],c.begin=this.centerSize,c.end=this.buttonPanelSize,c.ease=b.AnimationStyle.easeTo,c=a[3],c.begin=0,c.end=100,c.ease=b.AnimationStyle.easeFrom,d.css({left:this.centerLeft-this.buttonSize/2+"px",top:this.centerTop-this.buttonSize/2+"px",width:this.buttonSize+"px",height:this.buttonSize+"px"})},_setButtonPanelAnimationCloseValue:function(a){for(var c,d,e=0,f=a.length;e<f;e++)c=a[e],d=c.begin,c.begin=c.end,c.end=d,c.ease=b.AnimationStyle.easeFrom},_setButtonAnimationOpenValue:function(a){for(var c,d,e=0,f=a.length;e<f;e++)d=this.option.buttons[e],c=a[e],c.begin=0,c.end=100,c.ease=b.AnimationStyle.easeTo,c.target.css({top:d.startTop+"px",left:d.startLeft+"px"})},_setButtonAnimationCloseValue:function(a){for(var c,d,e=0,f=a.length;e<f;e++)d=this.option.buttons[e],c=a[e],c.begin=100,c.end=0,c.ease=b.AnimationStyle.easeFrom},_caculateSize:function(){var a=this.option.buttons.length;this.deg=360/a;var b=this.deg/180*Math.PI,c=this.option.buttonSize,d=c/2/Math.tan(b/2);d<=c/2&&(d=c/2+4),this.centerRadius=d+c/2,this.insideRadius=d+c,this.outsideRadius=Math.sqrt(this.insideRadius*this.insideRadius+c/2*(c/2)),this.outsideRadius+=20,this.buttonSize=c,this.buttonPanelSize=Math.ceil(2*this.outsideRadius),this.centerTop=this.centerLeft=this.buttonPanelSize/2},_setButtonPanelLocation:function(){var a=this._getElementCenter(),b=Math.floor(a.top-this.buttonPanelSize/2),c=Math.floor(a.left-this.buttonPanelSize/2);this.buttonPanel.css({top:b+"px",left:c+"px",width:this.buttonPanelSize+"px",height:this.buttonPanelSize+"px"})},_caculatePositionByCenter:function(a,b){var c={left:0,top:0};return c.left=a-this.buttonSize/2,c.top=b-this.buttonSize/2,c},_createButton:function(c,d){var e,f,g,h,i=this;c.elem=a("<a href='javascript:void(0)' class='extend-button background-highlight' />"),c.icon&&c.elem.append(c.icon),b.str.isNullOrEmpty(c.title)&&c.elem.prop("title",c.title),c.centerStartLeft=0,c.centerStartTop=0,e=d/180*Math.PI,g=this.centerRadius*Math.sin(e)+c.centerStartLeft,h=this.centerRadius*Math.cos(e)+c.centerStartTop,c.centerLeft=Math.floor(this.centerLeft+g),c.centerTop=Math.floor(this.centerTop-h),f=this._caculatePositionByCenter(this.centerLeft,this.centerTop),c.startLeft=f.left,c.startTop=f.top,c.elem.css({width:this.buttonSize+"px",height:this.buttonSize+"px","line-height":this.buttonSize+"px"}),this.buttonPanel.append(c.elem),this.buttonAnimator.addTarget({target:c.elem,button:c,that:this,onChange:function(a){var b=(this.button.centerLeft-this.that.centerLeft)*a/100+this.that.centerLeft,c=(this.button.centerTop-this.that.centerTop)*a/100+this.that.centerTop,d=this.that._caculatePositionByCenter(b,c);this.target.css({left:d.left+"px",top:d.top+"px"})}}),b.core.isFunction(c.handler)&&c.elem.click(function(a){c.handler.call(i,c)})},isShow:function(){return"block"===this.buttonPanel.css("display")},show:function(a){var b=this;this.isShow()||this.fire("showing")!==!1&&(this._setButtonPanelLocation(),a===!1?this.buttonPanel.css("display","block"):(this.buttonPanel.css("display","block"),this._setButtonPanelAnimationOpenValue(this.buttonPanelAnimator),this._setButtonAnimationOpenValue(this.buttonAnimator),this.buttonPanelAnimator.start(),this.buttonAnimator.delayHandler=setTimeout(function(){b.buttonAnimator.delayHandler=null,b.buttonAnimator.start().done(function(){b.fire("showed")})},100)))},hide:function(a){var b=this;this.isShow()&&this.fire("hiding")!==!1&&(a===!1?this.buttonPanel.css("display","none"):(this._setButtonPanelAnimationCloseValue(this.buttonPanelAnimator),this._setButtonAnimationCloseValue(this.buttonAnimator),this.buttonAnimator.start(),this.buttonPanelAnimator.delayHandler=setTimeout(function(){b.buttonPanelAnimator.delayHandler=null,b.buttonPanelAnimator.start().done(function(){b.buttonPanel.css("display","none"),b.fire("hided")})},100)))}}),a.fn.extendButton=function(a){return 0===this.length?null:b.ctrls.ExtendButton(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(b){for(var c,d=a(b.target);"LABEL"!==(c=d.nodeName());){if("DIV"===c)return;d=d.parent()}this._selectItem(d)}var d="filter_tool",e=0;b.define("ui.ctrls.FilterTool",{_defineOption:function(){return{viewData:[],defaultIndex:0,filterCss:null}},_defineEvents:function(){return["selected","deselected"]},_create:function(){var f,g,h,i;for(this.filterPanel=a("<div class='filter-tools-panel'>"),this.parent=this.element,this.radioName=d+"_"+e++,this.onItemClickHandler=c.bind(this),i=this.getViewData(),f=0,g=i.length;f<g;f++)h=i[f],h.selected===!0&&(this.option.defaultIndex=f),this._createTool(h,f);this.option.filterCss&&this.filterPanel.css(this.option.filterCss),this.filterPanel.click(this.onItemClickHandler),this.parent.append(this.filterPanel),(!b.core.isNumber(this.option.defaultIndex)||this.option.defaultIndex>=g||this.option.defaultIndex<0)&&(this.option.defaultIndex=0),this.setIndex(this.option.defaultIndex)},_createTool:function(c,d){if(b.core.isPlainObject(c)){c.index=d;var e=a("<label class='filter-tools-item' />"),f=a("<input type='radio' class='filter-tools-item-radio' name='"+this.radioName+"'/>"),g=a("<span class='filter-tools-item-text' />");e.append(f).append(g),0===d&&e.addClass("filter-tools-item-first"),e.addClass("font-highlight").addClass("border-highlight"),f.prop("value",c.value||""),g.text(c.text||"tool"+d),e.data("dataItem",c),this.filterPanel.append(e)}},_selectItem:function(a){var b,c=a.data("dataItem");if(this.current){if(b=this.current.data("dataItem"),c.index==b.index)return;this.current.addClass("font-highlight").removeClass("background-highlight"),this.fire("deselected",b)}this.current=a,a.find("input").prop("checked",!0),this.current.addClass("background-highlight").removeClass("font-highlight"),this.fire("selected",c)},_getIndexByValue:function(a){var b,c,d;for(b=this.getViewData(),c=-1,d=b.length-1;d>=0;d--)if(b[d].value===a){c=d;break}return c},_setDisplayIndex:function(c,d){var e,f;e=this.getViewData(),0!==!e.length&&(b.core.isNumber(c)||(c=0),c>=0&&c<e.length&&(f=a(this.filterPanel.children()[c]),d?f.addClass("filter-tools-item-hide"):f.removeClass("filter-tools-item-hide"),this._updateFirstClass()))},_updateFirstClass:function(){var b,c,d,e,f;for(b=this.filterPanel.children(),d=b.length;c<d;c++)e=a(b[c]),e.hasClass("filter-tools-item-hide")||(f?e.removeClass("filter-tools-item-first"):f=e);f&&f.addClass("filter-tools-item-first")},getViewData:function(){return Array.isArray(this.option.viewData)?this.option.viewData:[]},getSelection:function(){var a=null;return this.current&&(a=this.current.data("dataItem")),a},setIndex:function(b){var c,d;c=this.getViewData(),0!==!c.length&&(a.isNumeric(b)||(b=0),b>=0&&b<c.length&&(d=a(this.filterPanel.children()[b]),this._selectItem(d)))},setValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.setIndex(b)},hideIndex:function(a){this._setDisplayIndex(a,!0)},hideValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.hideIndex(b)},showIndex:function(a){this._setDisplayIndex(a,!1)},showValue:function(a){var b=this._getIndexByValue(a);b>-1&&this.showIndex(b)}}),a.fn.filterTool=function(a){return 0===this.length?null:b.ctrls.FilterTool(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a){var b=a.clientX,c=a.clientY;if(!this.animating){var d=this.target.offset(),e={top:Math.floor(d.top),left:Math.floor(d.left)};e.bottom=e.top+this.targetHeight,e.right=e.left+this.targetWidth,d=this.viewPanel.offset();var f={top:Math.floor(d.top),left:Math.floor(d.left)};f.bottom=f.top+this.height,f.right=f.left+this.width;var g,h,i=-1,j=-1,k=e.top<f.top?e.top:f.top,l=e.bottom>f.bottom?e.bottom:f.bottom;if(e.left<f.left?(g=e.left,h=f.right):(g=f.left,h=e.right),b<g?i=g-b:b>h&&(i=b-h),c<k?j=k-c:c>l&&(j=c-l),i==-1&&j==-1&&(i=0,b>=e.left&&b<=e.right?(c<=e.top-this.buffer||c>=e.bottom+this.buffer)&&(j=this.buffer):b>=f.left&&b<=f.right&&(c<f.top?j=f.top-c:c>f.bottom&&(j=c-f.bottom)),j==-1))return void this.viewPanel.css({opacity:1,filter:"Alpha(opacity=100)"});if(i>this.buffer||j>this.buffer)return void this.hide();var m=1-(i>j?i:j)/this.buffer;return m<.2?void this.hide():void this.viewPanel.css({opacity:m,filter:"Alpha(opacity="+100*m+")"})}}var d=1;b.define("ui.ctrls.HoverView",{buffer:30,_defineOption:function(){return{width:160,height:160}},_defineEvents:function(){return["showing","showed","hiding","hided"]},_create:function(){this.viewPanel=a("<div class='hover-view-panel border-highlight' />"),this.viewPanel.css({width:this.option.width+"px","max-height":this.option.height+"px"}),a(document.body).append(this.viewPanel),this.width=this.viewPanel.outerWidth(),this.height=this.viewPanel.outerHeight(),this.target=null,this.targetWidth=null,this.targetHeight=null,this.hasDocMousemoveEvent=!1,this.animating=!1,this.isShow=!1,(!b.core.isNumber(this.option.width)||this.option.width<=0)&&(this.option.width=160),(!b.core.isNumber(this.option.height)||this.option.height<=0)&&(this.option.height=160),this.onDocumentMousemoveHander=c.bind(this),this.onDocumentMousemoveHander.guid="hoverView"+d++},empty:function(){return this.viewPanel.empty(),this},append:function(a){return this.viewPanel.append(a),this},addDocMousemove:function(){this.hasDocMousemoveEvent||(this.hasDocMousemoveEvent=!0,a(document).on("mousemove",this.onDocumentMousemoveHander))},removeDocMousemove:function(){this.hasDocMousemoveEvent&&(this.hasDocMousemoveEvent=!1,a(document).off("mousemove",this.onDocumentMousemoveHander))},setLocation:function(){b.setLeft(this.target,this.viewPanel)},getLocation:function(){var a=b.getLeftLocation(this.target,this.width,this.height);return a},show:function(a){var b=this;this.target=a,this.animating=!0;var c=this.fire("showing");if(c!==!1){this.targetWidth=this.target.outerWidth(),this.targetHeight=this.target.outerHeight(),this.height=this.viewPanel.outerHeight(),this.viewPanel.stop();var d,e,f=this.getLocation();this.isShow?(e={left:f.left+"px",top:f.top+"px"},d=parseFloat(this.viewPanel.css("opacity")),d<1&&(e.opacity=1,e.filter="Alpha(opacity=100)")):(this.viewPanel.css({top:f.top+"px",left:f.left+"px",opacity:0,filter:"Alpha(opacity=0)"}),e={opacity:1,filter:"Alpha(opacity=100)"}),this.isShow=!0,this.viewPanel.css("display","block");var g=function(){b.animating=!1,b.addDocMousemove(),b.fire("showed")};this.viewPanel.animate(e,240,g)}},hide:function(a){var b=this,c=this.fire("hiding");if(c!==!1){this.viewPanel.stop(),this.removeDocMousemove();var d=function(){b.isShow=!1,b.viewPanel.css("display","none"),b.fire("hided")},e={opacity:0,filter:"Alpha(opacity=0)"};this.viewPanel.animate(e,200,d)}}}),b.createHoverView=function(a){return b.ctrls.HoverView(a)},a.fn.addHoverView=function(a){if(0===this.length)return null;var c=this;a instanceof b.ctrls.HoverView&&this.mouseover(function(b){a.show(c)})}}(jQuery,ui),function(a,b){"use strict";function c(a){var b,c=a.option;b=this.isHorizontal()?this.track.width():this.track.height(),c.lengthValue=b}function d(a){var b,c=a.option;b=this.thumb.width()/2,this.isHorizontal()?e.call(this,a.x,b,c.lengthValue):f.call(this,a.y,b,c.lengthValue)}function e(a,b,c){var d;location=parseFloat(this.thumb.css("left")),location+=a,d=g.call(this,location+b,0,c),this.percent!==d&&(this.percent=d,this.valuebar.css("width",this.percent+"%"),this.thumb.css("left",location+"px"),this.fire("changed",d))}function f(a,b,c){var d;location=parseFloat(this.thumb.css("top")),location+=a,d=g.call(this,location+b,0,c),this.percent!==d&&(this.percent=d,this.valuebar.css({top:100-this.percent+"%",height:this.percent+"%"}),this.thumb.css("top",location+"px"),this.fire("changed",d))}function g(a,c,d){var e;return a>d?this.percent=100:a<c?this.percent=0:e=b.fixedNumber(a/d,2),e}b.define("ui.ctrls.Slidebar",{_defineOption:function(){return{direction:"horizontal",iframeShield:!1,thickness:8,readonly:!1,disabled:!1}},_defineEvents:function(){return["changed"]},_create:function(){var a;this.percent=0,a=this.element.css("position"),"absolute"!==a&&"relative"!==a&&"fixed"!==a&&this.element.css("position","relative"),this.element.addClass("ui-slidebar"),this.defineProperty("readonly",this.getReadonly,this.setReadonly),this.defineProperty("disabled",this.getDisabled,this.setDisabled),this.defineProperty("value",this.getValue,this.setValue)},_render:function(){this.track=a("<div class='ui-slidebar-track' />"),this.valuebar=a("<div class='ui-slidebar-value' />"),this.thumb=a("<b class='ui-slidebar-thumb' />"),this.track.append(this.valuebar).append(this.thumb),this.element.append(this.track),this._initScale(),this._initMouseDragger(),this.readonly=this.option.readonly,this.disabled=this.option.disabled},_initScale:function(){var a=this.option.thickness,b=2*a;this.thumb.css({width:b+"px",height:b+"px"}),this.isHorizontal()?(this.track.css({width:"100%",height:a+"px",top:(b-a)/2+"px"}),this.valuebar.css("width","0"),this.thumb.css("left",-(b/2)+"px"),this.element.css("height",b+"px")):(this.track.css({width:a+"px",height:"100%",left:(b-a)/2+"px"}),this.valuebar.css({top:"100%",height:"0"}),this.thumb.css("top",this.track().height()-b/2+"px"),this.element.css("width",b+"px"))},_initMouseDragger:function(){var a={target:this.thumb,handle:this.thumb,onBeginDrag:function(a){var b=a.option,d=b.context;c.call(d,a)},onMoving:function(a){var b=a.option,c=b.context;d.call(c,a)}};this.mouseDragger=new b.MouseDragger(a)},isHorizontal:function(){return"horizontal"===this.option.direction},getReadonly:function(){return this.option.readonly},setReadonly:function(a){this.option.readonly=!!a,this.option.readonly?this.mouseDragger.off():this.mouseDragger.on()},getDisabled:function(){return this.option.disabled},setDisabled:function(a){this.option.disabled=!!a,this.option.disabled?(this.mouseDragger.off(),this.valuebar.addClass("background-highlight"),this.thumb.addClass("background-highlight")):(this.mouseDragger.on(),this.valuebar.removeClass("background-highlight"),this.thumb.removeClass("background-highlight"))},getValue:function(){return this.percent},setValue:function(a){var c,e,f={option:{}};c=this.thumb.width()/2,e=a,b.core.isNumber(e)&&(e<0?e=0:e>100&&(e=100),this.isHorizontal()?(f.option.lengthValue=this.track.width(),f.x=f.option.lengthValue*e/100-c):(f.option.lengthValue=this.track.height(),f.y=f.option.lengthValue*(100-e)/100-c),d.call(this,f))}}),a.fn.slidebar=function(a){return 0===this.length?null:b.ctrls.Slidebar(a,this)}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.SwitchButton",{_defineOption:function(){return{width:44,height:24,thumbColor:null,readonly:!1,style:null}},_defineEvents:function(){return["changed"]},_create:function(){var b;this.switchBox=a("<label class='ui-switch-button' />"),this.inner=a("<div class='switch-inner' />"),this.thumb=a("<div class='switch-thumb' />"),"lollipop"===this.option.style?(this.switchBox.addClass("switch-lollipop"),this._open=this._lollipopOpen,this._close=this._lollipopClose,this.thumbSize=24):"marshmallow"===this.option.style?(this.switchBox.addClass("switch-marshmallow"),this._open=this._lollipopOpen,this._close=this._lollipopClose,this.thumbSize=20):this.thumbSize=18,this.option.thumbColor?this.thumb.css("background-color",this.option.thumbColor):this.option.thumbColor=this.thumb.css("background-color"),this._createAnimator(),this.element.wrap(this.switchBox),this.switchBox=this.element.parent(),this.switchBox.append(this.inner).append(this.thumb),this.width=this.option.width||parseFloat(this.switchBox.css("width")),this.height=this.option.height||parseFloat(this.switchBox.css("height")),b=this,this.element.change(function(a){b.onChange()}),this.defineProperty("readonly",this.getReadonly,this.setReadonly),this.defineProperty("value",this.getValue,this.setValue),this.defineProperty("checked",this.getChecked,this.setChecked),this.readonly=!!this.option.readonly,this.checked&&this._open()},_createAnimator:function(){this.animator=b.animator({target:this.thumb,ease:b.AnimationStyle.easeTo,onChange:function(a){var c=c=b.color.overlay(this.beginColor,this.endColor,a/100);c=b.color.rgb2hex(c.red,c.green,c.blue),this.target.css("background-color",c)}}).addTarget({target:this.thumb,ease:b.AnimationStyle.easeFromTo,onChange:function(a,b){b.css("left",a+"px")}}),this.animator.duration=200},onChange:function(){var a=this.element.prop("checked");return this.readonly?void this.element.prop("checked",!a):(a?this._open():this._close(),void this.fire("changed"))},_open:function(){this.animator.stop(),this.switchBox.addClass("switch-open"),this.inner.addClass("border-highlight").addClass("background-highlight");var a=this.animator[0];a.beginColor=this.option.thumbColor,a.endColor="#FFFFFF",a.begin=0,a.end=100,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=this.width-this.thumbSize-3,this.animator.start()},_close:function(){var a;this.animator.stop(),this.switchBox.removeClass("switch-open"),this.inner.removeClass("border-highlight").removeClass("background-highlight"),a=this.animator[0],a.beginColor="#FFFFFF",a.endColor=this.option.thumbColor,a.begin=0,a.end=100,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=3,this.animator.start()},_lollipopOpen:function(){var a;this.animator.stop(),this.switchBox.addClass("switch-open"),this.inner.addClass("background-highlight"),this.thumb.addClass("border-highlight").addClass("background-highlight"),a=this.animator[0],a.begin=0,a.end=0,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=this.option.width-this.thumbSize,this.animator.start()},_lollipopClose:function(){var a;this.animator.stop(),this.switchBox.removeClass("switch-open"),this.inner.removeClass("background-highlight"),this.thumb.removeClass("border-highlight").removeClass("background-highlight"),a=this.animator[0],a.begin=0,a.end=0,a=this.animator[1],a.begin=parseFloat(a.target.css("left")),a.end=0,this.animator.start()},_isOpen:function(){return this.switchBox.hasClass("switch-open")},getReadonly:function(){return!!this.option.readonly},setReadonly:function(a){this.option.readonly=!!a,this.option.readonly?this.element.attr("readonly","readonly"):this.element.removeAttr("readonly")},getValue:function(){return this.element.val()},setValue:function(a){this.element.val(a)},getChecked:function(){return this.element.prop("checked")},setChecked:function(a){var b=this.element.prop("checked");!!arguments[0]!==b?(this.element.prop("checked",arguments[0]),this.onChange()):b&&!this._isOpen()?this._open():!b&&this._isOpen()&&this._close()}}),a.fn.switchButton=function(a){if(0===this.length)return null;if("INPUT"!==this.nodeName()&&"checkbox"!==this.prop("type"))throw new TypeError("the element is not checkbox");return b.ctrls.SwitchButton(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(){var c,e,f=this;e=function(b,e){var g,h=null;if(4===b.readyState)if(200===b.status)g=JSON.parse(b.responseText),e.isEnd?(f.percent=100,f.fire("progressing",f.percent),f.fire("uploaded",d.call(f,g))):c(e.fileName,e.end,e.file,e.total,g.FileId);else{try{h=a.parseJSON(b.responseText),h=h.ErrorMessage||h.errorMessage||h.message,h||(h="服务器没有返回错误信息。")}catch(a){h="服务器返回的错误信息不是JSON格式，无法解析。"}h=404==b.status?"请求地址不存在，"+h:401==b.status?"没有登录，"+h:403==b.status?"没有上传权限，"+h:"上传错误，"+h,f.fire(error,h)}},c=function(a,c,d,g,h){var i,j,k,l,m;f.percent=Math.floor(c/g*1e3)/10,f.fire(progressing,f.percent),i=!1,j=c+f.chunkSize,k=null,j>=g&&(j=g,i=!0),k="mozSlice"in d?d.mozSlice(c,j):"webkitSlice"in d?d.webkitSlice(c,j):d.slice(c,j),l=new XMLHttpRequest,m={isEnd:i,fileName:a,index:c,end:j,file:d,total:g},l.onload=function(){e.call(arguments.callee.caller,l,m)},l.open("POST",f.option.url,!0),l.setRequestHeader("X-Request-With","XMLHttpRequest"),l.setRequestHeader("X-File-Index",c),l.setRequestHeader("X-File-End",j),l.setRequestHeader("X-File-Total",g),l.setRequestHeader("X-File-IsEnd",i+b.str.empty),l.setRequestHeader("X-File-Name",encodeURIComponent(a)),h&&l.setRequestHeader("X-File-Id",h),l.setRequestHeader("Content-Type","application/octet-stream"),l.send(k)},this.doUpload=function(){var a=this.inputFile[0].files,b=a[0];if(a&&0!==a.length){var d=b.fileName||b.name,e=0,f=b.size;c(d,e,b,f)}}}function d(a){return a||(a={}),a.extension=this.extension,a.fileName=this.fileName,a}function e(a){var b;return this._reset(),b=this._inputFile.val(),0!==b.length&&(this.checkFile(b)?void(this.fire(uploading,b)!==!1&&(this.doUpload(),this._inputFile.val(""))):(f("文件格式不符合要求，请重新选择"),this._inputFile.val(""),!1))}function f(a){return b.core.isFunction(b.messageShow)?void b.messageShow(a):b.core.isFunction(b.msgshow)?void b.msgshow(a):void alert(a)}b.define("ui.ctrls.Uploader",{_defineOption:function(){return{url:null,filter:"*.*"}},_defineEvents:function(){return["uploading","upload","progressing","error"]},_create:function(){this._uploaderId=++id,this._form=null,this._inputFile=null,this.onInputFileChangeHandler=e.bind(this),this._reset()},_render:function(){this._prepareUploadMode(),this._initUploadButton(),this._initUpload()},_prepareUploadMode:function(){var a=null;try{a=new XMLHttpRequest,this._initUpload=c,a=null,this.chunkSize=524288}catch(a){this._initUpload=formUpload}},_initUploadButton:function(){var c,d={},e=this.element;this._inputFile=a("<input type='file' class='ui-uploader-input-file' value='' />"),this._inputFile.prop("id","inputFile_"+this._uploaderId),this._inputFile.attr("name",this._uploaderId).attr("title","选择上传文件"),this._inputFile.change(this.onInputFileChangeHandler),this.inputFile[0].files||(this._initUpload=formUpload),b.core.each("",function(a){d[a]=e.css(a)}),"absolute"!==d.position&&"relative"!==d.position&&"fixed"!==d.position&&(d.position="relative"),d.overflow="hidden",d.width=e.outerWidth()+"px",d.height=e.outerHeight()+"px",c=a("<div />").css(d),c=e.css({margin:"0",top:"0",left:"0",right:"auto",bottom:"auto"}).wrap(c).parent(),this._uploadPanel=a("<div class='ui-uploader-file' />"),this._uploadPanel.append(this._inputFile),c.append(this._uploadPanel)},_reset:function(){this.filePath=null,this.extension=null,this.fileName=null,this.percent=0},checkFile:function(a){var b=a.lastIndexOf(".");return b!==-1&&(this.fileName=a.substring(a.lastIndexOf("\\")+1,b),this.extension=a.substring(b).toLowerCase().trim(),"*.*"===this.option.filter||this.option.filter.indexOf(this.extension)!==-1)}}),a.fn.uploader=function(a){return 0===this.length?null:b.ctrls.Uploader(a,this)}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.ImagePreview",{_defineOption:function(){return{chooserButtonSize:16,imageMargin:10,direction:"horizontal"}},_defineEvents:function(){return["changing","changed","ready"]},_create:function(){if(this.element.addClass("image-preview"),this.viewer=this.element.children(".image-view-panel"),this.chooser=this.element.children(".image-preview-chooser"),0===this.viewer.length)throw new Error("需要设置一个class为image-view-panel的元素");if(0===this.chooser.length)throw new Error("需要设置一个class为image-preview-chooser的元素");this.isHorizontal="horizontal"===this.option.direction,(!b.core.type(this.option.chooserButtonSize)||this.option.chooserButtonSize<2)&&(this.option.chooserButtonSize=16),this.item=[]},_render:function(){this.chooserQueue=a("<div class='chooser-queue' />"),this.chooserPrev=a("<a href='javascript:void(0)' class='chooser-button font-highlight-hover'></a>"),this.chooserNext=a("<a href='javascript:void(0)' class='chooser-button font-highlight-hover'></a>"),this.chooser.append(this.chooserPrev).append(this.chooserQueue).append(this.chooserNext),this.chooserPrev.click(function(a){this.beforeItems()}.bind(this)),this.chooserNext.click(function(a){this.afterItems()}.bind(this)),this.chooserAnimator=b.animator({target:this.chooserQueue,ease:b.AnimationStyle.easeFromTo});var c=this.option.chooserButtonSize,d=null;this.isHorizontal?(this.smallImageSize=this.chooser.height(),this.chooserAnimator[0].onChange=function(a){this.target.scrollLeft(a)},d={width:c+"px",height:"100%"},this.chooserPrev.append("<i class='fa fa-angle-left'></i>").css(d),this.chooserNext.append("<i class='fa fa-angle-right'></i>").css(d).css("right","0px"),this.isOverflow=function(){return this.chooserQueue[0].scrollWidth>this.chooserQueue.width()},this.showChooserButtons=function(){this.chooserPrev.css("display","block"),this.chooserNext.css("display","block"),this.chooserQueue.css({left:c+"px",width:this.chooser.width()-2*this.option.chooserButtonSize+"px"})},this.hideChooserButtons=function(){this.chooserPrev.css("display","none"),this.chooserNext.css("display","none"),this.chooserQueue.css({left:"0px",width:"100%"})}):(this.smallImageSize=this.chooser.width(),this.chooserAnimator[0].onChange=function(a){this.target.scrollTop(a)},d={height:c+"px",width:"100%","line-height":c+"px"},this.chooserPrev.append("<i class='fa fa-angle-up'></i>").css(d),this.chooserNext.append("<i class='fa fa-angle-down'></i>").css(d).css("bottom","0px"),d={display:"block"},this.isOverflow=function(){return this.chooserQueue[0].scrollHeight>this.chooserQueue.height()},this.showChooserButtons=function(){this.chooserPrev.css("display","block"),this.chooserNext.css("display","block"),this.chooserQueue.css({top:c+"px",height:this.chooser.height()-2*c+"px"})},this.hideChooserButtons=function(){this.chooserPrev.css("display","none"),this.chooserNext.css("display","none"),this.chooserQueue.css({top:"0px",height:"100%"})}),this.chooserQueue.click(this._onClickHandler.bind(this)),this.setImages(this.option.images)},_initImages:function(b){var c,d,e,f,g,h,i,j,k;for(d=this.smallImageSize-4,c=d,e=0,this.imageSource=b,f=0,g=b.length;f<g;f++)h=b[f],k=this._getImageDisplay(c,d,h.width,h.height),i=a("<div class='small-img' />"),i.attr("data-index",f),j=a("<img alt='' />"),j.css({width:k.width,height:k.height,"margin-top":k.top,"margin-left":k.left}),j.prop("src",h.src),i.append(j),this.chooserQueue.append(i),this.isHorizontal?(i.css("left",e+"px"),e+=this.option.imageMargin+i.outerWidth()):(i.css("top",e+"px"),e+=this.option.imageMargin+i.outerHeight()),this.items.push(i);this.isOverflow()?this.showChooserButtons():this.hideChooserButtons(),this.imageViewer.currentIndex>=0&&(this.selectItem(this.imageViewer.currentIndex),this.fire("changed",this.imageViewer.currentIndex))},_getImageDisplay:function(a,b,c,d){var e,f,g={top:"0px",left:"0px"};return a>b?(f=b,e=Math.floor(c*(f/d)),e>a?(e=a,f=Math.floor(d*(e/c)),g.top=Math.floor((b-f)/2)+"px"):g.left=Math.floor((a-e)/2)+"px"):(e=a,f=Math.floor(d*(e/c)),f>b?(f=b,e=Math.floor(c*(f/d)),g.left=Math.floor((a-e)/2)+"px"):g.top=Math.floor((b-f)/2)+"px"),g.width=e+"px",g.height=f+"px",g},_onClickHandler:function(b){var c,d=a(b.target),e=d.nodeName();d.hasClass("chooser-queue")||("IMG"===e&&(d=d.parent()),c=parseInt(d.attr("data-index"),10),this.fire("changing",c)!==!1&&this.selectItem(c)!==!1&&this.imageViewer.showImage(c))},selectItem:function(a){var b=this.items[a];if(this.currentChooser){if(this.currentChooser[0]===b[0])return!1;this.currentChooser.removeClass("chooser-selected").removeClass("border-highlight")}this.currentChooser=b,this.currentChooser.addClass("chooser-selected").addClass("border-highlight"),this.isOverflow()&&this._moveChooserQueue(a)},empty:function(){this.items=[],this.chooserQueue.empty(),this.imageViewer&&this.imageViewer.empty()},setImages:function(a){var b;Array.isArray(a)&&0!==a.length&&(this.empty(),this.option.images=a,b=this,this.imageViewer?this.imageViewer.setImages(a):(this.imageViewer=this.viewer.imageViewer(this.option),this.imageViewer.ready(function(a,c){b._initImages(c),b.fire("ready")}),this.imageViewer.changed(function(a,c){b.selectItem(c),b.fire("changed",c)})))},_caculateScrollValue:function(a){var b,c,d,e;return this.isHorizontal?(d=this.chooserQueue.width(),b=this.chooserQueue.scrollLeft(),e=this.chooserQueue[0].scrollWidth):(d=this.chooserQueue.height(),b=this.chooserQueue.scrollTop(),e=this.chooserQueue[0].scrollHeight),c=a.call(this,d,b),c<0?c=0:c>e-d&&(c=e-d),{from:b,to:c}},_moveChooserQueue:function(a){var b=this._caculateScrollValue(function(b,c){var d=this.smallImageSize+this.option.imageMargin,e=Math.floor(b/d),f=Math.floor(e/2),g=a-f;return g<0?0:g+e>this.items.length-1?this.items.length*d:g*d});this._setScrollValue(b)},_setScrollValue:function(a){var b;isNaN(a.to)||(this.chooserAnimator.stop(),b=this.chooserAnimator[0],Math.abs(a.from-a.to)<this.smallImageSize?b.onChange.call(b,a.to):(b.begin=a.from,b.end=a.to,this.chooserAnimator.start()))},beforeItems:function(){var a=this._caculateScrollValue(function(a,b){var c=this.smallImageSize+this.option.imageMargin,d=Math.floor(a/c),e=Math.floor(b/c);return(e+d*-1)*c});this._setScrollValue(a)},afterItems:function(){var a=this._caculateScrollValue(function(a,b){var c=this.smallImageSize+this.option.imageMargin,d=Math.floor(a/c),e=Math.floor(b/c);return(e+d)*c});this._setScrollValue(a)}}),a.fn.imagePreview=function(a){if(0!==this.length)return b.ctrls.ImagePreview(a,this)}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.ImageViewer",{_defineOption:function(){return{hasSwitchButtom:!1,interval:2e3,direction:"horizontal",images:[]}},_defineEvents:function(){return["changed","ready"]},_create:function(){Array.isArray(this.option.images)||(this.option.images=[]),b.core.isNumber(this.option.interval)||this.option.interval<=0?this.isAutoView=!1:this.isAutoView=!0,this.stopAutoView=!1,this.currentIndex=-1,this.images=[],this.isHorizontal="horizontal"===this.option.direction,this.animationCssItem=this.isHorizontal?"left":"top"},_render:function(){var a=this;this.element.addClass("image-view-panel"),this.currentView=null,this.nextView=null,this._initAnimator(),this._loadImages(this.option.images),this.isAutoView&&(this.element.mouseenter(function(b){a.stopAutoView=!0,a._autoViewHandler&&clearTimeout(a._autoViewHandler)}),this.element.mouseleave(function(b){a.stopAutoView=!1,a._autoViewHandler=setTimeout(function(){a.next()},a.option.interval)}))},_initAnimator:function(){var a=this;this.viewAnimator=b.animator({ease:b.AnimationStyle.easeTo,onChange:function(b){this.target.css(a.animationCssItem,b+"px")}}).addTarget({ease:b.AnimationStyle.easeTo,onChange:function(b){this.target.css(a.animationCssItem,b+"px")}}),this.viewAnimator.onEnd=function(){a.currentView.css("display","none"),a.currentView=a.nextView,a.nextView=null,a.isAutoView&&!a.stopAutoView&&(a._autoViewHandler=setTimeout(function(){a.next()},a.option.interval)),a.fire("changed",a.currentIndex,a.images[a.currentIndex])},this.viewAnimator.duration=500},setImages:function(){if(0!==arguments.length){this.empty();for(var a=[],c=0,d=arguments.length,e=null;c<d;c++)e=arguments[c],Array.isArray(e)?a=a.concat(e):"string"===b.core.type(e)&&a.push(e);this._loadImages(a)}},_loadImages:function(b){if(0!==b.length){this.option.hasSwitchButtom===!0&&(this.prevBtn=a("<a href='javascript:void(0)' class='image-switch-button switch-button-prev font-highlight-hover'><i class='fa fa-angle-left'></i></a>"),
this.nextBtn=a("<a href='javascript:void(0)' class='image-switch-button switch-button-next font-highlight-hover'><i class='fa fa-angle-right'></i></a>"),this.prevBtn.click(function(a){this.prev()}.bind(this)),this.nextBtn.click(function(a){this.next()}.bind(this)),this.element.append(this.prevBtn).append(this.nextBtn));for(var c=[],d=0,e=this;d<b.length;d++)c.push(this._loadImage(b[d]));Promise.all(c).done(function(b){for(var c,d=0,f=b.length;d<f;d++)c=b[d],c&&(c.view=a("<div class='image-view' />"),c.view.append("<img src='"+c.src+"' alt='' />"),e.element.append(c.view),e.images.push(c));e.images.length>0&&e.showImage(0),e.fire("ready",e.images)})}},_loadImage:function(a){if("string"===b.core.type(a)&&0!==a.length){var c=new Promise(function(b,c){var d=new Image;d.onload=function(){d.onload=null,b({src:a,width:d.width,height:d.height})},d.onerror=function(){b(null)},d.src=a});return c}},_startView:function(a){this.viewAnimator.stop();var b,c=this.element.width(),d=this.element.height(),e=this.isHorizontal?c:d;b=this.viewAnimator[0],b.target=this.currentView,b.begin=parseFloat(b.target.css(this.animationCssItem)),a?b.end=-e:b.end=e,b=this.viewAnimator[1],b.target=this.nextView,b.begin=parseFloat(b.target.css(this.animationCssItem)),b.end=0,this.viewAnimator.start()},_setImage:function(a,b){var c,d,e=this.images[a],f=this.element.width(),g=this.element.height(),h=null;b=b||this.currentView,h=b.children("img"),f>g?(d=g,c=Math.floor(e.width*(d/e.height)),c>f?(c=f,d=Math.floor(e.height*(c/e.width)),h.css("top",Math.floor((g-d)/2)+"px")):h.css("left",Math.floor((f-c)/2)+"px")):(c=f,d=Math.floor(e.height*(c/e.width)),d>g?(d=g,c=Math.floor(e.width*(d/e.height)),h.css("left",Math.floor((f-c)/2)+"px")):h.css("top",Math.floor((g-d)/2)+"px")),h.css({width:c+"px",height:d+"px"})},showImage:function(a){if(0!==this.images.length){this._autoViewHandler&&clearTimeout(this._autoViewHandler);var b,c=this.element.width(),d=this.element.height(),e=this,f={display:"block"},g=this.isHorizontal?c:d;if(this.element.css("overflow","hidden"),this.currentIndex<0)return this.currentIndex=a,this.currentView=this.images[this.currentIndex].view,this._setImage(a),this.currentView.css("display","block"),void(this.isAutoView&&(this._autoViewHandler=setTimeout(function(){e.next()},this.option.interval)));this.nextView&&(this.currentView.css("display","none").css(this.animationCssItem,-g+"px"),this.currentView=this.nextView,this.currentView.css(this.animationCssItem,"0px")),a>this.currentIndex?(a>=this.images.length&&(a=0),f[this.animationCssItem]=g+"px",b=!0):(a<0&&(a=this.images.length-1),f[this.animationCssItem]=-g+"px",b=!1),this.nextView=this.images[a].view,this.nextView.css(f),this._setImage(a,this.nextView),this.currentIndex=a,this._startView(b)}},prev:function(){this.currentIndex>=0?this.showImage(this.currentIndex-1):this.showImage(0)},next:function(){this.currentIndex>=0?this.showImage(this.currentIndex+1):this.showImage(0)},empty:function(){this.images=[],this.currentIndex=-1,this.viewAnimator.stop(),clearTimeout(this._autoViewHandler),this.element.empty(),this.prevBtn=null,this.nextBtn=null,this.currentView=null,this.nextView=null}}),a.fn.imageViewer=function(a){if(0!==this.length)return b.ctrls.ImageViewer(a,this)}}(jQuery,ui),function(a,b){"use strict";b.define("ui.ctrls.ImageWatcher",{_defineOption:function(){return{position:"right",zoomWidth:null,zoomHeight:null}},_create:function(){this.borderWidth=1,this.viewMargin=10,this.option.position=this.option.position.toLowerCase(),this.zoomWidth=this.option.zoomWidth,this.zoomHeight=this.option.zoomHeight,this.element.addClass("image-watch-panel"),this.focusView=a("<div class='focus-view border-highlight' />"),this.zoomView=a("<div class='zoom-view border-highlight' />"),this.zoomImage=a("<img alt='' />"),this.zoomView.append(this.zoomImage),this.element.append(this.focusView).append(this.zoomView)},_render:function(){this._initImage(),this._initZoomer()},_initImage:function(){if(this.image=a(this.element.children("img")[0]),0===this.image.length)throw new Error("元素中没有图片，无法使用图片局部查看器");this.imageOffsetWidth=this.image.width(),this.imageOffsetHeight=this.image.height(),this.image.css({width:"auto",height:"auto"}),this.imageWidth=this.image.width(),this.imageHeight=this.image.height(),this.image.css({width:this.imageOffsetWidth+"px",height:this.imageOffsetHeight+"px"}),this.zoomImage.prop("src",this.image.prop("src"))},_initZoomer:function(){var a=this;b.core.isNumber(this.option.zoomHeight)&&(this.zoomHeight=this.element.height()),b.core.isNumber(this.option.zoomWidth)&&(this.zoomWidth=this.zoomHeight),this.zoomView.css({width:this.zoomWidth-2*this.borderWidth+"px",height:this.zoomHeight-2*this.borderWidth+"px"}),this.element.mouseenter(function(b){a.start=!0,a._setFocusView(b),a._setZoomView()}).mousemove(function(b){a.start&&(a._setFocusView(b),a._setZoomView())}).mouseleave(function(b){a.start=!1,a.focusView.css("display","none"),a.zoomView.css("display","none")})},_setFocusView:function(a){var b,c,d=this.image.offset(),e=a.clientX-d.left,f=a.clientY-d.top,g=this.imageOffsetWidth/this.imageWidth,h=this.zoomWidth*g,i=this.zoomHeight*g,j=this.element.offset(),k=d.top-j.top,l=d.left-j.left;return e<0||e>this.imageOffsetWidth||f<0||f>this.imageOffsetHeight?void this.focusView.css("display","none"):(c=e+l-h/2,c<l?c=l:c+h>this.imageOffsetWidth+l&&(c=this.imageOffsetWidth+l-h),b=f+k-i/2,b<k?b=k:b+i>this.imageOffsetHeight+k&&(b=this.imageOffsetHeight+k-i),this.focusView.css({display:"block",width:h-2*this.borderWidth+"px",height:i-2*this.borderWidth+"px",top:b+"px",left:c+"px"}),this.topRatio=(b-k)/this.imageOffsetHeight,void(this.leftRatio=(c-l)/this.imageOffsetWidth))},_setZoomView:function(){var a,b;return"none"===this.focusView.css("display")?void this.zoomView.css("display","none"):("top"===this.option.position?(b=0,a=-(this.zoomHeight+this.viewMargin)):"bottom"===this.option.position?(b=0,a=this.element.outerHeight()+this.viewMargin):"left"===this.option.position?(b=-(this.zoomWidth+this.viewMargin),a=0):(b=this.element.outerWidth()+this.viewMargin,a=0),this.zoomView.css({display:"block",top:a+"px",left:b+"px"}),void this.zoomImage.css({top:-(this.imageHeight*this.topRatio)+"px",left:-(this.imageWidth*this.leftRatio)+"px"}))}}),a.fn.imageWatcher=function(a){if(0!==this.length)return b.ctrls.ImageWatcher(a,this)}}(jQuery,ui),function(a,b){"use strict";function c(a){var b=a.attr("data-large-src");return b||(b=a.prop("src")),b}function d(a){var b=new Promise(function(b,c){var d=new Image,e={src:a,width:-1,height:-1};d.onload=function(){d.onload=null,e.width=d.width,e.height=d.height,b(e)},d.onerror=function(){c(e)},d.src=a});return b}b.define("ui.ctrls.ImageZoomer",{_defineOption:function(){return{parentContent:a(document.body),onNext:null,onPrev:null,hasNext:null,hasPrev:null,getLargeImageSrc:null}},_defineEvents:function(){return["hided"]},_create:function(){this.parentContent=this.option.parentContent,this.closeButton=null,this.mask=null,this.width=null,this.height=null,this.target=null,this.targetTop=null,this.targetLeft=null,b.core.isFunction(this.option.getLargeImageSrc)?this._getLargeImageSrc=this.option.getLargeImageSrc:this._getLargeImageSrc=c},_render:function(){var c;this.imagePanel=a("<div class='show-image-panel' />"),this.currentView=a("<div class='image-view-panel' style='display:none;' />"),this.nextView=a("<div class='image-view-panel' style='display:none;' />"),this.currentView.append("<img class='image-view-img' />"),this.nextView.append("<img class='image-view-img' />"),this.closeButton=a("<a class='close-button font-highlight-hover' href='javascript:void(0)'>×</a>"),c=this,this.closeButton.click(function(){c.hide()}),this.imagePanel.append(this.currentView).append(this.nextView).append(this.closeButton),b.core.isFunction(this.option.onNext)&&(this.nextButton=a("<a class='next-button font-highlight-hover disabled-button' style='right:10px;' href='javascript:void(0)'><i class='fa fa-angle-right'></i></a>"),this.nextButton.click(function(a){c._doNextView()}),this.imagePanel.append(this.nextButton)),b.core.isFunction(this.option.onPrev)&&(this.prevButton=a("<a class='prev-button font-highlight-hover disabled-button' style='left:10px;' href='javascript:void(0)'><i class='fa fa-angle-left'></i></a>"),this.prevButton.click(function(a){c._doPrevView()}),this.imagePanel.append(this.prevButton)),a(document.body).append(this.imagePanel),b.page.resize(function(a){c.resizeZoomImage()},b.eventPriority.ctrlResize),(this.prevButton||this.nextButton)&&(this.changeViewAnimator=b.animator({ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"px")}}).addTarget({ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("left",a+"px")}}))},_showOptionButtons:function(){this.prevButton&&this.prevButton.removeClass("disabled-button"),this.nextButton&&this.nextButton.removeClass("disabled-button")},_hideOptionButtons:function(){this.prevButton&&this.prevButton.addClass("disabled-button"),this.nextButton&&this.nextButton.addClass("disabled-button")},_updateButtonState:function(){b.core.isFunction(this.option.hasNext)&&(this.option.hasNext.call(this)?this.nextButton.removeClass("disabled-button"):this.nextButton.addClass("disabled-button")),b.core.isFunction(this.option.hasPrev)&&(this.option.hasPrev.call(this)?this.prevButton.removeClass("disabled-button"):this.prevButton.addClass("disabled-button"))},show:function(a){var c,d,e,f,g;this.target=a,c=this._setImageSize(),c&&(d=this.currentView.children("img"),d.prop("src",this.target.prop("src")),d.css({width:this.target.width()+"px",height:this.target.height()+"px",left:this.targetLeft+"px",top:this.targetTop+"px"}),this.imagePanel.css({display:"block",width:c.parentWidth+"px",height:c.parentHeight+"px",left:c.parentLocation.left+"px",top:c.parentLocation.top+"px"}),this.currentView.css("display","block"),e=(c.parentWidth-this.width)/2,f=(c.parentHeight-this.height)/2,g=this,b.mask.open({opacity:.8}),d.animate({left:e+"px",top:f+"px",width:this.width+"px",height:this.height+"px"},240,function(){g._updateButtonState()}))},hide:function(){var a=this,c=this.currentView.children("img");b.mask.close(),c.animate({top:this.targetTop+"px",left:this.targetLeft+"px",width:this.target.width()+"px",height:this.target.height()+"px"},240,function(){a._hideOptionButtons(),a.imagePanel.css("display","none"),a.currentView.css("display","none"),a.fire("hided",a.target)})},_doNextView:function(){var a;this.changeViewAnimator.isStarted||(a=this.option.onNext.call(this),a&&this._doChangeView(a,function(){this.target=a,this._updateButtonState(),this._changeView(-this.parentContent.width())}))},_doPrevView:function(){var a;this.changeViewAnimator.isStarted||(a=this.option.onPrev.call(this),a&&this._doChangeView(a,function(){this.target=a,this._updateButtonState(),this._changeView(this.parentContent.width())}))},_doChangeView:function(a,b){var c=a.data("LargeSize"),e=this;c?b.call(this):d(this._getLargeImageSrc(a)).then(function(c){a.data("LargeSize",c),b.call(e)},function(a){b.call(e)})},_changeView:function(a){var b,c,d,e,f,g;b=this.currentView,this.currentView=this.nextView,this.nextView=b,c=this._getLargeImageSrc(this.target),d=this._setImageSize(),d&&(e=this.currentView.children("img"),e.prop("src",c),e.css({left:(d.parentWidth-this.width)/2+"px",top:(d.parentHeight-this.height)/2+"px",width:this.width+"px",height:this.height+"px"}),this.currentView.css("display","block"),this.currentView.css("left",-a+"px"),f=this.changeViewAnimator[0],f.target=this.nextView,f.begin=0,f.end=a,f=this.changeViewAnimator[1],f.target=this.currentView,f.begin=-a,f.end=0,g=this,this.changeViewAnimator.start().done(function(){g.nextView.css("display","none")}))},resizeZoomImage:function(){var a,b,c,d;a=this._setImageSize(),a&&(b=(a.parentWidth-this.width)/2,c=(a.parentHeight-this.height)/2,this.imagePanel.css({width:a.parentWidth+"px",height:a.parentHeight+"px"}),d=this.currentView.children("img"),d.css({left:b+"px",top:c+"px",width:this.width+"px",height:this.height+"px"}))},_getActualSize:function(a){var b,c,d,e;return b=a.data("LargeSize"),b||(c={width:a.width(),height:a.height()},a.css({width:"auto",height:"auto"}),d=a.width(),e=a.height(),a.css({width:c.width+"px",height:c.height+"px"}),b={width:d,height:e}),b},_setImageSize:function(){var a,b,c,d,e,f,g,h;if(this.currentView&&this.target)return a=this.currentView.children("img"),a.stop(),b=this._getActualSize(this.target),c=this.parentContent.height(),d=this.parentContent.width(),e=b.width,f=b.height,e/d<f/c?(f>=c?this.height=c:this.height=f,this.width=Math.floor(e*(this.height/f))):(e>=d?this.width=d:this.width=f,this.height=Math.floor(f*(this.width/e))),g=this.target.offset(),h=this.parentContent.offset(),this.targetTop=g.top-h.top,this.targetLeft=g.left-h.left,{parentWidth:d,parentHeight:c,parentLocation:h}}}),a.fn.addImageZoomer=function(c){0!==this.length&&c instanceof b.ctrls.ImageZoomer&&this.click(function(b){var e=a(b.target),f=e.data("LargeSize");f?c.show(e):d(c._getLargeImageSrc(e)).then(function(a){e.data("LargeSize",a),c.show(e)},function(a){c.show(e)})})}}(jQuery,ui),function(a,b){"use strict";function c(){d.call(this),e.call(this),f.call(this)}function d(){this.toolbar={height:40,extendHeight:0}}function e(){this.sidebarManager=b.SidebarManager()}function f(){var a;this.menuConfig&&(this.menu=b.ctrls.Menu(this.menuConfig),a=this,this.menu.showed(function(b){this.isExtrusion()&&(this.isModern()?a.contentBodyWidth-=this.menuWidth-this.menuNarrowWidth:a.contentBodyWidth-=this.menuWidth)}),this.menu.hided(function(b){this.isExtrusion()&&(this.isModern()?a.contentBodyWidth+=this.menuWidth-this.menuNarrowWidth:a.contentBodyWidth+=this.menuWidth)}))}function g(){var a,b,c;this.menu&&this.menu.disableResizeable||(b=document.documentElement.clientWidth,c=document.documentElement.clientHeight,this.head.length>0?c-=this.head.height():this.head=null,this.foot.length>0&&(c-=this.foot.height()),a=c,this.body.length>0?this.body.css("height",a+"px"):this.body=null,this.contentBodyHeight=a,this.contentBodyWidth=b,this.menu&&this.menu.isShow()&&this.menu.resize(this.contentBodyWidth,this.contentBodyHeight))}function h(){var c,d,e,f,g,h,j,k,l,m,n,o;if(n=i.call(this,"userSettings"),c=a("#user"),0!==c.length){if(o=this,d=a("<section class='user-settings' />"),e=a("<div class='user-info' />"),f=a("<div class='highlight-panel' />"),g=a("<div class='operate-list' />"),h=[],h.push("<div class='protrait-cover'>","<img class='protrait-img' src='",c.children("img").prop("src"),"' alt='用户头像' /></div>","<div class='user-info-panel'>","<span class='user-info-text' style='font-size:18px;line-height:36px;'>",this.name,"</span><br />","<span class='user-info-text'>",this.department,"</span><br />","<span class='user-info-text'>",this.position,"</span>","</div>","<br clear='left' />"),e.append(h.join("")),b.theme.currentHighlight||b.theme.initHighlight(),Array.isArray(b.theme.highlights)){for(h=[],h.push("<h3 class='highlight-group-title font-highlight'>个性色</h3>"),h.push("<div style='width:100%;height:auto'>"),j=0,k=b.theme.highlights.length;j<k;j++)l=b.theme.highlights[j],h.push("<a class='highlight-item"),l.Id===b.theme.currentHighlight.Id&&h.push(" highlight-item-selected"),h.push("' href='javascript:void(0)' style='background-color:",l.Color,";"),h.push("' title='",l.Name,"' data-index='",j,"'>"),h.push("<i class='fa fa-check-circle highlight-item-checker'></i>"),h.push("</a>");h.push("</div>"),f.append(h.join("")),setTimeout(function(){o._currentHighlightItem=f.find(".highlight-item-selected"),0===o._currentHighlightItem.length&&(o._currentHighlightItem=null)}),f.click(function(c){var d,e;for(d=a(c.target);!d.hasClass("highlight-item");){if(d.hasClass("highlight-panel"))return;d=d.parent()}e=b.theme.highlights[parseInt(d.attr("data-index"),10)],o._currentHighlightItem&&o._currentHighlightItem.removeClass("highlight-item-selected"),o._currentHighlightItem=d,o._currentHighlightItem.addClass("highlight-item-selected"),a("#highlight").prop("href",b.str.textFormat("../../../dist/theme/color/ui.metro.{0}.css",e.Id)),b.theme.setHighlight(e)})}h=[],n.operateList&&n.operateList.length>0&&(h.push("<ul class='operate-list-ul'>"),n.operateList.forEach(function(a){a.text&&h.push("<li class='operate-list-li theme-panel-hover'>","<span class='operate-text'>",a.text,"</span>","<a class='operate-list-anchor' href='",a.url,"'></a>","</li>")}),h.push("</ul>")),g.append(h.join("")),d.append(e).append(f).append("<hr class='horizontal' />").append(g),m=this.sidebarManager.setElement("userSidebar",{parent:"body",width:240},d),m._closeButton.css("color","#ffffff"),d.before("<div class='user-settings-background title-color' />"),m.animator[0].ease=b.AnimationStyle.easeFromTo,m.contentAnimator=b.animator({target:d,begin:100,end:0,ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"%")}}),m.contentAnimator.duration=200,m.showing(function(){d.css("display","none")}),m.showed(function(){d.css({display:"block",left:"100%"}),this.contentAnimator.start()}),c.click(function(a){o.sidebarManager.show("userSidebar")})}}function i(a){var c;if(!b.str.isEmpty(a))return c=a+"Config",this[c]||j[c]}var j={menuConfig:{style:"normal",menuPanel:a(".ui-menu-panel"),contentContainer:a(".content-container"),extendMethod:"cover",menuButton:a(".ui-menu-button")},userSettingsConfig:{operateList:[{text:"个性化",url:"javascript:void(0)"},{text:"修改密码",url:"javascript:void(0)"},{text:"退出",url:"javascript:void(0)"}]}},k={name:"姓名",department:"部门",position:"职位",contextUrl:"/",isHomePage:!1,contentBodyWidth:0,contentBodyHeight:0,config:function(c,d){var e,f;b.str.isEmpty(c)||(f=c+"Config",e=j[f],j&&(d=a.extend(e,d)),this[f]=d)},init:function(d){var e=this;this.head=a("#head"),this.body=a("#body"),this.foot=a("#foot"),b.page.ready(function(a){b.core.isFunction(d)&&d.call(e),c.call(e),g.call(e),h.call(e),b.page.resize(function(a,b,c){g.call(e)},b.eventPriority.bodyResize),window.pageLogic&&e.pageInit(pageLogic.init,pageLogic),e.body.css("visibility","visible")},b.eventPriority.masterReady)},pageInit:function(a,c){var d=null,c=c||this,e=["页面初始化时在[","","]阶段发生错误，",""];if(b.core.isPlainObject(a))for(var f in a)if(d=a[f],b.core.isFunction(d))try{d.call(c)}catch(a){throw e[1]=f,e[3]=a.message,b.errorShow(e.join("")),a}},ready:function(a){b.core.isFunction(a)&&b.page.ready(a,b.eventPriority.pageReady)},resize:function(a,c){b.core.isFunction(a)&&(b.page.resize(a,b.eventPriority.elementResize),c!==!1&&a.call(b))},createToolbar:function(a,c){return a?b.Toolbar({toolbarId:a,defaultExtendShow:!!c}):null},getUrl:function(a){var b;return a?(a=a.trim(),b=this.contextUrl.charAt(this.contextUrl.length-1),"/"!==b&&"\\"!==b||(this.contextUrl=this.contextUrl.substring(0,this.contextUrl.length-1)+"/"),b=a.charAt(0),"/"!==b&&"\\"!==b||(a=a.substring(1)),this.contextUrl+a):this.contextUrl},hasMenu:function(){return this.menu}};b.master=k}(jQuery,ui),function(a,b){"use strict";function c(b){var c,d,e,f,g;for(b.stopPropagation(),c=a(b.target);"DT"!==(d=c.nodeName());){if("DL"===d||"A"===d)return;c=c.parent()}if(e=function(){var a;this._currentMenu=c,this._currentMenu.addClass(h).addClass(i),a=this._getSubmenuElement(),a&&(a.addClass(h).addClass(i),this.subShow(a,this.hasAnimation))}.bind(this),f=function(){var a;this._currentMenu.removeClass(h).removeClass(i),a=this._getSubmenuElement(),a.removeClass(h).removeClass(i),a.css("display","none"),this._currentMenu[0]!==c[0]?(this._currentMenu=null,e()):this._currentMenu=null}.bind(this),this._currentMenu){if(g=this._getSubmenuElement())return void this.subHide(g,this.hasAnimation(),f);this._currentMenu.removeClass(h).removeClass(i)}e()}function d(b){var c,d,e,f,g;for(b.stopPropagation(),c=a(b.target);"DT"!==(d=c.nodeName());){if("DL"===d||"A"===d)return;c=c.parent()}e=c.next(),0!==e.length&&"DD"===e.nodeName()&&(f=function(){var a;this._currentMenu=c,this._currentMenu.addClass(h).addClass(i),a=this._getSubmenuElement(),a.addClass(h).addClass(i),this.subShow(a,this.hasAnimation)}.bind(this),g=function(){var a;this._currentMenu.removeClass(h).removeClass(i),a=this._getSubmenuElement(),a.removeClass(h).removeClass(i),a.css("display","none"),this._currentMenu=null}.bind(this),this._currentMenu?this._currentMenu[0]===c[0]?this.subHide(this._getSubmenuElement(),this.hasAnimation(),g):(this._currentMenu.removeClass(h).removeClass(i),this._currentMenu=null,f()):f())}var e,f,g="ui-menu-button-show",h="current-menu",i="head-color",j=30;e={show:function(a){var b,c,d,e;return a===!1?(this.resize(),void this._fireResize()):(b=this.menuPanelAnimator,b.stop(),c=b[0],d=parseInt(c.target.css("left"),10),d>=0?void c.target.css("left","0px"):(c.begin=d,c.end=0,b.length>1&&(c=b[1],c.begin=parseInt(c.target.css("left"),10),c.end=this.menuWidth,c=b[2],c.begin=parseInt(c.target.css("width"),10),c.end=document.documentElement.clientWidth-this.menuWidth),e=this,void b.start().done(function(){e.hideState=!1})))},hide:function(a){var b,c,d,e;return a===!1?(this.resize(),void this._fireResize()):(b=this.menuPanelAnimator,b.stop(),c=b[0],d=parseInt(c.target.css("left"),10),d<=-this.menuWidth?void c.target.css("left",-this.menuWidth+"px"):(b[0].begin=d,b[0].end=-this.menuWidth,b.length>1&&(c=b[1],c.begin=parseInt(c.target.css("left"),10),c.end=0,c=b[2],c.begin=parseInt(c.target.css("width"),10),c.end=document.documentElement.clientWidth),e=this,void b.start().done(function(){e.hideState=!0})))},subShow:function(a,c){var d,e,f,g,h,i;if(e=a.children("ul"),f=e.children().length,0!==f)return d=f*j,a.prev().find(".allow").removeClass("fa-angle-down").addClass("fa-angle-up"),c===!1?(a.css({display:"block",height:d+"px"}),void e.css("top","0px")):(g=this.submenuAnimator,g.stop(),g.duration=360,h=g[0],h.target=a,h.begin=a.height(),h.end=d,h.ease=b.AnimationStyle.easeTo,h.target.css("display","block"),i=h.end-h.begin,h=g[1],h.target=e,h.begin=-i,h.end=0,h.ease=b.AnimationStyle.easeTo,h.target.css("top",-i+"px"),g.onEnd=null,g.start())},subHide:function(a,c,d){var e,f,g,h;return a.prev().find(".allow").removeClass("fa-angle-up").addClass("fa-angle-down"),e=a.children("ul"),f=e.children().length*j,b.core.isFunction(c)&&(d=c,c=void 0),c===!1?(a.css({display:"none",height:"0px"}),e.css("top",-f),void(b.core.isFunction(d)&&d())):(g=this.submenuAnimator,g.stop(),h=g[0],h.target=a,g.duration=360,h.begin=a.height(),h.end=0,h.ease=b.AnimationStyle.easeFrom,h=g[1],h.target=e,h.begin=parseFloat(h.target.css("top")),h.end=-f,h.ease=b.AnimationStyle.easeFrom,g.onEnd=d,g.start())},resize:function(a,b){this.isShow()?(this.isExtrusion()&&(a||(a=document.documentElement.clientWidth),this.option.contentContainer.css({width:a-this.menuWidth+"px",left:this.menuWidth+"px"})),this.option.menuPanel.css("left","0px"),this.fire("showed")):(this.isExtrusion()&&this.option.contentContainer.css({width:"100%",left:"0px"}),this.option.menuPanel.css({left:-this.menuWidth+"px"}),this.fire("hided"))}},f={show:function(a){var b;this.onMenuItemClickHandler=this.onMenuItemNormalClickHandler,this._currentMenu&&(this.submenuPanel.removeClass(h).removeClass(i),this.submenuPanel.css("display","none"),this.submenuList.html(""),b=this._getSubmenuElement(!1),b&&(b.addClass(h).addClass(i),e.subShow.call(this,b,!1))),this._updateStatusToSrc(!1),this.resize(),this._fireResize()},hide:function(a){var b;this.onMenuItemClickHandler=this.onMenuItemModernClickHandler,this._currentMenu&&(b=this._getSubmenuElement(!1),b&&e.subHide.call(this,b,!1,function(){b.removeClass(h).removeClass(i),b.css("display","none")}),this._currentMenu.removeClass(h).removeClass(i),this._currentMenu=null),this._updateStatusToSrc(!0),this.resize(),this._fireResize()},subShow:function(a,b){var c,d,f;if(this.isShow())e.subShow.apply(this,arguments);else{if(b===!1)return this._setSubmenuList(),void this.submenuPanel.css("display","block");if(c=this.submenuPanelAnimator,c.isStarted)return;c.onEnd=null,f=function(){var a;this.submenuList.css("display","none"),this._setSubmenuList(),a=this,setTimeout(function(){var b;a.submenuList.css({display:"block",left:-a.menuWidth+"px"}),b=a.submenuListAnimator[0],b.begin=-a.menuWidth,b.end=0,a.submenuListAnimator.start()})}.bind(this),"none"===a.css("display")?(d=c[0],d.begin=-(this.menuWidth-this.menuNarrowWidth)+this.menuNarrowWidth,d.end=this.menuNarrowWidth,d.target.css("display","block"),c.onEnd=f,c.start()):f()}},subHide:function(a,b,c){var d,f;if(this.isShow())e.subHide.apply(this,arguments);else{if(b===!1)return this.submenuPanel.css("display","none"),c(),void this.submenuList.html("");if(d=this.submenuPanelAnimator,d.isStarted)return;option=d[0],option.begin=this.menuNarrowWidth,option.end=-(this.menuWidth-this.menuNarrowWidth),f=this,d.onEnd=c,d.start().done(function(){f.submenuList.html("")})}},resize:function(a,b){a||(a=document.documentElement.clientWidth-this.menuNarrowWidth),this.isShow()?(this.isExtrusion()&&this.option.contentContainer.css({width:a-(this.menuWidth-this.menuNarrowWidth)+"px",left:this.menuWidth+"px"}),this.option.menuPanel.removeClass("ui-menu-panel-narrow"),this.option.menuPanel.css("width",this.menuWidth+"px"),this.fire("showed")):(this.isExtrusion()&&this.option.contentContainer.css({width:a+(this.menuWidth-this.menuNarrowWidth)+"px",left:this.menuNarrowWidth+"px"}),this.option.menuPanel.addClass("ui-menu-panel-narrow"),this.option.menuPanel.css("width",this.menuNarrowWidth+"px"),this.fire("hided"))},_setSubmenuList:function(){var a,b,c,d,e;if(a=this._getSubmenuElement(!1)){for(b=[],e=a.children().children(),c=0,d=e.length;c<d;c++)b.push(e[c].outerHTML);this.submenuList.html(b.join(""))}}},b.define("ui.ctrls.Menu",{_defineOption:function(){return{style:"normal",urlPrefix:"",menuPanel:null,contentContainer:null,extendMethod:"extrusion",menuButton:null,defaultShow:!1,animation:!0}},_defineEvents:function(){return["showed","hided"]},_create:function(){var b,g;this.menuWidth=240,this.menuNarrowWidth=48,this._menuButtonBg=null,this.option.menuButton&&(this._menuButtonBg=a("<b class='menu-button-background title-color'></b>"),this.option.menuButton.append(this._menuButtonBg),this.option.menuButton.append("<b class='menu-inner-line a'></b>").append("<b class='menu-inner-line b'></b>").append("<b class='menu-inner-line c'></b>")),"modern"!==this.option.style&&(this.option.style="normal"),this.isModern()?(b=f,this.hamburgButton="modern-hamburg",this.hamburgCloseButton="modern-hamburg-close",this._initSubmenuPanel()):(b=e,this.hamburgButton="normal-hamburg",this.hamburgCloseButton="normal-hamburg-close");for(g in b)b.hasOwnProperty(g)&&(this[g]=b[g]);this.hasAnimation()&&(this._initMenuPanelAnimator(),this._initSubmenuAnimator()),this.onMenuItemNormalClickHandler=c.bind(this),this.onMenuItemModernClickHandler=d.bind(this),this.onMenuItemClickHandler=this.onMenuItemNormalClickHandler},_render:function(){this.menuList=a("<dl class='menu-list title-color' />"),this.option.menuPanel.addClass("title-color"),this.option.menuPanel.css("width",this.menuWidth+"px"),this.option.menuPanel.append(this.menuList),this.option.menuButton.addClass(this.hamburgButton),this._initMenuList(),this.defaultShow()?this.option.menuButton.addClass(g).addClass(this.hamburgCloseButton):this.hide(!1)},_initMenuPanelAnimator:function(){var a=this;this.menuPanelAnimator=b.animator({target:this.option.menuPanel,ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}),this.isExtrusion()&&this.menuPanelAnimator.addTarget({target:this.option.contentContainer,ease:b.AnimationStyle.easeTo,onChange:function(a,b){b.css("left",a+"px")}}).addTarget({target:this.option.contentContainer,ease:b.AnimationStyle.easeTo,onChange:function(b,c){c.css("width",b+"px"),mp.contentBodyWidth=b,a._fireResize()}}),this.menuPanelAnimator.duration=300},_initSubmenuAnimator:function(){this.submenuAnimator=b.animator({onChange:function(a,b){b.css("height",parseInt(a,10)+"px")}}).addTarget({onChange:function(a,b){b.css("top",parseInt(a,10)+"px")}})},_initSubmenuPanel:function(){this.submenuPanel=a("<div class='submenu-slide-panel' />"),this.submenuPanel.css({left:this.menuNarrowWidth+"px",width:this.menuWidth-this.menuNarrowWidth+"px"}),this.submenuPanel.addClass("title-color"),this.submenuList=a("<ul class='submenu-list' />"),this.submenuPanel.append("<b class='submenu-background'></b>"),this.submenuPanel.append(this.submenuList),this.option.menuPanel.prepend(this.submenuPanel),this.hasAnimation()&&this._initSubmenuPanelAnimator()},_initSubmenuPanelAnimator:function(){this.submenuPanelAnimator=b.animator({target:this.submenuPanel,ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a)}}),this.submenuPanelAnimator.duration=200,this.submenuListAnimator=b.animator({target:this.submenuList,ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("left",a+"px")}}),this.submenuListAnimator.duration=100},_initMenuList:function(){var a,b;this._updateMenuSelectedStatus(),b=this,this.menuList.click(function(a){b.onMenuItemClickHandler(a)}),a=this.option.menuButton,a.click(function(c){a.hasClass(g)?(a.removeClass(g).removeClass(b.hamburgCloseButton),b.hide(b.hasAnimation)):(a.addClass(g).addClass(b.hamburgCloseButton),b.show(b.hasAnimation))})},_updateMenuSelectedStatus:function(){var a;this._currentMenu=this.option.menuPanel.find("dt."+h),0===this._currentMenu.length&&(this._currentMenu=null),this._isCloseStatus()?(this.option.menuButton.removeClass(g).removeClass(this.hamburgCloseButton),this.hide(!1)):this._currentMenu&&(a=this._currentMenu.next(),"DD"===a.nodeName()&&this.subShow(a,!1))},_getSubmenuElement:function(a){var c;return b.core.isBoolean(a)||(a=!this.isShow()),this.isModern()&&a?c=this.submenuPanel:(c=this._currentMenu.next(),0!=c.lenght&&"DD"===c.nodeName()||(c=null)),c},_fireResize:function(){this.disableResizeable=!0,b.page.fire("resize"),this.disableResizeable=!1},_parentCode:function(a){var b;return a?(b=a.lastIndexOf("_"),b<0?null:a.substring(0,b)):null},_getUrl:function(a){var c,d=/^(http|https):\/\/\w*/i;return b.str.isEmpty(a)?"":0==a.indexOf("javascript:")?a:(c=d.test(a)?a:""+a,this.option.urlPrefix+c)},_addMenuCodeToSrc:function(a,c){var d=this._getUrl(a);return 0==d.indexOf("javascript:")?d:b.str.isEmpty(d)?"javascript:void(0)":(b.str.isEmpty(c)||(d+=d.indexOf("?")>-1?"&_m="+b.str.base64Encode(c):"?_m="+b.str.base64Encode(c)),d)},_updateStatusToSrc:function(b){var c,d,e,f,g,h,i,j="DD";for(i=b?this._addMenuStatus:this._removeMenuStatus,c=this.option.menuPanel.children(".menu-list").children(".menu-item"),d=0,e=c.length;d<e;d++)if(f=a(c[d]),f.next().nodeName()===j)for(d++,h=f.next().children().children(),g=0;g<h.length;g++)i.call(this,a(h[g]).children(".menu-item-container").children("a"));else i.call(this,f.children(".menu-item-container").children("a"))},_addMenuStatus:function(a){var b,c;b=this._getUrl(a.attr("href")),0!==b.indexOf("javascript:")&&(c=b.indexOf("?"),b+=c==-1?"?_s=close":"&_s=close",a.attr("href",b))},_removeMenuStatus:function(a){var b,c,d,e;if(b=this._getUrl(a.attr("href")),0!==b.indexOf("javascript:")&&(c=b.split("?"),1!==c.length)){d=c[1].split("&");for(var f=0,g=d.length;f<g;f++)if(e=d[f],e&&0===e.indexOf("_s=")){d.splice(f,1);break}a.attr("href",c[0]+"?"+d.join("&"))}},_isCloseStatus:function(){return"close"===b.url.getLocationParam("_s")},setMenuList:function(a){var c,d,e,f,g,h,j,k,l,m;if(this.menuList.empty(),Array.isArray(a)&&0!==a.length){for(c=[],g=b.url.getLocationParam("_m"),b.str.isEmpty(g)||(g=b.str.base64Decode(g),h=this._parentCode(g)),j=0,k=a.length;j<k;j++)if(d=a[j],f=b.str.isEmpty(h)?d.resourceCode===g?" current-menu "+i+" selection-menu":"":d.resourceCode===h?" current-menu "+i:"",c.push("<dt class='menu-item",f,"'>"),c.push("<b class='menu-item-background'><b class='menu-item-color'></b></b>"),c.push("<u class='menu-item-container'>"),c.push("<i class='icon'>"),c.push("<img class='icon-img' src='",d.icon?this.option.urlPrefix+d.icon:"","' />"),c.push("</i>"),c.push("<span class='menu-item-text'>",d.resourceName,"</span>"),
Array.isArray(d.children)&&0!==d.children.length?c.push("<i class='allow fa fa-angle-down'></i>"):c.push("<a class='direct' href='",this._addMenuCodeToSrc(d.url,d.resourceCode),"'></a>"),c.push("</u></dt>"),Array.isArray(d.children)&&d.children.length>0){for(c.push("<dd class='submenu-panel",f,"'>"),c.push("<ul class='submenu-list'>"),l=0;l<d.children.length;l++)e=d.children[l],f=e.resourceCode===g?" selection-menu":"",c.push("<li class='submenu-item",f,"'>"),c.push("<b class='menu-item-background'><b class='menu-item-color'></b></b>"),c.push("<u class='menu-item-container'>"),c.push("<span class='submenu-item-text'>",e.resourceName,"</span>"),c.push("<a class='direct' href='",this._addMenuCodeToSrc(e.url,e.resourceCode),"'></a>"),c.push("</u>"),c.push("</li>");c.push("</ul></dd>")}this.menuList.html(c.join("")),m=this,setTimeout(function(){m._updateMenuSelectedStatus()})}},hasAnimation:function(){return!!this.option.animation},isModern:function(){return"modern"===this.option.style},isShow:function(){return this.option.menuButton.hasClass(g)},defaultShow:function(){return!!this.option.defaultShow},isExtrusion:function(){return"extrusion"===this.option.extendMethod&&this.option.contentContainer&&this.option.contentContainer.length>0}})}(jQuery,ui),function(a,b){"use strict";function c(){return this instanceof c?void this.initialize():new c}c.prototype={constructor:c,initialize:function(){return this.sidebars=new b.KeyArray,this},setElement:function(a,c,d){if(!b.str.isEmpty(a)){var e=null,f=this;if(this.sidebars.containsKey(a))e=this.sidebars.get(a),d&&e.set(d);else{if(!c||!c.parent)throw new Error("option is null");e=b.ctrls.SidebarBase(c,d),e.hiding(function(a){f.currentBar=null}),this.sidebars.set(a,e)}return e}},get:function(a){return b.str.isEmpty(a)?null:this.sidebars.containsKey(a)?this.sidebars.get(a):null},remove:function(a){b.str.isEmpty(a)||this.sidebars.containsKey(a)&&this.sidebars.remove(a)},isShow:function(){return this.currentBar&&this.currentBar.isShow()},show:function(a){if(!b.str.isEmpty(a)){var c=null,d=this;return this.sidebars.containsKey(a)?(c=this.sidebars.get(a),c.isShow()?null:this.currentBar?this.currentBar.hide().done(function(){d.currentBar=c,c.show()}):(this.currentBar=c,c.show())):null}},hide:function(){var a=this.currentBar;return b.str.isEmpty(name)?a=this.currentBar:this.sidebars.containsKey(name)&&(a=this.sidebars.get(name)),a.isShow()&&a?(this.currentBar=null,a.hide()):null}},b.SidebarManager=c}(jQuery,ui),function(a,b){"use strict";function c(a,b){return this instanceof c?void this.initialize(a,b):new c(a,b)}function d(a,b){return this instanceof d?void this.initialize(a,b):new d(a,b)}function e(a){return this instanceof e?void this.initialize(a):new e(a)}var f,g={small:{width:62,height:62,iconSize:32,countX:1,countY:1},medium:{width:128,height:128,iconSize:64,countX:2,countY:2},wide:{width:260,height:128,iconSize:64,countX:4,countY:2},large:{width:260,height:260,iconSize:64,countX:4,countY:4}},h=4,i=48,j=48,k=b.ctrls.CtrlBase.prototype.defineProperty,l=["name","title","icon","link","color"];f={rotate:{render:function(){this.tileInnerBack=a("<div class='tile-inner' style='display:none'>"),this.tileInnerBack.css("background-color",this.color),this.updatePanel=a("<div class='update-panel' />"),this.tileInnerBack.append(this.updatePanel).append("<div class='tile-title'><span class='tile-title-text'>"+this.title+"</span></div>"),this.smallIconImg=a("<img class='tile-small-icon' />"),this.smallIconImg.prop("src",this.icon),this.tileInnerBack.append(this.smallIconImg),this.tilePanel.append(this.tileInnerBack),this.updateStyle._createAnimator.call(this)},_createAnimator:function(){var a,c,d;c=2*this.width,a=function(a){var b,d={},e=["-ms-","-moz-","-webkit-","-o-",""];return b="perspective("+c+"px) rotateX("+a+"deg)",e.forEach(function(a){d[a+"transform"]=b}),d},this.animator=b.animator({ease:b.AnimationStyle.easeFrom,begin:0,end:-90,duration:500,onChange:function(b){this.target.css(a(b))}}).addTarget({ease:function(a){var b=3;return(a-=1)*a*((b+1)*a+b)+1},begin:90,end:0,delay:500,duration:500,onChange:function(b){var c=a(b);c.display="block",this.target.css(c)}}),d=this,this.animator.onEnd=function(){this[0].target.css("display","none")}},_play:function(){var a=this;this.link&&this.link.css("display","none"),a=this,this.animator.start().done(function(){var b;b=a.tileInnerBack,a.tileInnerBack=a.tileInner,a.tileInner=b,a.link&&a.link.css("display","block")})},update:function(a){var b;a&&this.updatePanel.html(a),this.isDynamicChanged||(b=this.animator[0],b.target=this.tileInner,b.begin=0,b.end=-90,b=this.animator[1],b.target=this.tileInnerBack,b.begin=90,b.end=0,this.updateStyle._play.call(this))},restore:function(){var a;this.isDynamicChanged&&(a=this.animator[0],a.target=this.tileInner,a.begin=0,a.end=90,a=this.animator[1],a.target=this.tileInnerBack,a.begin=-90,a.end=0,this.updateStyle._play.call(this))}},moveup:{render:function(){this.updatePanel=a("<div class='update-panel' />"),this.updatePanel.css("top","100%"),this.contentPanel.append(this.updatePanel),this.smallIconImg=a("<img class='tile-small-icon' />"),this.smallIconImg.prop("src",this.icon),this.animator=b.animator({target:this.contentPanel,ease:b.AnimationStyle.easeFromTo,duration:800,begin:0,end:this.height,onChange:function(a){this.target.scrollTop(a)}})},update:function(a){var b;a&&this.updatePanel.html(a).append(this.smallIconImg),this.isDynamicChanged||(this.animator.stop(),b=this.animator[0],b.begin=0,this.animator.start())},restore:function(){var a;this.isDynamicChanged&&(this.animator.stop(),a=this.animator[0],0!==a.target.scrollTop()&&(a.begin=a.target.scrollTop(),a.end=0,this.animator.start()))}}},c.prototype={constructor:c,initialize:function(a,c){var d,e;if(this.type=(a.type+"").toLowerCase(),d=g[this.type],!d)throw new TypeError("Invalid tile type: "+this.type);this.group=c,this.isDynamic=!1,this.isActivated=!1,this.isDynamicChanged=!1,this.width=d.width,this.height=d.height,this.iconSize=d.iconSize,this.countX=d.countX,this.countY=d.countY,this.locationX=0,this.locationY=0,this.tileInfo=a||{},e=this,l.forEach(function(b){a.hasOwnProperty(b)&&k.call(e,b,function(){return e.tileInfo[b]})}),"moveup"===this.tileInfo.updateStyle?this.updateStyle=f.moveup:this.updateStyle=f.rotate,this.updateFn=b.core.isFunction(this.tileInfo.updateFn)?this.tileInfo.updateFn:null,this.updateFn&&(this.isDynamic=!0,this.interval=b.core.isNumber(this.tileInfo.interval)?this.tileInfo.interval:60,this.interval<=0&&(this.interval=60)),this._render()},_render:function(){this.tilePanel=a("<div class='ui-tile tile-"+this.type+"' />"),this.tileInner=a("<div class='tile-inner' />"),this.tileInner.css("background-color",this.color),this.tilePanel.append(this.tileInner),this.iconImg=a("<img class='tile-icon' />"),this.iconImg.prop("src",this.icon),this.iconImg.css({width:this.iconSize+"px",height:this.iconSize+"px",left:(this.width-this.iconSize)/2+"px",top:(this.height-this.iconSize)/2+"px"}),this.smallIconImg=null,"small"!==this.type?(this.contentPanel=a("<div class='tile-content' />"),this.contentPanel.append(this.iconImg),this.titlePanel=a("<div class='tile-title' />"),this.titlePanel.html("<span class='tile-title-text'>"+this.title+"</span>"),this.tileInner.append(this.contentPanel).append(this.titlePanel),this.isDynamic&&this.updateStyle.render.call(this)):this.tileInner.append(this.iconImg),this.linkAnchor=null,b.core.isString(this.link)&&this.link.length>0&&(this.linkAnchor=a("<a class='tile-link "+this.type+"' />"),this.linkAnchor.prop("href",this.link),this.tilePanel.append(this.linkAnchor))},update:function(a){var c,d,e;if(b.core.isString(a))c=["<p class='update-inner'><span>",a,"</span></p>"],c=c.join("");else if(Array.isArray(a)){for(c=[],c.push("<p class='update-inner'>"),d=0,e=a.length;d<e;d++)c.push("<span>",a[d],"</span>"),e<e-1&&c.push("<br />");c.push("</p>"),c=c.join("")}else b.core.isFunction(a)&&(c=a.call(this));this.isActivated=!1,this.animator.isStarted||(this.updateStyle.update.call(this,c),this.isDynamicChanged=!0)},restore:function(){this.animator.isStarted||(this.updateStyle.restore.call(this),this.isDynamicChanged=!1)},activate:function(a){this.isActivated=!0,this.activeTime=(new Date).getTime()+1e3*this.interval,a!==!1&&this.group.container.activateDynamicTile(this)}},d.prototype={constructor:d,initialize:function(a,d){var e,f=[];this.container=d,e=this,a.forEach(function(a){var b=new c(a,e);b.isDynamic&&e.container.putDynamicTile(b),f.push(b)}),b.ArrayFaker.prototype.setArray.call(this,f),this.titleHeight=j,this._render()},_render:function(){var b,c;for(this.groupPanel=a("<div class='ui-tile-group' />"),this.groupPanel.css("visibility","hidden"),this.groupTitle=a("<div class='ui-tile-group-title' />"),this.groupContent=a("<div class='ui-tile-group-content' />"),this.groupPanel.append(this.groupTitle).append(this.groupContent),b=0,c=this.length;b<c;b++)this.groupContent.append(this[b].tilePanel)},_calculatePosition:function(a,b,c,d,e){var f,h,i,j,k,l,m,n,o,p;for(i=c.x,j=c.y;;){for(h=0;h<e;h++)b[j+h]||(b[j+h]=new Array(a*g.medium.countX));for(o=i,p=j,m=j,n=j+e;m<n;m++){for(f=b[m];;){if(k=i,l=i+d,l>f.length||k>=f.length){o=-1;break}for(;k<l;k++)if(f[k]){i=k+1,o=-1;break}if(o!==-1)break;o=i}if(o===-1)break}if(o!==-1&&p!==-1){for(c.x=o,c.y=p,m=p,n=p+e;m<n;m++)for(f=b[m],k=o,l=o+d;k<l;k++)f[k]=!0;return}i=0,j+=2}},arrange:function(a){var b,c,d,e,f,i,j,k,l,m;for(d=g.medium,k=[],l={x:0,y:0},b=0,c=this.length;b<c;)if(m=this[b],m.countX<=d.countX&&m.countY<=d.countY?this._calculatePosition(a,k,l,d.countX,d.countY):this._calculatePosition(a,k,l,m.countX,m.countY),"small"===m.type){for(e=g.medium.countX*g.medium.countY,f=l.x,i=l.y,j=1;j<=e&&(m=this[b],m&&"small"===m.type);)m.tilePanel.css({top:i*(g.small.height+h)+"px",left:f*(g.small.width+h)+"px"}),j++,f%g.medium.countX===0?f=l.x+1:(f=l.x,i=l.y+Math.floor(j/g.medium.countX)),b++;l.x+=g.medium.countX}else m.tilePanel.css({top:l.y*(g.small.height+h)+"px",left:l.x*(g.small.width+h)+"px"}),l.x+=m.countX,b++;c=k[0].length,this.width=c*g.small.width+(c-1)*h,c=k.length,this.height=c*g.small.height+(c-1)*h,this.groupContent.css("height",this.height+"px"),this.height+=this.titleHeight,this.groupPanel.css({width:this.width+"px",height:this.height+"px"})},addTile:function(a){var d=new c(a);b.ArrayFaker.prototype.push(d)},removeTile:function(a){}},e.prototype={constructor:e,initialize:function(c){this.groups=[],this.dynamicTiles=b.KeyArray(),this.dynamicTiles.activeCount=0,this.container=b.getJQueryElement(c),this.container?this.container.addClass("ui-tile-container"):this.container=a("<div class='ui-tile-container' />"),this.tileMargin=a("<div class='tile-margin' />"),this.container.append(this.tileMargin)},_register:function(a){var c;this.dynamicTiles.activeCount<=0||this.dynamicDelayHandler||((!b.core.isNumber(a)||a<=0)&&(a=1e3),c=this,this.dynamicDelayHandler=setTimeout(function(){var a,b,d,e;if(e=(new Date).getTime(),c.dynamicDelayHandler=null,c.dynamicTiles.activeCount>0){for(a=0,b=c.dynamicTiles.length;a<b;a++)d=c.dynamicTiles[a],d.isActivated&&e>d.activeTime&&(d.isActivated=!1,c.dynamicTiles.activeCount--,d.updateFn.call(c,d));c.dynamicTiles.activeCount>0&&c._register()}},a))},_calculateGroupLayoutInfo:function(a){var b,c,d,e;return c=g.medium,b=4,e=b*c.width+(b-1)*h,d=Math.floor((a-i)/(e+i)),d>1&&1===this.groups.length&&(d=1),d<1?(b=Math.floor(a/(c.width+i)),b<2&&(b=2)):1===d&&(b+=Math.floor((a-i-e)/(c.width+i)),b%2&&b--),{groupCount:d?d:1,groupSize:b}},layout:function(a,c){var d,e,f,g,h,k,l,m,n,o;if(0!==this.groups.length){for(d=this._calculateGroupLayoutInfo(a),f=[],m=0,n=this.groups.length;m<n;)for(o=0;o<d.groupCount&&!(m>=n);o++)k=this.groups[m],k.arrange(d.groupSize),f[o]||(f[o]=0),f[o]+=k.height,m++;for(o=0,m=0,n=f.length;m<n;m++)o<f[m]&&(o=f[m]);for(f=o,f+=j,h=0,f>c&&(h=b.scrollbarWidth),e=this.groups[0].width*d.groupCount+i*(d.groupCount-1),g=(a-h-e)/2,l={},m=0,n=this.groups.length;m<n;)for(l.left=g,o=0;o<d.groupCount&&!(m>=n);o++)k=this.groups[m],void 0===l[o]&&(l[o]=0),k.left=l.left,k.top=l[o],k.groupPanel.css({left:k.left+"px",top:k.top+"px",visibility:"visible"}),l.left+=k.width+i,l[o]+=k.height,m++;this.tileMargin.css("top",f+"px")}},addGroup:function(a,b){var c;Array.isArray(b)&&0!==b.length&&(c=new d(b,this),a&&c.groupTitle.html("<span>"+a+"</span>"),this.groups.push(c),this.container.append(c.groupPanel))},putDynamicTile:function(a){var b;if(b=a.name,!b)throw new TypeError("tileName can not be null");if(this.dynamicTiles.hasOwnProperty(b))throw new TypeError("The dynamicTile is exist which name is '"+b+"'");this.dynamicTiles.set(b,a),a.activate()},getDynamicTileByName:function(a){var b;return b=this.dynamicTiles.get(a+""),b?b:null},activateDynamicTile:function(a){this.dynamicTiles.activeCount++,this._register()}},b.TileContainer=e}(jQuery,ui),function(a,b){"use strict";function c(a){return a<10?"0"+a:""+a}function d(){var a,b;return a=new Date,b={year:a.getFullYear(),month:c(a.getMonth()+1),day:a.getDate().toString(),week:"星期"+f.charAt(a.getDay())}}var e,f;b.tiles||(b.tiles={}),f="日一二三四五六",e={medium:function(a){var b,c;b=d(),c=[],c.push("<span class='day-text'>",b.day,"</span>"),c.push("<span class='week-text'>",b.week,"</span>"),c.push("<span class='year-month-text'>",b.year,".",b.month,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},wide:function(a){var b,c;b=d(),c=[],c.push("<span class='day-text'>",b.day,"</span>"),c.push("<span class='week-text'>",b.week,"</span>"),c.push("<span class='year-month-text'>",b.year,".",b.month,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},large:function(a){e.wide.apply(this,arguments)}},b.tiles.calendar=function(a){var b;e[a.type].apply(this,arguments),b=new Date,b=60*b.getHours()*60+60*b.getMinutes()+b.getSeconds(),a.interval=86400-b,a.activate()}}(jQuery,ui),function(a,b){"use strict";function c(a){return a<10?"0"+a:""+a}function d(){var a,b;return a=new Date,b={hour:c(a.getHours()),minute:c(a.getMinutes()),spliter:":"}}var e;b.tiles||(b.tiles={}),e={medium:function(a){var b,c;b=d(),c=[],c.push("<span class='clock-hour'>",b.hour,"</span>"),c.push("<span class='clock-minute'>",b.minute,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.updatePanel.css({"text-align":"center",height:a.height+"px"}),a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},wide:function(a){var b,c;b=d(),c=[],c.push("<span class='clock-hour'>",b.hour,"</span>"),c.push("<span class='clock-spliter'></span>"),c.push("<span class='clock-minute'>",b.minute,"</span>"),a.updatePanel.html(c.join("")),a.isDynamicChanged||(a.updatePanel.css({"text-align":"center","line-height":a.height-8+"px",height:a.height+"px"}),a.smallIconImg&&(a.smallIconImg.remove(),a.smallIconImg=null),a.update())},large:function(a){e.wide.apply(this,arguments)}},b.tiles.clock=function(a){e[a.type].apply(this,arguments),a.activate()}}(jQuery,ui),function(a,b){"use strict";function c(b){var c;c=b.pictureContext,c.currentImagePanel=a("<div class='tile-picture-container' />"),c.currentImage=a("<img class='tile-picture' />"),c.currentImagePanel.append(c.currentImage),c.nextImagePanel=a("<div class='tile-picture-container' />"),c.nextImagePanel.css("display","none"),c.nextImage=a("<img class='tile-picture' />"),c.nextImagePanel.append(c.nextImage),b.updatePanel.append(c.currentImagePanel).append(c.nextImagePanel)}function d(a){var c=a.pictureContext;c.switchAnimator=b.animator({ease:b.AnimationStyle.easeTo,duration:500,begin:0,end:-a.height,onChange:function(a){this.target.css("top",a+"px")}}).addTarget({ease:b.AnimationStyle.easeTo,duration:500,begin:a.height,end:0,onChange:function(a){this.target.css("top",a+"px")}})}function e(a,c,d){var f,g,i;g=a.pictureContext,0!==g.images.length&&(f=g.images[g.currentIndex],i=function(b){c.css(b),c.prop("src",f),d(a)},g.imageSizeCache.hasOwnProperty(f)?i(g.imageSizeCache[f]):g.imageLoader.load(f,a.width,a.height,b.ImageLoader.centerCrop).then(function(a){var b={width:a.displayWidth+"px",height:a.displayHeight+"px",top:a.marginTop+"px",left:a.marginLeft+"px"};g.imageSizeCache[f]=b,i(b)},function(){g.images.splice(index,1),g.images.length>0&&(h(a),e(a,c,d))}))}function f(a){var b=a.pictureContext;a.update(),setTimeout(function(){b.currentImage.addClass("tile-picture-play")},1e3),setTimeout(function(){b.images.length>1&&(h(a),e(a,b.nextImage,g))},1e4)}function g(a){var b,c,d;c=a.pictureContext,b=c.currentImagePanel,c.currentImagePanel=c.nextImagePanel,c.nextImagePanel=b,b=c.currentImage,c.currentImage=c.nextImage,c.nextImage=b,d=c.switchAnimator[0],d.target=c.nextImagePanel,d=c.switchAnimator[1],d.target=c.currentImagePanel,d.target.css({top:a.height+"px",display:"block"}),c.switchAnimator.start().done(function(){c.nextImagePanel.css("display","none"),c.nextImage.removeClass("tile-picture-play"),setTimeout(function(){c.currentImage.addClass("tile-picture-play"),setTimeout(function(){c.images.length>1&&(h(a),e(a,c.nextImage,g))},1e4)},500)})}function h(a){var b,c;b=a.pictureContext,c=b.currentIndex+1,c>=b.images.length&&(c=0),b.currentIndex=c}b.tiles||(b.tiles={}),b.tiles.picture=function(a,g){var h,i,j;if(Array.isArray(g)){for(j=[],h=0,i=g.length;h<i;h++)g[h]&&j.push(g[h]);0!==j.length&&(a.pictureContext={images:j,currentIndex:0,imageSizeCache:{},imageLoader:new b.ImageLoader},c(a),d(a),e(a,a.pictureContext.currentImage,f))}}}(jQuery,ui),function(a,b){"use strict";function c(a){var c,d,e,f,g=null;if(Array.isArray(a))for(f=new Date,c=0,d=a.length;c<d;c++)e=a[c],e.date=b.str.jsonToDate(e.date),e.date&&e.date.getFullYear()===f.getFullYear()&&e.date.getMonth()===f.getMonth()&&e.date.getDate()===f.getDate()&&(g=e);return g}function d(a){var b=a.getMonth()+1,c=a.getDate();return(b<10?"0"+b:b)+"/"+(c<10?"0"+c:c)}function e(a){var b,c,d=new Date;return d=new Date(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0),a=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),b=parseInt(a.getTime()/1e3/60/60/24-d.getTime()/1e3/60/60/24,10),c=function(a){return"周"+"日一二三四五六".charAt(a)},b<-1?c(a.getDay()):b<0?"昨天":b<1?"今天":b<2?"明天":c(a.getDay())}function f(a){return"晴朗"}function g(a){return{htmlBuilder:[],weatherData:a,weatherToday:c(a.days),graph:h,info:i,days:j,build:k}}function h(){var a=this.htmlBuilder;return a.push("<div class='weather-graph'>"),l.apply(this,arguments),a.push("</div>"),this}function i(){var a=this.htmlBuilder;return a.push("<div class='weather-info'>"),l.apply(this,arguments),a.push("</div>"),this}function j(){var a,c,g,h=this.htmlBuilder,i=this.weatherData;if(Array.isArray(i.days)){for(h.push("<ul class='weather-days'>"),c=0,g=i.days.length;c<g;c++)a=i.days[c],h.push("<li class='weather-day'",0===c?" style='height:150px'":"",">"),h.push("<div class='weather-item'",0===c?" style='opacity:1'":"",">"),this.graph(),this.weatherToday=a,this.info(m,n,o,p),h.push("</div>"),h.push("<div class='weather-handle",0===c?" weather-current-handle":"","'>"),h.push("<span class='weather-text'>",b.str.textFormat("{0}&nbsp;({1})&nbsp;{2}&nbsp;&nbsp;{3}",d(a.date),e(a.date),b.str.textFormat("{0}℃ - {1}℃",a.low,a.high),f(i.type)),"</span>"),h.push("</div>"),h.push("</li>");h.push("</ul>")}return this}function k(){return this.htmlBuilder.join("")}function l(){var a,c,d;for(d=this.weatherToday,a=0,c=arguments.length;a<c;a++)b.core.isFunction(arguments[a])&&arguments[a].call(this,d)}function m(a){var b=this.htmlBuilder,c=this.weatherData;b.push("<h6 class='weather-city'>",c.city,"</h6>")}function n(a){var b=this.htmlBuilder;b.push("<h3 class='weather-temperature'>"),a.temperature&&b.push("<span class='weather-curr-temp'>",a.temperature,"<span style='font-size:22px;'>℃</span>","</span>"),b.push("<span class='weather-low-high'>",a.low,"℃ / ",a.high,"℃","</span>"),b.push("</h3>")}function o(a){var b=this.htmlBuilder;b.push("<h6 class='weather-description'>",a.description,"</h6>")}function p(a){var b=this.htmlBuilder;b.push("<h6 class='weather-wind'>",a.windDirection,"</h6>")}function q(c){var d,e;d=c.weatherContext,d.changeDayAnimator=b.animator({ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px"),this.original.css("height",this.end-(a-this.begin)+"px")}}).addTarget({ease:b.AnimationStyle.easeTo,onChange:function(a){this.target.css("opacity",a/100),this.original.css("opacity",(this.end-a)/100)}}),d.changeDayAnimator.duration=500,e=d.parent.children(".weather-days"),d.current=a(e.children()[0]),e.click(r.bind(c))}function r(b){var c,d,e,f,g,h,i;for(d=a(b.target);!d.hasClass("weather-handle");){if(f=d.nodeName(),"LI"===f||"UL"===f)return;d=d.parent()}c=this.weatherContext,d.parent()[0]!==c.current[0]&&(c.changeDayAnimator.isStarted||(g=c.current,e=g.children(".weather-item"),e.removeClass("active-dynamic"),g.children(".weather-handle").removeClass("weather-current-handle"),h=d.parent(),h.children(".weather-handle").addClass("weather-current-handle"),c.current=h,i=c.changeDayAnimator[0],i.original=g,i.target=h,i.begin=22,i.end=150,i=c.changeDayAnimator[1],i.original=e,i.target=h.children(".weather-item"),i.begin=0,i.end=100,e=c.current.children(".weather-item"),c.changeDayAnimator.start().done(function(){this[0];e.addClass("active-dynamic")})))}var s;b.tiles||(b.tiles={}),s={medium:function(a,b){var c;c=g(b).graph().info(n,o).build(),a.weatherContext.parent.html(c),a.update()},wide:function(a,b){var c;c=g(b).graph().info(m,n,o,p).build(),a.weatherContext.parent.html(c),a.update()},large:function(a,b){var c;c=g(b).days().build(),a.weatherContext.parent.html(c),setTimeout(function(){q(a)},1e3),a.update()}},b.tiles.weather=function(a,b){a.weatherContext={weatherData:b},"moveup"===a.tileInfo.updateStyle?(a.weatherContext.parent=a.updatePanel,a.smallIconImg.remove(),a.titlePanel.remove()):a.weatherContext.parent=a.tileInnerBack,s[a.type].apply(this,arguments)}}(jQuery,ui),function(a,b){"use strict";function c(a){return this instanceof c?void this.initialize(a):new c(a)}c.prototype={constructor:c,initialize:function(c){if(c||(c={}),this.toolbarPanel=b.getJQueryElement(c.toolbarId),this.toolbarPanel){this.height=this.toolbarPanel.height(),this.tools=this.toolbarPanel.children(".tools"),this.extendPanel=this.toolbarPanel.children(".toolbar-extend"),this.extendPanel.length>0&&(this.defaultExtendShow=!!c.defaultExtendShow,this._initExtendPanel());for(var d,e=0,f=this.tools.length;e<f;e++)d=a(this.tools[e]).children(".action-buttons"),d.length>0&&d.children(".tool-action-button").addClass("font-highlight-hover")}},_initExtendPanel:function(){this.extendHeight=parseFloat(this.extendPanel.css("height")),this._wrapExtendPanel(),this._createExtendAnimator(),this._initExtendButton(),this._initPinButton(),this.defaultExtendShow&&(this.showExtend(!1),this.pinExtend())},_wrapExtendPanel:function(){var b=this.toolbarPanel.css("position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&this.toolbarPanel.css("position","relative"),this.extendWrapPanel=a("<div style='position:absolute;height:0px;width:100%;display:none;overflow:hidden;'/>"),this.extendWrapPanel.css("top",this.height+"px"),this.extendPanel.css("top",-this.extendHeight+"px"),this.extendPanel.addClass("clear"),this.extendWrapPanel.append(this.extendPanel),this.toolbarPanel.append(this.extendWrapPanel)},_createExtendAnimator:function(){this.extendAnimator=b.animator({target:this.extendPanel,ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("top",a+"px")}}).addTarget({target:this.extendWrapPanel,ease:b.AnimationStyle.easeFromTo,onChange:function(a){this.target.css("height",a+"px")}}),this.extendAnimator.duration=300},_initExtendButton:function(){this.extendButton=this.toolbarPanel.find(".tool-extend-button");var b,c;0===this.extendButton.length&&(b=a("<ul class='tools' style='float:right;margin-left:0px;'></ul>"),c=a("<li class='tool-item action-buttons'></li>"),b.append(c),0===this.tools.length?this.extendPanel.parent().before(b):a(this.tools[0]).before(b),this.tools=this.toolbarPanel.children(".tools"),this.extendButton=a("<a class='tool-action-button tool-extend-button' href='javascript:void(0)' title='更多'><i class='fa fa-ellipsis-h'></i></a>"),c.append(this.extendButton));var d=this;this.extendButton.click(function(a){d.isExtendShow()?d.hideExtend():d.showExtend()})},_initPinButton:function(){this.pinButton=a("<a class='tool-extend-pin-button font-highlight-hover' href='javascript:void(0)' title='固定扩展区域'><i class='fa fa-thumb-tack'></i></a>"),this.extendWrapPanel.append(this.pinButton);var b=this;this.pinButton.click(function(a){b.isExtendPin()?b.unpinExtend():b.pinExtend()})},isExtendShow:function(){return this.extendButton.hasClass("extend-show")},showExtend:function(a){var b;this.extendAnimator.isStarted||(this.extendButton.addClass("extend-show").removeClass("font-highlight-hover").addClass("background-highlight"),this._cssOverflow=this.toolbarPanel.css("overflow"),this.toolbarPanel.css("overflow","visible"),a===!1?(this.extendWrapPanel.css({height:this.extendHeight+"px",display:"block"}),this.extendPanel.css("top","0px")):(b=this.extendAnimator[0],b.begin=-this.extendHeight,b.end=0,b=this.extendAnimator[1],b.begin=0,b.end=this.extendHeight,b.target.css({height:"0px",display:"block"}),this.extendAnimator.start()))},hideExtend:function(a){var b,c;this.extendAnimator.isStarted||(this.extendButton.removeClass("extend-show").addClass("font-highlight-hover").removeClass("background-highlight"),a===!1?(this.extendWrapPanel.css({height:"0px",display:"none"}),this.extendPanel.css("top",-this.extendHeight+"px"),this.toolbarPanel.css("overflow",this._cssOverflow)):(c=this,b=this.extendAnimator[0],b.begin=0,b.end=-this.extendHeight,b=this.extendAnimator[1],b.begin=this.extendHeight,b.end=0,this.extendAnimator.start().done(function(){c.toolbarPanel.css("overflow",c._cssOverflow),b.target.css("display","none")})))},_fireResize:function(){b.page.fire("resize")},isExtendPin:function(){return this.pinButton.hasClass("extend-pin")},pinExtend:function(){this.pinButton.addClass("extend-pin"),this.pinButton.children("i").removeClass("fa-thumb-tack").addClass("fa-angle-up"),this.extendButton.css("display","none"),this.height=this.height+this.extendHeight,this.toolbarPanel.css("height",this.height+"px"),this._fireResize()},unpinExtend:function(){this.pinButton.removeClass("extend-pin"),this.pinButton.children("i").removeClass("fa-angle-up").addClass("fa-thumb-tack"),this.extendButton.css("display","inline-block"),this.height=this.height-this.extendHeight,this.toolbarPanel.css("height",this.height+"px"),this._fireResize(),this.hideExtend()}},b.Toolbar=c}(jQuery,ui);