<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, maximum-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <link type="text/css" href="../dist/theme/light/site.Light.css" rel="stylesheet" />
    <link type="text/css" href="../dist/theme/light/metro-light.all.css" rel="stylesheet" />
    <link id="theme" type="text/css" href="../dist/theme/color/ui.metro.SeaBlue.css" rel="stylesheet" />
    <style type="text/css">
        html {
            overflow: auto;
        }
        body {
            height: auto;
        }
        .heighter {
            position: absolute;
            width: 1px;
            top: 0;
            left: 0;
        }
        .container-item {
            width: 100%;
            height: auto;
            position: relative;
            overflow: hidden;
        }
        .container-item-fixed {
            position: fixed;
            top: 0px;
            left: 0px;
        }
        .container-item-fixed .container-background {
        }
        .container-background {
        }
        .container-panel {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: absolute;
            display: flex;
            flex-flow: column nowrap;
            overflow: hidden;
            align-items: center;
            justify-content: center;
        }
        .head-title {
            font-size: 3em;
            text-align: center;
            height: 64px;
            line-height: 64px;
            flex: none;
            font-weight: bolder;
        }
        .container-item-bg-image {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        /* Main Section */
        .main-panel {
            width: 50%;
            height: 100%;
            flex: none;
            display: flex;
            flex-flow: column nowrap;
        }
        .main-header {
            height: 120px;
            line-height: 150px;
            color: #fff;
            font-size: 5em;
            text-shadow: #888 1px 0 0,#888 0 1px 0,#fff 0 0 0,#fff 0 0 0;
        }
        .code {
            text-align: center;
            font-size: 2em;
            height: 40px;
        }
        .description-text {
            font-size: 1.1em;
            line-height: 1.5;
        }
        .link-panel {
            display: flex;
            flex-flow: row nowrap;
            justify-content: center;
            height: 40px;
            margin-top: 20px;
        }
        .main-link {
            flex: none;
            display: inline-block;
            width: 160px;
            height: 100%;
            line-height: 40px;
            text-align: center;
            color: #fff;
            background-color: rgba(15, 128, 193, .7);
            text-decoration: none;
        }
        .main-link:hover {
            background-color: rgba(15, 128, 193, .9);
            text-decoration: none;
        }

        /* Feature Setion */
        #bg2 {
            -webkit-transform: scale(1.5, 1.5);
            -ms-transform: scale(1.5, 1.5);
            -o-transform: scale(1.5, 1.5);
            -moz-transform: scale(1.5, 1.5);
            transform: scale(1.5, 1.5);
        }
        #bg2.start-animation {
            -webkit-transform: scale(1, 1);
            -webkit-transition: -webkit-transform 20s linear 0s;
            -ms-transform: scale(1, 1);
            -ms-transition: -ms-transform 20s linear 0s;
            -o-transform: scale(1, 1);
            -o-transition: -o-transform 20s linear 0s;
            -moz-transform: scale(1, 1);
            -moz-transition: -moz-transform 20s linear 0s;
            transform: scale(1, 1);
            transition: transform 20s linear 0s;
        }
        .feature-panel {
            width: 50%;
            height: 50%;
            overflow: hidden;
            display: flex;
            flex: none;
            flex-flow: column nowrap;
            transform: scale(1.5, 1.5);
            color: #fff;
        }

        /* Demo Section */
        .demo-arrow {
            display: block;
            position: absolute;
            width: 0;
            height: 0;
            top: 50%;
            margin-top: -32px;
            border-width: 32px;
            cursor: pointer;
        }
        .demo-light,
        .demo-dark {
            display: flex;
            flex-flow: column nowrap;
            justify-content: center;
            align-items: center;
        }
        .demo-light {
            background-color:rgba(255, 255, 255, .5);
            color: #333;
        }
        .demo-dark {
            background-color:rgba(0, 0, 0, .5);
            color: #eee;
        }
        .demo-group-list {
            flex: none;
            max-width: 700px;
            height: auto;
        }
        .demo-title {
            padding: 0 10px;
            font-size: 1.5em;
            height: 48px;
            line-height: 48px;
            font-weight: bolder;
            opacity: .7;
        }
        .demo-group {
            width: 100%;
            height: auto;
        }
        .demo-list {
            list-style: none;
            width: 100%;
            margin: 0 auto;
            display: flex;
            flex-flow: row wrap;
            justify-content: flex-start;
        }
        .demo-item {
            width: 120px;
            height: 32px;
            line-height: 32px;
            text-align: center;
            margin-bottom: 10px;
            margin-left: 10px;
            font-size: 1.1em;
            flex: none;
            background-color: rgba(15, 128, 193, .5);
        }
        .demo-item:hover {
            background-color: rgba(15, 128, 193, .9);
        }
        .demo-link {
            text-decoration: none !important;
            display: inline-block;
            width: 100%;
            height: 100%;
            vertical-align: top;
            background-color: rgba(0, 0, 0, 0);
            font-size: 0.813em;
            color: #fff;
        }

        /* Last Section */
        #bg4 {
            -webkit-transform: scale(1, 1);
            -ms-transform: scale(1, 1);
            -o-transform: scale(1, 1);
            transform: scale(1, 1);
        }
        #bg4.start-animation {
            -webkit-transform: scale(1.5, 1.5);
            -webkit-transition: -webkit-transform 20s linear 0s;
            -ms-transform: scale(1.5, 1.5);
            -ms-transition: -ms-transform 20s linear 0s;
            -o-transform: scale(1.5, 1.5);
            -o-transition: -o-transform 20s linear 0s;
            -moz-transform: scale(1.5, 1.5);
            -moz-transition: -moz-transform 20s linear 0s;
            transform: scale(1.5, 1.5);
            transition: transform 20s linear 0s;
        }
    </style>
    <style type="text/css">
        @media screen and (min-width:1200px) {
        }
        @media screen and (min-width: 960px) and (max-width: 1199px) {
        }
        @media screen and (min-width: 768px) and (max-width: 959px) {
        }
        @media only screen and (min-width: 480px) and (max-width: 767px) {
        }
        @media only screen and (max-width: 767px) {
        }
        @media only screen and (max-width: 479px) {
        }
    </style>
</head>
<body>
    <div class="heighter"></div>
    <section class="container-item" style="background-color:rgba(255, 255, 255, .2);z-index:10;">
        <div class="container-panel" style="height:50%;top:25%;background-color:rgba(255, 255, 255, .4);flex-direction:column;">
            <div class="main-panel">
                <h1 class="head-title main-header">
                    <span style='opacity:.8'>SOON.UI</span>
                    <span class="font-highlight" style="opacity:.5;margin-left:10px;">III</span>
                </h1>
                <h3 class="code font-highlight">
                    代号: OCEAN
                </h3>
                <p class="description-text">
                    用于桌面Web浏览器的UI框架，基于jQuery。这是UI库的3.0版本，本次的版本升级会对整个库进行一次重构，使其更加模块化，分层更清晰。分散的构建形式也使得大家可以很容易的从中分离出一部分用于构建现有的项目，甚至项目中正好需要某一个控件，而不用为了这一个控件引入整个SoonUI，保持前端的整洁和轻巧。
                </p>
                <div class="link-panel">
                    <a class="main-link" style="margin-right:20px;" href="https://github.com/soonsoft/SoonUI_III">GitHub</a>
                    <a class="main-link" href="javascript:void(0)">下载</a>
                </div>
            </div>
        </div>
    </section>
    <section class="container-item" style="background-color:#99aacc;z-index:9;">
        <img id="bg2" class="container-item-bg-image" src="" alt="" />
        <div class="container-panel" style="opacity:0;background-color:rgba(0, 0, 0, .7);">
            <div class="feature-panel">
                <h1 class="head-title" style="font-size:3em">
                    <span style="opacity:.7">FEATURE</span>
                </h1>
                <p class="description-text" style="opacity:.8">
                    我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，我是描述文本，
                </p>
            </div>
        </div>
    </section>
    <section class="container-item" style="background-color:#ccc;z-index:8;">
        <img id="bg3" class="container-item-bg-image" src="" alt="" />
        <div id="demoTabPanel" class="container-panel" style="opacity:0">
            <div class="ui-tab-body demo-light"></div>
            <div class="ui-tab-body demo-dark"></div>
        </div>
    </section>
    <section class="container-item" style="background-color:#f1f1f1;z-index:7;">
        <img id="bg4" class="container-item-bg-image" src="" alt="" />
    </section>

    <script type="text/javascript" src="../jquery.js"></script>
    <script type="text/javascript" src="../dist/SOON.UI.3.0.0.all.js"></script>
    <script type="text/javascript">
        (function() {
            var 
                layer,
                backgroundImage,
                wave;

            $(document).ready(function(e) {
                layer.init();

                function onResize() {
                    var width = document.documentElement.clientWidth,
                        height = document.documentElement.clientHeight;

                    layer.resize(width, height);
                    backgroundImage.resize(width, height);
                };
                ui.page.resize(onResize);
                onResize();
                
                $(document).on("scroll", function() {
                    layer.setFixedItems();
                });

                backgroundImage.load();
            });

            layer = {
                heighter: null,
                sections: null,
                sectionOperators: [],
                currentIndex: -1,
                lastScrollTop: 0,
                direction: null,
                init: function() {
                    this.sections = $(".container-item");
                    this.heighter = $(".heighter");

                    this.events = new ui.CustomEvent(this);
                    this.events.initEvents(["move", "change"]);

                    this.resizeHandler = [];
                    this.onResize = function(fn) {
                        if(this.resizeHandler.indexOf(fn) === -1) {
                            this.resizeHandler.push(fn);
                        }
                    };
                    featureSection.call(this);
                    demoSection.call(this);
                    pagerFootSection.call(this);
                },
                setFixedItems: function() {
                    var scrollTop,
                        section,
                        i, len, 
                        operator,
                        lastIndex,
                        index;

                    scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                    if(scrollTop > this.lastScrollTop) {
                        this.direction = "down";
                    } else {
                        this.direction = "up";
                    }
                    this.lastScrollTop = scrollTop;
                    index = Math.floor((scrollTop + this.itemHeight) / this.itemHeight) - 1;

                    this.fire("move", index, scrollTop, this.itemHeight);
                    if(this.currentIndex === index) {
                        return;
                    }
                    for(i = 0, len = this.sections.length; i < len; i++) {
                        section = $(this.sections[i]);
                        if(i <= index) {
                            section.removeClass("container-item-fixed");
                        } else {
                            if(!section.hasClass("container-item-fixed")) {
                                section.addClass("container-item-fixed");
                            }
                        }
                    }
                    lastIndex = this.currentIndex;
                    this.currentIndex = index;

                    this.fire("change", lastIndex, index);
                },
                resize: function(width, height) {
                    this.sections.css("height", height + "px");
                    this.heighter.css("height", height * this.sections.length + "px");

                    this.itemHeight = height;
                    this.setFixedItems();

                    this.resizeHandler.forEach(function (item) {
                        try {
                            item.call(null, width, height);
                        } catch(e) {
                            ui.handleError(e);
                        }
                    });
                }
            };

            backgroundImage = {
                images: [],
                load: function() {
                    var width = document.documentElement.clientWidth,
                        height = document.documentElement.clientHeight,
                        that;

                    function setImageSize(img, imgInfo) {
                        img.css({
                            "width": imgInfo.displayWidth + "px",
                            "height": imgInfo.displayHeight + "px",
                            "top": imgInfo.marginTop + "px",
                            "left": imgInfo.marginLeft + "px"
                        });
                        that.images.push({
                            imgElem: img,
                            imgInfo: imgInfo
                        });
                        img.prop("src", imgInfo.src);
                    }
                    
                    that = this;
                    ui.ImageLoader()
                        .load("./content/pictures/7.jpg", width, height, ui.ImageLoader.centerCrop)
                        .then(function(loader) {
                            var img = $("#bg2");
                            setImageSize(img, loader);
                            // chrome会不执行动画，需要一个MacroTask做延迟
                            setTimeout(function() {
                                img.addClass("start-animation");
                            }, 16);
                        });
                    ui.ImageLoader()
                        .load("./content/pictures/29.jpg", width, height, ui.ImageLoader.centerCrop)
                        .then(function(loader) {
                            var img = $("#bg3");
                            setImageSize(img, loader);
                        });
                    ui.ImageLoader()
                        .load("./content/pictures/30.jpg", width, height, ui.ImageLoader.centerCrop)
                        .then(function(loader) {
                            var img = $("#bg4");
                            setImageSize(img, loader);
                        });
                },
                resize: function(width, height) {
                    this.images.forEach(function(item) {
                        item.imgInfo.width = width;
                        item.imgInfo.height = height;
                        ui.ImageLoader.centerCrop.call(item.imgInfo);
                        item.imgElem.css({
                            "width": item.imgInfo.displayWidth + "px",
                            "height": item.imgInfo.displayHeight + "px",
                            "top": item.imgInfo.marginTop + "px",
                            "left": item.imgInfo.marginLeft + "px"
                        });
                    });
                }
            };

            function featureSection() {
                var content = $(".feature-panel"),
                    panel = content.parent();
                this.move(function(e, index, scrollTop) {
                    if(index !== 0) {
                        return;
                    }
                    var percent = scrollTop / layer.itemHeight,
                        scale;
                    if(percent > 1) {
                        percent = 1;
                    }
                    scale = 1.5 - (.5 * percent);
                    panel.css("opacity", percent);
                    content.css("transform", "scale(" + scale + "," + scale + ")");
                });
            }

            function demoSection() {
                var tab,
                    flag,
                    demos;

                demos = [
                    {
                        title: "对话框",
                        items: [
                            { name: "对话框", src: "./{0}/box/dialog-box.html" }
                        ]
                    },
                    {
                        title: "控件",
                        items: [
                            { name: "选择器", src: "./{0}/select/chooser.html" },
                            { name: "日期选择器", src: "./{0}/select/date-chooser.html" },
                            { name: "下拉选择器", src: "./{0}/select/list-tree.html" },
                            { name: "表单控件", src: "./{0}/tools/form-controls.html" },
                            { name: "扩展控件", src: "./{0}/tools/control-tools.html" },
                            { name: "图片组件", src: "./{0}/tools/chooser.html" }
                        ]
                    },
                    {
                        title: "视图",
                        items: [
                            { name: "日历", src: "./{0}/view/calendar-view.html" },
                            { name: "表格", src: "./{0}/view/grid-view.html" },
                            { name: "报表", src: "./{0}/view/report-view.html" },
                            { name: "缩略图", src: "./{0}/view/card-view.html" },
                            { name: "选项卡", src: "./{0}/view/tab-view.html" },
                            { name: "列表", src: "./{0}/view/list-view.html" },
                            { name: "树", src: "./{0}/view/tree-view.html" },
                            { name: "动态磁贴", src: "./{0}/view/tile-view.html" }
                        ]
                    }
                ];

                tab = ui.ctrls.TabView({
                    bodyPanel: "demoTabPanel"
                });

                this.onResize(function(width, height) {
                    tab.putBodies(width, height);
                    tab.restore();
                    if(!flag) {
                        flag = true;
                        tab.showIndex(0, false);
                    }
                });

                function createDemoItems(panel, theme) {
                    var group,
                        i, j, items,
                        html = [];

                    html.push("<h1 class='head-title'>");
                    if(theme === "light") {
                        html.push("<span style='opacity:.8'>DEMO.</span><span style='opacity:.4'>日间</span>");
                    } else {
                        html.push("<span style='opacity:.8'>DEMO.</span><span style='opacity:.4'>夜间</span>");
                    }
                    html.push("</h1>");

                    html.push("<dl class='demo-group-list'>");
                    for(i = 0; i < demos.length; i++) {
                        group = demos[i];
                        html.push("<dt class='demo-title'>", group.title, "</dt>");
                        html.push("<dd class='demo-group'>", "<ul class='demo-list'>");
                        for(j = 0; j < group.items.length; j++) {
                            item = group.items[j];
                            html.push("<li class='demo-item'>");
                            html.push("<a class='demo-link' href='", ui.str.format(item.src, theme), "' target='_blank'>", item.name, "</a>");
                            html.push("</li>");
                        }
                        html.push("</ul>", "</dd>");
                    }
                    html.push("</dl>");
                    if(theme === "light") {
                        html.push("<i id='toDark' class='demo-arrow' style='right:0;border-color:transparent rgba(0, 0, 0, .5) transparent transparent;border-style:dashed solid dashed dashed;'></i>");
                    } else {
                        html.push("<i id='toLight' class='demo-arrow' style='left:0;border-color:transparent transparent transparent rgba(255, 255, 255, .5);border-style:dashed dashed dashed solid;'></i>")
                    }

                    panel.html(html.join(""));
                }
                createDemoItems($(tab.bodies[0]), "light");
                createDemoItems($(tab.bodies[1]), "dark");

                ui.setTask(function() {
                    $("#toDark").click(function(e) {
                        tab.showIndex(1);
                    });
                    $("#toLight").click(function(e) {
                        tab.showIndex(0);
                    });
                });

                this.move(function(e, index, scrollTop) {
                    if(index !== 1) {
                        return;
                    }
                    var percent = (scrollTop - (layer.itemHeight * index)) / layer.itemHeight;
                    if(percent > 1) {
                        percent = 1;
                    }
                    $("#demoTabPanel").css("opacity", percent);
                });
            }

            function pagerFootSection() {
                this.move(function(e, index, scrollTop) {
                    if(index !== 2) {
                        return;
                    }
                    var percent = (scrollTop - (layer.itemHeight * index)) / layer.itemHeight,
                        img = $("#bg4");
                    if(percent > 0 && !img.hasClass("start-animation")) {
                        img.addClass("start-animation");
                    }
                });
            }
        })();
    </script>
</body>
</html>
